import{e as i,o as n,a as t,d as N,r as d,v as z,l as I,b as a,w as u,g as p,t as c,u as w,D as A,f as R,F,h as j,E}from"./app-CZLkYVhz.js";import{_ as L}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-DGqi3YE0.js";import{b as T,a as D}from"./notification-BrLDF-00.js";import{_ as Z}from"./InputLabel.vue_vue_type_script_setup_true_lang-DP24QN7l.js";import{g as S}from"./useUser-Dc3_Hjqo.js";import{_ as U}from"./DialogModal.vue_vue_type_script_setup_true_lang-Dn6gUihL.js";import{_ as q}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-iS1Fl1UI.js";import{i as G}from"./init-DIMnQ95t.js";import"./time-DR3Bm2fi.js";/* empty css                                                                             */import"./money-BufCQq2I.js";import"./utc-YQln_hJX.js";import"./useCurrentTimeEntry-CruyZJNI.js";import{_ as J}from"./CardTitle.vue_vue_type_script_setup_true_lang-ClAjIdUA.js";import"./permissions-hl9spDHx.js";import"./theme-DlEllDdR.js";import{C as V}from"./Card-LvPP0cru.js";import{r as K}from"./InformationCircleIcon-BrT1HADU.js";function O(b,y){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z"}),t("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})])}function Q(b,y){return n(),i("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15M9 12l3 3m0 0 3-3m-3 3V2.25"})])}const W={class:"py-2.5 px-3 border-t dark:border-[#3F4961]"},X={class:"py-2.5 px-3 border-t dark:border-[#3F4961]"},Y={class:"py-2.5 px-3 border-t dark:border-[#3F4961]"},ee={class:"py-2.5 px-3 border-t dark:border-[#3F4961]"},te={class:"py-2 px-3 sm:px-4 text-sm flex items-center space-x-3"},re={class:"px-4 py-5 sm:px-5"},oe=["value"],se={key:0,class:"py-3 text-text-primary"},ae=["innerHTML"],ie={class:"mt-2 flex justify-center rounded-lg border border-dashed dark:border-[#3F4961] px-6 py-10"},ne={class:"text-center"},le={class:"mt-4 flex text-sm leading-6 text-text-secondary"},de={for:"file-upload",class:"relative cursor-pointer rounded-md font-semibold text-text-primary focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 focus-within:ring-offset-gray-900 hover:text-indigo-500"},ue={key:0},pe={key:1},me={class:"flex items-center justify-end px-4 py-3 bg-card-background border-t dark:border-[#3F4961] text-end sm:px-6 shadow sm:rounded-bl-md sm:rounded-br-md"},Be=N({__name:"ImportData",setup(b){const y=d([]),{addNotification:k}=T(),_=d(!1);z(async()=>{const s=S();s&&(y.value=(await D.getImporters({params:{organization:s}})).data)});const m=d(),f=d(null);async function B(){var o;if(l.value===null){k("error","Please select the import type");return}if(((o=f.value)==null?void 0:o.length)!==1){k("error","Please select the CSV or ZIP file that you want to import");return}const e=(await M(f.value[0])).split(";")[1].replace("base64,",""),r=S();if(r!==null){const{handleApiRequestNotifications:v}=T();_.value=!0;try{m.value=await v(()=>l.value?D.importData({type:l.value.key,data:e},{params:{organization:r}}):new Promise((x,H)=>{H("Import type is null")})),G(),m.value&&(g.value=!0)}finally{_.value=!1}}}const h=d();function M(s){return new Promise((e,r)=>{const o=new FileReader;o.readAsDataURL(s),o.onload=()=>{if(o.result instanceof ArrayBuffer){const x=new TextDecoder().decode(o.result);return r(x)}else o.result&&e(o.result)},o.onerror=r})}function $(){var s;f.value=((s=h.value)==null?void 0:s.files)??null}const C=I(()=>l.value===null?"":l.value.description),P=I(()=>{var s,e;return((e=(s=f.value)==null?void 0:s.item(0))==null?void 0:e.name)??"Import File selected"}),l=d(null),g=d(!1);return(s,e)=>(n(),i(F,null,[a(U,{closeable:"",show:g.value,onClose:e[1]||(e[1]=r=>g.value=!1)},{title:u(()=>e[3]||(e[3]=[p("Import Result")])),content:u(()=>{var r,o,v,x;return[e[8]||(e[8]=t("div",{class:"pb-6"}," The import was successful! Here is an overview of the imported data: ",-1)),t("div",W,[e[4]||(e[4]=t("span",{class:"text-text-primary font-semibold"},"Clients created:",-1)),p(" "+c((r=m.value)==null?void 0:r.report.clients.created),1)]),t("div",X,[e[5]||(e[5]=t("span",{class:"text-text-primary font-semibold"},"Projects created:",-1)),p(" "+c((o=m.value)==null?void 0:o.report.projects.created),1)]),t("div",Y,[e[6]||(e[6]=t("span",{class:"text-text-primary font-semibold"},"Tasks created:",-1)),p(" "+c((v=m.value)==null?void 0:v.report.tasks.created),1)]),t("div",ee,[e[7]||(e[7]=t("span",{class:"text-text-primary font-semibold"},"Time entries created:",-1)),p(" "+c((x=m.value)==null?void 0:x.report.time_entries.created),1)])]}),footer:u(()=>[a(q,{onClick:e[0]||(e[0]=r=>g.value=!1)},{default:u(()=>e[9]||(e[9]=[p(" Close ")])),_:1,__:[9]})]),_:1},8,["show"]),t("div",null,[a(w(J),{title:"Import Data",icon:w(Q)},null,8,["icon"]),a(V,{class:"mb-3"},{default:u(()=>[t("div",te,[a(w(K),{class:"h-5 min-w-0 w-5 text-bg-tertiary"}),e[10]||(e[10]=t("p",{class:"flex-1"}," Import existing data from Toggl, Clockify or a different solidtime instance. Please select the type of data you want to import and follow the instructions. ",-1))])]),_:1}),a(V,null,{default:u(()=>[t("div",re,[t("div",null,[a(Z,{for:"importType",value:"Import Type"}),A(t("select",{id:"importType","onUpdate:modelValue":e[2]||(e[2]=r=>l.value=r),name:"importType",class:"mt-1 block w-full dark:bg-[#171E31] dark:border-[#3F4961] text-text-primary focus:dark:border-[#3F4961] rounded-md shadow-sm"},[e[11]||(e[11]=t("option",{value:null,selected:"",disabled:""}," Select an import type to get instructions... ",-1)),(n(!0),i(F,null,j(y.value,r=>(n(),i("option",{key:r.key,value:r},c(r.name),9,oe))),128))],512),[[E,l.value]]),C.value?(n(),i("div",se,[e[12]||(e[12]=t("div",{class:"font-semibold text-text-secondary py-1"}," Instructions: ",-1)),t("div",{class:"max-w-2xl",innerHTML:C.value},null,8,ae)])):R("",!0)]),t("div",ie,[t("div",ne,[a(w(O),{class:"mx-auto h-8 w-8 text-text-secondary","aria-hidden":"true"}),t("div",le,[t("label",de,[f.value?(n(),i("span",ue,c(P.value),1)):(n(),i("span",pe,"Upload a Toggl/Clockify Export")),t("input",{id:"file-upload",ref_key:"importFile",ref:h,name:"file-upload",type:"file",class:"sr-only",onChange:$},null,544)])]),e[13]||(e[13]=t("p",{class:"text-xs leading-5 text-text-secondary"}," CSV and ZIP are supported ",-1))])])]),t("div",me,[a(L,{loading:_.value,onClick:B},{default:u(()=>e[14]||(e[14]=[p("Import Data ")])),_:1,__:[14]},8,["loading"])])]),_:1})])],64))}});export{Be as _};
//# sourceMappingURL=ImportData.vue_vue_type_script_setup_true_lang-gG64X6IZ.js.map
