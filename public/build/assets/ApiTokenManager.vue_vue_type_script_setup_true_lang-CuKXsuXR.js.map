{"version":3,"file":"ApiTokenManager.vue_vue_type_script_setup_true_lang-CuKXsuXR.js","sources":["../../../resources/js/Pages/API/Partials/ApiTokenManager.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref } from 'vue';\nimport { useForm, usePage } from '@inertiajs/vue3';\nimport ActionMessage from '@/Components/ActionMessage.vue';\nimport ActionSection from '@/Components/ActionSection.vue';\nimport Checkbox from '@/packages/ui/src/Input/Checkbox.vue';\nimport ConfirmationModal from '@/Components/ConfirmationModal.vue';\nimport DangerButton from '@/packages/ui/src/Buttons/DangerButton.vue';\nimport DialogModal from '@/packages/ui/src/DialogModal.vue';\nimport FormSection from '@/Components/FormSection.vue';\nimport InputError from '@/packages/ui/src/Input/InputError.vue';\nimport InputLabel from '@/packages/ui/src/Input/InputLabel.vue';\nimport PrimaryButton from '@/packages/ui/src/Buttons/PrimaryButton.vue';\nimport SecondaryButton from '@/packages/ui/src/Buttons/SecondaryButton.vue';\nimport SectionBorder from '@/Components/SectionBorder.vue';\nimport TextInput from '@/packages/ui/src/Input/TextInput.vue';\nimport type { Token } from '@/types/jetstream';\n\nconst props = defineProps<{\n    tokens: Token[];\n    availablePermissions: string[];\n    defaultPermissions: string[];\n}>();\n\nconst createApiTokenForm = useForm({\n    name: '',\n    permissions: props.defaultPermissions,\n});\n\nconst page = usePage<{\n    jetstream: {\n        flash: {\n            token: string;\n        };\n    };\n}>();\n\nconst updateApiTokenForm = useForm<{\n    permissions: string[];\n}>({\n    permissions: [],\n});\n\nconst deleteApiTokenForm = useForm({});\n\nconst displayingToken = ref(false);\nconst managingPermissionsFor = ref<Token | null>(null);\nconst apiTokenBeingDeleted = ref<Token | null>(null);\n\nconst createApiToken = () => {\n    createApiTokenForm.post(route('api-tokens.store'), {\n        preserveScroll: true,\n        onSuccess: () => {\n            displayingToken.value = true;\n            createApiTokenForm.reset();\n        },\n    });\n};\n\nconst manageApiTokenPermissions = (token: Token) => {\n    updateApiTokenForm.permissions = token.abilities;\n    managingPermissionsFor.value = token;\n};\n\nconst updateApiToken = () => {\n    updateApiTokenForm.put(\n        route('api-tokens.update', managingPermissionsFor.value?.id),\n        {\n            preserveScroll: true,\n            preserveState: true,\n            onSuccess: () => (managingPermissionsFor.value = null),\n        }\n    );\n};\n\nconst confirmApiTokenDeletion = (token: Token) => {\n    apiTokenBeingDeleted.value = token;\n};\n\nconst deleteApiToken = () => {\n    deleteApiTokenForm.delete(\n        route('api-tokens.destroy', apiTokenBeingDeleted.value?.id),\n        {\n            preserveScroll: true,\n            preserveState: true,\n            onSuccess: () => (apiTokenBeingDeleted.value = null),\n        }\n    );\n};\n</script>\n\n<template>\n    <div>\n        <!-- Generate API Token -->\n        <FormSection @submitted=\"createApiToken\">\n            <template #title> Create API Token </template>\n\n            <template #description>\n                API tokens allow third-party services to authenticate with our\n                application on your behalf.\n            </template>\n\n            <template #form>\n                <!-- Token Name -->\n                <div class=\"col-span-6 sm:col-span-4\">\n                    <InputLabel for=\"name\" value=\"Name\" />\n                    <TextInput\n                        id=\"name\"\n                        v-model=\"createApiTokenForm.name\"\n                        type=\"text\"\n                        class=\"mt-1 block w-full\"\n                        autofocus />\n                    <InputError\n                        :message=\"createApiTokenForm.errors.name\"\n                        class=\"mt-2\" />\n                </div>\n\n                <!-- Token Permissions -->\n                <div v-if=\"availablePermissions.length > 0\" class=\"col-span-6\">\n                    <InputLabel for=\"permissions\" value=\"Permissions\" />\n\n                    <div class=\"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4\">\n                        <div\n                            v-for=\"permission in availablePermissions\"\n                            :key=\"permission\">\n                            <label class=\"flex items-center\">\n                                <Checkbox\n                                    v-model:checked=\"\n                                        createApiTokenForm.permissions\n                                    \"\n                                    :value=\"permission\" />\n                                <span class=\"ms-2 text-sm text-text-secondary\">{{\n                                    permission\n                                }}</span>\n                            </label>\n                        </div>\n                    </div>\n                </div>\n            </template>\n\n            <template #actions>\n                <ActionMessage\n                    :on=\"createApiTokenForm.recentlySuccessful\"\n                    class=\"me-3\">\n                    Created.\n                </ActionMessage>\n\n                <PrimaryButton\n                    :class=\"{ 'opacity-25': createApiTokenForm.processing }\"\n                    :disabled=\"createApiTokenForm.processing\">\n                    Create\n                </PrimaryButton>\n            </template>\n        </FormSection>\n\n        <div v-if=\"tokens.length > 0\">\n            <SectionBorder />\n\n            <!-- Manage API Tokens -->\n            <div class=\"mt-10 sm:mt-0\">\n                <ActionSection>\n                    <template #title> Manage API Tokens </template>\n\n                    <template #description>\n                        You may delete any of your existing tokens if they are\n                        no longer needed.\n                    </template>\n\n                    <!-- API Token List -->\n                    <template #content>\n                        <div class=\"space-y-6\">\n                            <div\n                                v-for=\"token in tokens\"\n                                :key=\"token.id\"\n                                class=\"flex items-center justify-between\">\n                                <div class=\"break-all text-text-primary\">\n                                    {{ token.name }}\n                                </div>\n\n                                <div class=\"flex items-center ms-2\">\n                                    <div\n                                        v-if=\"token.last_used_ago\"\n                                        class=\"text-sm text-gray-400\">\n                                        Last used {{ token.last_used_ago }}\n                                    </div>\n\n                                    <button\n                                        v-if=\"availablePermissions.length > 0\"\n                                        class=\"cursor-pointer ms-6 text-sm text-gray-400 underline\"\n                                        @click=\"\n                                            manageApiTokenPermissions(token)\n                                        \">\n                                        Permissions\n                                    </button>\n\n                                    <button\n                                        class=\"cursor-pointer ms-6 text-sm text-red-500\"\n                                        @click=\"confirmApiTokenDeletion(token)\">\n                                        Delete\n                                    </button>\n                                </div>\n                            </div>\n                        </div>\n                    </template>\n                </ActionSection>\n            </div>\n        </div>\n\n        <!-- Token Value Modal -->\n        <DialogModal :show=\"displayingToken\" @close=\"displayingToken = false\">\n            <template #title> API Token </template>\n\n            <template #content>\n                <div>\n                    Please copy your new API token. For your security, it won't\n                    be shown again.\n                </div>\n\n                <div\n                    v-if=\"page.props.jetstream.flash.token\"\n                    class=\"mt-4 bg-card-backgroundpx-4 py-2 rounded font-mono text-sm text-gray-500 break-all\">\n                    {{ page.props.jetstream.flash.token }}\n                </div>\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"displayingToken = false\">\n                    Close\n                </SecondaryButton>\n            </template>\n        </DialogModal>\n\n        <!-- API Token Permissions Modal -->\n        <DialogModal\n            :show=\"managingPermissionsFor != null\"\n            @close=\"managingPermissionsFor = null\">\n            <template #title> API Token Permissions </template>\n\n            <template #content>\n                <div class=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n                    <div\n                        v-for=\"permission in availablePermissions\"\n                        :key=\"permission\">\n                        <label class=\"flex items-center\">\n                            <Checkbox\n                                v-model:checked=\"updateApiTokenForm.permissions\"\n                                :value=\"permission\" />\n                            <span class=\"ms-2 text-sm text-muted\">{{\n                                permission\n                            }}</span>\n                        </label>\n                    </div>\n                </div>\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"managingPermissionsFor = null\">\n                    Cancel\n                </SecondaryButton>\n\n                <PrimaryButton\n                    class=\"ms-3\"\n                    :class=\"{ 'opacity-25': updateApiTokenForm.processing }\"\n                    :disabled=\"updateApiTokenForm.processing\"\n                    @click=\"updateApiToken\">\n                    Save\n                </PrimaryButton>\n            </template>\n        </DialogModal>\n\n        <!-- Delete Token Confirmation Modal -->\n        <ConfirmationModal\n            :show=\"apiTokenBeingDeleted != null\"\n            @close=\"apiTokenBeingDeleted = null\">\n            <template #title> Delete API Token </template>\n\n            <template #content>\n                Are you sure you would like to delete this API token?\n            </template>\n\n            <template #footer>\n                <SecondaryButton @click=\"apiTokenBeingDeleted = null\">\n                    Cancel\n                </SecondaryButton>\n\n                <DangerButton\n                    class=\"ms-3\"\n                    :class=\"{ 'opacity-25': deleteApiTokenForm.processing }\"\n                    :disabled=\"deleteApiTokenForm.processing\"\n                    @click=\"deleteApiToken\">\n                    Delete\n                </DangerButton>\n            </template>\n        </ConfirmationModal>\n    </div>\n</template>\n"],"names":["createApiTokenForm","useForm","__props","page","usePage","updateApiTokenForm","deleteApiTokenForm","displayingToken","ref","managingPermissionsFor","apiTokenBeingDeleted","createApiToken","manageApiTokenPermissions","token","updateApiToken","_a","confirmApiTokenDeletion","deleteApiToken","_createElementBlock","_createVNode","FormSection","_cache","_createElementVNode","_hoisted_1","InputLabel","TextInput","_unref","$event","InputError","availablePermissions","_openBlock","_hoisted_2","_hoisted_3","_Fragment","_renderList","permission","_hoisted_4","Checkbox","_hoisted_5","_toDisplayString","ActionMessage","PrimaryButton","_normalizeClass","tokens","_hoisted_6","SectionBorder","_hoisted_7","ActionSection","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","DialogModal","_hoisted_14","SecondaryButton","_hoisted_15","_hoisted_16","_hoisted_17","ConfirmationModal","DangerButton"],"mappings":"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"}