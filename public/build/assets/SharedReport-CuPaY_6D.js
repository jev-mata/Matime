import{b as P,M as b}from"./MainContainer-DtfFNECZ.js";import{_ as V}from"./PageTitle.vue_vue_type_script_setup_true_lang-BxZn5Rae.js";import{u as D,R as $,a as K,_ as L}from"./useReporting-0JevMOU8.js";import{a as U}from"./time-D8fzVCgi.js";import{f as z}from"./money-CQyR8ykW.js";import{u as A}from"./useQuery-BllrDSBf.js";import{a as H}from"./notification-cXlbw5Vr.js";import{a as I}from"./BillableIcon-BvHKiDs7.js";import{d as O,r as Q,c as s,q as F,C as W,h as v,o as c,e as i,f as t,u as p,Z as X,w as y,l as T,t as f,F as x,i as Z,b as J}from"./app-DUID27fb.js";import{u as Y}from"./theme-idUPXIqc.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GroupedItemsCountButton.vue_vue_type_script_setup_true_lang-DHdKi0r5.js";import"./bundle-mjs-D696Ktp4.js";import"./install-BXuwDxkC.js";import"./index-D03bkDOQ.js";import"./useMembers-fKrmzvmk.js";import"./FolderIcon-DbiJK5M-.js";import"./CheckCircleIcon-CR_8rZI8.js";import"./utc-CJhWvcZK.js";const ee={class:"text-text-secondary"},te={class:"flex items-center space-x-3 sm:space-x-6"},re={class:"pt-10 w-full px-3 relative"},oe={class:"sm:grid grid-cols-4 pt-6 items-start"},ae={class:"col-span-3 bg-card-background rounded-lg border border-card-border pt-3"},se={class:"text-sm flex text-text-primary items-center font-medium px-6 border-b border-card-background-separator pb-3"},ne={class:"px-2"},ue={class:"px-2"},le={class:"grid items-center",style:{"grid-template-columns":"1fr 100px 150px"}},ie={class:"contents [&>*]:transition text-text-tertiary [&>*]:h-[50px]"},de={class:"justify-end flex items-center font-medium"},ce={class:"justify-end pr-6 flex items-center font-medium"},pe={key:1,class:"chart flex flex-col items-center justify-center py-12 col-span-3"},me={class:"px-2 lg:px-4"},Ge=O({__name:"SharedReport",setup(ve){const m=Q(null),w=s(()=>m.value!==null),{data:a}=A({enabled:w,queryKey:["reporting",m],queryFn:()=>H.getPublicReport({headers:{"X-Api-Key":m.value}})});F(()=>{const e=window.location.href;e.split("#").length===2&&(m.value=e.split("#")[1])});const h=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.currency:"EUR"}),C=s(()=>{var e;return(e=a.value)==null?void 0:e.interval_format}),R=s(()=>{var e;return(e=a.value)==null?void 0:e.number_format}),_=s(()=>{var e;return((e=a.value)==null?void 0:e.currency_format)??"symbol-before"}),N=s(()=>{var e;return(e=a.value)==null?void 0:e.date_format}),j=s(()=>{var e;return(e=a.value)==null?void 0:e.currency_symbol});W("organization",s(()=>({number_format:R.value,interval_format:C.value,currency_format:_.value,currency_symbol:j.value,date_format:N.value})));const u=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.data:{grouped_data:[],grouped_type:"project",seconds:0,cost:0}}),k=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.history_data:{grouped_data:[],grouped_type:"project",seconds:0,cost:0}}),B=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.properties.group:"billable"}),E=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.properties.sub_group:"project"}),{emptyPlaceholder:g}=D(),G=s(()=>{var e,r;return((r=(e=u.value)==null?void 0:e.grouped_data)==null?void 0:r.map(o=>{var n;return o.description===null?{value:o.seconds,name:g[((n=u.value)==null?void 0:n.grouped_type)??"project"],color:"#CCCCCC"}:{value:o.seconds,name:o.description,color:o.color??I(o.description??"none")}}))??[]}),q=s(()=>{var e,r;return(r=(e=u.value)==null?void 0:e.grouped_data)==null?void 0:r.map(o=>{var n,l;return{seconds:o.seconds,cost:o.cost,description:o.description??g[((n=u.value)==null?void 0:n.grouped_type)??"project"],grouped_data:((l=o.grouped_data)==null?void 0:l.map(d=>({seconds:d.seconds,cost:d.cost,description:d.description??g[o.grouped_type??"project"]})))??[]}})}),{groupByOptions:M}=D();function S(e){var r;return(r=M.find(o=>o.value===e))==null?void 0:r.label}return F(async()=>{Y()}),(e,r)=>{var o;return c(),v(x,null,[i(p(X),{title:(o=p(a))==null?void 0:o.name},null,8,["title"]),t("div",ee,[i(b,{class:"py-3 sm:py-5 border-b border-default-background-separator flex justify-between items-center"},{default:y(()=>[t("div",te,[i(V,{icon:p(P),title:"Reporting"},null,8,["icon"])])]),_:1}),i(b,null,{default:y(()=>{var n,l;return[t("div",re,[i($,{"grouped-type":(n=k.value)==null?void 0:n.grouped_type,"grouped-data":(l=k.value)==null?void 0:l.grouped_data},null,8,["grouped-type","grouped-data"])])]}),_:1}),i(b,null,{default:y(()=>{var n,l;return[t("div",oe,[t("div",ae,[t("div",se,[r[0]||(r[0]=T(" Group by ")),t("strong",ne,f(S(B.value)),1),r[1]||(r[1]=T(" and ")),t("strong",ue,f(S(E.value)),1)]),t("div",le,[r[4]||(r[4]=t("div",{class:"contents [&>*]:border-card-background-separator [&>*]:border-b [&>*]:bg-tertiary [&>*]:pb-1.5 [&>*]:pt-1 text-text-secondary text-sm"},[t("div",{class:"pl-6"},"Name"),t("div",{class:"text-right"},"Duration"),t("div",{class:"text-right pr-6"},"Cost")],-1)),(n=u.value)!=null&&n.grouped_data&&((l=u.value.grouped_data)==null?void 0:l.length)>0?(c(),v(x,{key:0},[(c(!0),v(x,null,Z(q.value,d=>(c(),J(K,{key:d.description??"none",currency:h.value,"currency-format":_.value,entry:d},null,8,["currency","currency-format","entry"]))),128)),t("div",ie,[r[2]||(r[2]=t("div",{class:"flex items-center pl-6 font-medium"},[t("span",null,"Total")],-1)),t("div",de,f(p(U)(u.value.seconds,C.value,R.value)),1),t("div",ce,f(p(z)(u.value.cost,h.value,_.value,j.value)),1)])],64)):(c(),v("div",pe,r[3]||(r[3]=[t("p",{class:"text-lg text-text-primary font-semibold"}," No time entries found ",-1),t("p",null,"Try to change the filters and time range",-1)])))])]),t("div",me,[i(L,{data:G.value},null,8,["data"])])])]}),_:1})])],64)}}});export{Ge as default};
//# sourceMappingURL=SharedReport-CuPaY_6D.js.map
