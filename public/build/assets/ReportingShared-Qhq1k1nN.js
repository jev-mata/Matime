import{M as Q,b as I,a as K}from"./MainContainer-WpbdfkDp.js";import{f as G,P as O,S as H,B as J,D as W,x as X,$ as Y,d as Z,E as ee,_ as te}from"./AppLayout.vue_vue_type_script_setup_true_lang-BfXcHqGL.js";import{_ as se}from"./PageTitle.vue_vue_type_script_setup_true_lang-Dc0jot_g.js";import{u as D,a as S,b as U}from"./notification-Cqm5OIAz.js";import{u as re}from"./useQuery-BH-Arugy.js";import{g as R}from"./useMembers-D1lZTqLC.js";import{_ as oe}from"./ReportingTabNavbar.vue_vue_type_script_setup_true_lang-CVC589uJ.js";import{_ as V}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-DBBC7wMi.js";import{v as ie,w as ae,q as ne,j as le,k as pe}from"./permissions-Cy8U4TFG.js";import{T as ue,_ as de}from"./TableHeading-CHDXaWC7.js";import{d as $,b as c,o as r,w as i,f as t,u as e,e as s,j as v,g as q,x as ce,y as me,r as C,D as A,l as w,n as fe,h as m,F as E,t as k,c as P,L as _e,N as ve,i as T,p as xe,s as ye}from"./app-Dzd5B06R.js";import{_ as be,a as ge,c as we,b as z,r as $e}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-OCyRpCcO.js";import{r as he}from"./PencilSquareIcon-C4w9DETU.js";import{_ as j}from"./TextInput.vue_vue_type_script_setup_true_lang-Cw992cSP.js";import{_ as ke}from"./DialogModal.vue_vue_type_script_setup_true_lang-Cdp4pUKI.js";import{_ as F}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-CWUYAS8h.js";import{_ as h}from"./InputLabel.vue_vue_type_script_setup_true_lang-BJprejo3.js";import{u as L}from"./useMutation-DORhZ8RW.js";import"./time-D8Z5bJ3P.js";import"./money-DE8Cj37t.js";import{D as Re}from"./DatePicker-DsbVNWEA.js";import"./utc-BCs3FwGo.js";import{_ as Ce}from"./Checkbox.vue_vue_type_script_setup_true_lang-CGLsJy8v.js";import{b as Ee}from"./index-NRw1C4BU.js";import{r as Me}from"./ArrowTopRightOnSquareIcon-BjqQdrkl.js";import{r as Ne}from"./FolderPlusIcon-BTBKkc2d.js";import{r as Pe}from"./PlusIcon-DXN6bajS.js";import{i as N,a as B,r as De}from"./billing-BrKRBYHJ.js";import{r as Se,a as Ve,b as qe}from"./ChevronLeftIcon-Bv_5XyMM.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-CCwwB18o.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-BJPjJVKi.js";import"./useOrganization-fnI1XVs5.js";import"./init-Ddj1H8ev.js";import"./theme-CJTqdCW4.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CcpHAXFE.js";import"./ClockIcon-CYfSOCq5.js";import"./TabBar.vue_vue_type_script_setup_true_lang-goXlkxJT.js";import"./Collection-DUsfnDCk.js";import"./usePrimitiveElement-Dt-Gdg0c.js";import"./RovingFocusGroup-C65J4aAO.js";import"./useTypeahead-DT7HEzVy.js";import"./Modal.vue_vue_type_script_setup_true_lang-s_ZkTFQt.js";const ze=$({__name:"ReportTableHeading",setup(y){return(u,l)=>(r(),c(ue,null,{default:i(()=>l[0]||(l[0]=[t("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Name ",-1),t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Description ",-1),t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Visibility ",-1),t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Public URL ",-1),t("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[t("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),je=["aria-label"],Be=$({__name:"ReportMoreOptionsDropdown",props:{report:{}},emits:["delete","edit","archive"],setup(y,{emit:u}){const l=u,p=y;return(x,a)=>(r(),c(e(be),null,{default:i(()=>[s(e(ge),{"as-child":""},{default:i(()=>[t("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Project "+p.report.name},a[2]||(a[2]=[t("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,je)]),_:1}),s(e(we),{class:"min-w-[150px]",align:"end"},{default:i(()=>[e(ie)()?(r(),c(e(z),{key:0,"aria-label":"Edit Report "+p.report.name,class:"flex items-center space-x-3 cursor-pointer",onClick:a[0]||(a[0]=q(d=>l("edit"),["prevent"]))},{default:i(()=>[s(e(he),{class:"w-5 text-icon-active"}),a[3]||(a[3]=t("span",null,"Edit",-1))]),_:1,__:[3]},8,["aria-label"])):v("",!0),e(ae)()?(r(),c(e(z),{key:1,"aria-label":"Delete Report "+p.report.name,class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:a[1]||(a[1]=q(d=>l("delete"),["prevent"]))},{default:i(()=>[s(e($e),{class:"w-5"}),a[4]||(a[4]=t("span",null,"Delete",-1))]),_:1,__:[4]},8,["aria-label"])):v("",!0)]),_:1})]),_:1}))}}),Ue={class:"items-center space-y-4 w-full"},Ae={class:"w-full"},Te={class:"flex items-center space-x-12"},Fe={class:"flex items-center space-x-2 px-2 py-3"},Le={key:0,class:"flex items-center space-x-4"},Qe=$({__name:"ReportEditModal",props:ce({originalReport:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(y){const u=me(y,"show"),l=C(!1),p=D(),x=L({mutationFn:async g=>{const o=R();if(o===null)throw new Error("No current organization id - update report");return await S.updateReport(g,{params:{organization:o,report:a.originalReport.id}})},onSuccess:()=>{p.invalidateQueries({queryKey:["reports"]})}}),a=y,d=C({name:a.originalReport.name,description:a.originalReport.description,is_public:a.originalReport.is_public,public_until:a.originalReport.public_until});A(()=>a.originalReport,()=>{d.value={name:a.originalReport.name,description:a.originalReport.description,is_public:a.originalReport.is_public,public_until:a.originalReport.public_until}});const{handleApiRequestNotifications:b}=U();async function f(){await b(()=>x.mutateAsync(d.value),"Success","Error",()=>{d.value={name:"",description:"",is_public:!1,public_until:null,properties:{}},u.value=!1})}return(g,o)=>(r(),c(ke,{closeable:"",show:u.value,onClose:o[4]||(o[4]=n=>u.value=!1)},{title:i(()=>o[5]||(o[5]=[t("div",{class:"flex space-x-2"},[t("span",null," Create Report ")],-1)])),content:i(()=>[t("div",Ue,[t("div",Ae,[s(h,{for:"name",value:"Name"}),s(j,{id:"name",modelValue:d.value.name,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value.name=n),class:"mt-1.5 w-full"},null,8,["modelValue"])]),t("div",null,[s(h,{for:"description",value:"Description"}),s(j,{id:"description",modelValue:d.value.description,"onUpdate:modelValue":o[1]||(o[1]=n=>d.value.description=n),class:"mt-1.5 w-full"},null,8,["modelValue"])]),s(h,{value:"Visibility"}),t("div",Te,[t("div",Fe,[s(e(Ce),{id:"is_public",checked:d.value.is_public,"onUpdate:checked":o[2]||(o[2]=n=>d.value.is_public=n)},null,8,["checked"]),s(h,{for:"is_public",value:"Public"})]),d.value.is_public?(r(),m("div",Le,[s(h,{for:"public_until",value:"Expires at"}),s(Re,{id:"public_until"})])):v("",!0)])])]),footer:i(()=>[s(V,{onClick:o[3]||(o[3]=n=>u.value=!1)},{default:i(()=>o[6]||(o[6]=[w(" Cancel")])),_:1,__:[6]}),s(F,{class:fe(["ms-3",{"opacity-25":l.value}]),disabled:l.value,onClick:f},{default:i(()=>o[7]||(o[7]=[w(" Update Report ")])),_:1,__:[7]},8,["class","disabled"])]),_:1},8,["show"]))}}),Ie={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},Ke={class:"overflow-ellipsis overflow-hidden"},Ge={class:"whitespace-nowrap min-w-0 px-3 py-4 text-sm text-text-secondary"},Oe={class:"overflow-ellipsis overflow-hidden"},He={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},Je={class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},We={key:0,class:"space-x-2 flex items-center"},Xe={key:0},Ye={key:1},Ze={key:1},et={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},tt=$({__name:"ReportTableRow",props:{report:{}},setup(y){const u=y,l=C(!1),{copy:p,copied:x,isSupported:a}=Ee({legacy:!0}),{handleApiRequestNotifications:d}=U();function b(){var _;const n=u.report.shareable_link;n&&((_=window.open(n,"_blank"))==null||_.focus())}const f=D(),g=L({mutationFn:async n=>{const _=R();if(_===null)throw new Error("No current organization id - update report");return await S.deleteReport(void 0,{params:{organization:_,report:n}})},onSuccess:()=>{f.invalidateQueries({queryKey:["reports"]})}});async function o(){await d(()=>g.mutateAsync(u.report.id),"Success","Error")}return(n,_)=>(r(),m(E,null,[s(Qe,{show:l.value,"onUpdate:show":_[0]||(_[0]=M=>l.value=M),"original-report":n.report},null,8,["show","original-report"]),s(de,null,{default:i(()=>[t("div",Ie,[t("span",Ke,k(n.report.name),1)]),t("div",Ge,[t("span",Oe,k(n.report.description),1)]),t("div",He,k(n.report.is_public?"Public":"Private"),1),t("div",Je,[n.report.shareable_link?(r(),m("div",We,[e(a)?(r(),c(e(V),{key:0,onClick:_[1]||(_[1]=M=>e(p)(n.report.shareable_link))},{default:i(()=>[e(x)?(r(),m("span",Ye,"Copied!")):(r(),m("span",Xe,"Copy URL"))]),_:1})):v("",!0),t("button",{class:"outline-0 focus-visible:ring-2 w-6 h-6 flex items-center justify-center rounded focus-visible:ring-ring",onClick:b},[s(e(Me),{class:"w-4 text-text-tertiary hover:text-text-secondary transition"})])])):(r(),m("span",Ze," -- "))]),t("div",et,[s(Be,{report:n.report,onEdit:_[2]||(_[2]=M=>l.value=!0),onDelete:o},null,8,["report"])])]),_:1})],64))}}),st={class:"flow-root max-w-[100vw] overflow-x-auto"},rt={class:"inline-block min-w-full align-middle"},ot={key:0,class:"col-span-5 py-24 text-center"},it={key:0,class:"pb-5"},at=$({__name:"ReportTable",props:{reports:{}},setup(y){const u=P(()=>"grid-template-columns: minmax(150px, auto) minmax(250px, 1fr) minmax(140px, auto) minmax(130px, auto) 80px;");return(l,p)=>(r(),m("div",st,[t("div",rt,[t("div",{"data-testid":"report_table",class:"grid min-w-full",style:_e(u.value)},[s(ze),l.reports.length===0?(r(),m("div",ot,[s(e(Ne),{class:"w-8 text-icon-default inline pb-2"}),p[2]||(p[2]=t("h3",{class:"text-text-primary font-semibold"}," No shared reports found ",-1)),e(ne)()?(r(),m("p",it," Go to the overview to create a report ")):v("",!0),s(V,{icon:e(Pe),onClick:p[0]||(p[0]=x=>e(ve).visit(l.route("reporting")))},{default:i(()=>p[1]||(p[1]=[w("Go to overview ")])),_:1,__:[1]},8,["icon"])])):v("",!0),(r(!0),m(E,null,T(l.reports,x=>(r(),c(tt,{key:x.id,report:x},null,8,["report"]))),128))],4)])]))}}),nt={class:"flex items-center space-x-3 sm:space-x-6"},lt={key:0},pt={class:"py-12"},ut={class:"rounded-full flex items-center justify-center w-20 h-20 mx-auto border border-border-tertiary bg-secondary"},dt={class:"max-w-sm text-center mx-auto py-4 text-base"},ct={class:"py-1"},mt={class:"pr-2 flex items-center space-x-1 border-r border-border-primary mr-1"},ft={class:"!ml-2 pl-2 flex items-center space-x-1 border-l border-border-primary"},_t=15,as=$({__name:"ReportingShared",setup(y){const u=C(1),{data:l}=re({queryKey:["reports",u],enabled:!!R(),queryFn:()=>S.getReports({params:{organization:R()||""}})}),p=P(()=>{var b;return((b=l.value)==null?void 0:b.data)??[]}),x=P(()=>1),a=D();async function d(){await a.invalidateQueries({queryKey:["reports"]})}return A(u,()=>{d()}),(b,f)=>(r(),c(te,{title:"Reporting","data-testid":"reporting_view",class:"overflow-hidden"},{default:i(()=>[s(Q,{class:"py-3 sm:py-5 min-h-[79px] border-b border-default-background-separator flex justify-between items-center"},{default:i(()=>[t("div",nt,[s(se,{icon:e(I),title:"Reporting"},null,8,["icon"]),s(oe,{active:"shared"})])]),_:1}),e(N)()?v("",!0):(r(),m("div",lt,[t("div",pt,[t("div",ut,[s(e(K),{class:"w-12"})]),t("div",dt,[t("p",ct,[xe(b.$slots,"default")]),f[2]||(f[2]=t("p",{class:"py-1"},[w(" If you want to use "),t("strong",null,"sharable reports"),w(" , "),t("strong",null,"please upgrade to a paid plan"),w(". ")],-1)),e(B)()&&e(le)()?(r(),c(e(ye),{key:0,href:"/billing"},{default:i(()=>[e(B)()&&e(pe)()?(r(),c(F,{key:0,type:"button",class:"mt-6",icon:e(De)},{default:i(()=>f[1]||(f[1]=[w(" Go to Billing ")])),_:1,__:[1]},8,["icon"])):v("",!0)]),_:1})):v("",!0)])])])),p.value.length>0||e(N)()?(r(),c(at,{key:1,reports:p.value},null,8,["reports"])):v("",!0),p.value.length>0||e(N)()?(r(),c(e(G),{key:2,page:u.value,"onUpdate:page":f[0]||(f[0]=g=>u.value=g),total:x.value,"items-per-page":_t,class:"flex justify-center items-center py-8","sibling-count":1,"show-edges":""},{default:i(()=>[s(e(O),{class:"flex items-center space-x-1 relative"},{default:i(({items:g})=>[t("div",mt,[s(e(H),{class:"navigation-item"},{default:i(()=>[s(e(Se),{class:"w-4"})]),_:1}),s(e(J),{class:"mr-4 navigation-item"},{default:i(()=>[s(e(Ve),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1})]),(r(!0),m(E,null,T(g,(o,n)=>(r(),m(E,null,[o.type==="page"?(r(),c(e(W),{key:n,class:"pagination-item",value:o.value},{default:i(()=>[w(k(o.value),1)]),_:2},1032,["value"])):(r(),c(e(X),{key:o.type,index:n,class:"PaginationEllipsis"},{default:i(()=>f[3]||(f[3]=[t("div",{class:"px-2"},"…",-1)])),_:2,__:[3]},1032,["index"]))],64))),256)),t("div",ft,[s(e(Y),{class:"navigation-item"},{default:i(()=>[s(e(Z),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1}),s(e(ee),{class:"navigation-item"},{default:i(()=>[s(e(qe),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1})])]),_:1})]),_:1},8,["page","total"])):v("",!0)]),_:3}))}});export{as as default};
