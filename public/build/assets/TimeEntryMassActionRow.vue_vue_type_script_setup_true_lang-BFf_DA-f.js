import{M as R}from"./MainContainer-WpbdfkDp.js";import{b as H,T as O}from"./AppLayout.vue_vue_type_script_setup_true_lang-BfXcHqGL.js";import{n as J,o as Q,a as W,q as X,p as Y}from"./time-D8Z5bJ3P.js";import{_ as Z,a as K,b as ee}from"./TimeTrackerProjectTaskDropdown.vue_vue_type_script_setup_true_lang-BwWIfvvx.js";import{t as A}from"./bundle-mjs-D696Ktp4.js";import{d as j,x as B,y as P,D as U,r as w,c as x,h as k,o as g,f as d,n as F,t as C,z as M,b as V,w as v,e as s,u as p,B as L,l as D,j as S,G as te,c5 as ae,v as se,F as ne}from"./app-Dzd5B06R.js";import{_ as q}from"./TagDropdown.vue_vue_type_script_setup_true_lang-DArOXIGF.js";import{_ as oe}from"./TagBadge.vue_vue_type_script_setup_true_lang-Bl_ueEok.js";import{d as z}from"./utc-BCs3FwGo.js";import{_ as re,a as le,c as ie,b as ue,r as G}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-OCyRpCcO.js";import"./money-DE8Cj37t.js";import"./useMembers-D1lZTqLC.js";import"./notification-Cqm5OIAz.js";import{_ as I}from"./Checkbox.vue_vue_type_script_setup_true_lang-CGLsJy8v.js";import"./permissions-Cy8U4TFG.js";import{_ as de}from"./TextInput.vue_vue_type_script_setup_true_lang-Cw992cSP.js";import{_ as ce}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-DBBC7wMi.js";import{_ as me}from"./DialogModal.vue_vue_type_script_setup_true_lang-Cdp4pUKI.js";import{_ as pe}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-CWUYAS8h.js";import{_ as $}from"./InputLabel.vue_vue_type_script_setup_true_lang-BJprejo3.js";import{a as N,_ as fe}from"./SelectDropdown.vue_vue_type_script_setup_true_lang-CaZ4i_G-.js";import{r as ve}from"./PencilSquareIcon-C4w9DETU.js";const ge={class:"relative min-w-0 flex-1 text-ellipsis whitespace-nowrap overflow-hidden"},be={class:"relative text-sm font-medium min-w-0"},ye=["value"],_e=j({__name:"TimeEntryDescriptionInput",props:{modelValue:{},modelModifiers:{}},emits:B(["changed"],["update:modelValue"]),setup(_,{emit:h}){const a=P(_,"modelValue"),i=h;function r(l){const f=l.target;f.value!==a.value&&(i("changed",f.value),a.value=f.value)}U(()=>a.value,l=>{t.value=l});function n(l){t.value=l.target.value}const t=w(a.value),o=x(()=>t.value===""||t.value===null);return(l,f)=>(g(),k("div",ge,[d("div",be,[d("div",{class:F(["opacity-0 h-4 text-sm whitespace-pre font-medium min-w-0 pl-3 pr-1",{"min-w-[130px]":o.value}])},C(t.value),3),d("input",{"data-testid":"time_entry_description",value:t.value,placeholder:"Add a description",class:"absolute px-0 h-full min-w-0 pl-3 pr-1 left-0 top-0 w-full text-sm text-text-primary font-medium bg-transparent focus-visible:ring-0 rounded-lg border-0",onBlur:r,onInput:n,onKeydown:M(r,["enter"])},null,40,ye)])]))}}),he={"data-testid":"time_entry_tag_dropdown",class:"opacity-50 group-hover:opacity-100 group/dropdown focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 transition focus:bg-card-background-separator hover:bg-card-background-separator rounded-full flex items-center justify-center"},ke=j({__name:"TimeEntryRowTagDropdown",props:B({tags:{},createTag:{type:Function}},{modelValue:{default:[]},modelModifiers:{}}),emits:B(["changed"],["update:modelValue"]),setup(_,{emit:h}){const a=_,i=h,r=P(_,"modelValue"),n=x(()=>a.tags.filter(t=>r.value.includes(t.id)));return(t,o)=>(g(),V(q,{modelValue:r.value,"onUpdate:modelValue":o[0]||(o[0]=l=>r.value=l),tags:t.tags,align:"end","create-tag":t.createTag,onChanged:o[1]||(o[1]=l=>i("changed",r.value))},{trigger:v(()=>[d("button",he,[s(oe,{border:!1,size:"large",class:"border-0 sm:px-1.5 text-icon-default group-focus-within/dropdown:text-text-primary",name:n.value.map(l=>l.name).join(", ")},null,8,["name"])])]),_:1},8,["modelValue","tags","create-tag"]))}}),we=j({__name:"TimeEntryMoreOptionsDropdown",emits:["delete"],setup(_,{emit:h}){const a=h;return(i,r)=>(g(),V(p(re),null,{default:v(()=>[s(p(le),{"as-child":""},{default:v(()=>r[1]||(r[1]=[d("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for the time entry"},[d("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[d("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})])],-1)])),_:1,__:[1]}),s(p(ie),{class:"min-w-[150px]",align:"end"},{default:v(()=>[s(p(ue),{"data-testid":"time_entry_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:r[0]||(r[0]=n=>a("delete"))},{default:v(()=>[s(p(G),{class:"w-5"}),r[2]||(r[2]=d("span",null,"Delete",-1))]),_:1,__:[2]})]),_:1})]),_:1}))}}),Ee={class:"relative"},Te={key:0,class:"text-text-tertiary font-medium"},je=j({__name:"TimeEntryRangeSelector",props:{start:{},end:{},showDate:{type:Boolean}},emits:["changed"],setup(_,{emit:h}){const a=h,i=w(!1),r=w(null),n=L("organization");return(t,o)=>(g(),k("div",Ee,[s(H,{modelValue:i.value,"onUpdate:modelValue":o[2]||(o[2]=l=>i.value=l),align:"center","close-on-content-click":!1,onSubmit:o[3]||(o[3]=l=>i.value=!1)},{trigger:v(()=>{var l,f,b;return[d("button",{ref_key:"triggerElement",ref:r,"data-testid":"time_entry_range_selector",class:F(p(A)("text-text-secondary px-2 bg-transparent text-center hover:bg-card-background rounded-lg border border-transparent hover:border-card-border focus-visible:outline-none focus:outline-none focus-visible:ring-2 focus-visible:text-text-primary focus-visible:ring-ring focus-visible:bg-tertiary",t.showDate?"text-xs py-1.5 font-semibold":"text-sm py-1.5 font-medium",((l=p(n))==null?void 0:l.time_format)==="12-hours"?"w-[160px]":"w-[110px]",i.value&&"border-card-border bg-card-background"))},[D(C(p(J)(t.start,t.end,(f=p(n))==null?void 0:f.time_format))+" ",1),t.showDate?(g(),k("span",Te,C(p(Q)(t.start,(b=p(n))==null?void 0:b.date_format)),1)):S("",!0)],2)]}),content:v(()=>[s(Z,{focus:"",start:t.start,end:t.end,onChanged:o[0]||(o[0]=(l,f)=>a("changed",l,f)),onClose:o[1]||(o[1]=l=>i.value=!1)},null,8,["start","end"])]),_:1},8,["modelValue"])]))}}),$e=j({__name:"TimeEntryRowDurationInput",props:{start:{},end:{}},emits:["changed"],setup(_,{emit:h}){const a=L("organization"),i=x(()=>{var e,c;return{intervalFormat:((e=a==null?void 0:a.value)==null?void 0:e.interval_format)??"hours-minutes",numberFormat:((c=a==null?void 0:a.value)==null?void 0:c.number_format)??"point"}}),r=_,n=h,t=w(""),o=w(!1);function l(){var T;const e=((T=i==null?void 0:i.value)==null?void 0:T.intervalFormat)==="decimal"?"hours":"minutes",{seconds:c}=Y(t.value,e);if(c&&c>0){let E=r.end,u=r.start;r.end?E=z(r.start).utc().add(c,"s").format():u=z().utc().subtract(c,"s").format(),n("changed",u,E)}t.value=""}const f=x({get(){return t.value!==""?t.value:W(X(r.start,r.end),i.value.intervalFormat,i.value.numberFormat)},set(e){e?t.value=e:t.value=""}});function b(e){o.value=!0,e.target.select()}return(e,c)=>te((g(),k("input",{"onUpdate:modelValue":c[0]||(c[0]=T=>f.value=T),"data-testid":"time_entry_duration_input",name:"Duration",class:"text-text-primary w-[90px] px-2.5 py-1.5 bg-transparent text-right hover:bg-card-background rounded-lg border border-transparent hover:border-card-border text-sm font-semibold focus-visible:bg-tertiary focus-visible:border-transparent focus-visible:ring-2 focus-visible:ring-ring",onFocus:b,onKeydown:[c[1]||(c[1]=M(T=>o.value=!1,["tab"])),M(l,["enter"])],onBlur:l},null,544)),[[ae,f.value]])}}),Ce={class:"border-b border-default-background-separator transition min-w-0 bg-row-background","data-testid":"time_entry_row"},xe={class:"sm:flex py-2 min-w-0 items-center justify-between group"},Be={class:"flex items-center min-w-0"},Ve={key:0,class:"w-10 h-7"},De={class:"flex items-center font-medium space-x-1 lg:space-x-2"},Se={key:0,class:"text-sm px-2"},Fe={class:"flex-1"},bt=j({__name:"TimeEntryRow",props:{timeEntry:{},indent:{type:Boolean},projects:{},tasks:{},tags:{},clients:{},members:{},createTag:{type:Function},createProject:{type:Function},createClient:{type:Function},onStartStopClick:{type:Function},deleteTimeEntry:{type:Function},updateTimeEntry:{type:Function},currency:{},showMember:{type:Boolean},showDate:{type:Boolean},selected:{type:Boolean},canCreateProject:{type:Boolean},enableEstimatedTime:{type:Boolean}},emits:["selected","unselected"],setup(_,{emit:h}){const a=_,i=h;function r(e){a.updateTimeEntry({...a.timeEntry,description:e})}function n(e){a.updateTimeEntry({...a.timeEntry,tags:e})}function t(e){a.updateTimeEntry({...a.timeEntry,billable:e})}function o(e,c){a.updateTimeEntry({...a.timeEntry,start:e,end:c})}function l(e,c){a.updateTimeEntry({...a.timeEntry,project_id:e,task_id:c})}const f=x(()=>{if(a.members){const e=a.members.find(c=>c.user_id===a.timeEntry.user_id);if(e)return e.name}return""});function b(e){i(e?"selected":"unselected")}return(e,c)=>(g(),k("div",Ce,[s(R,{class:"min-w-0"},{default:v(()=>[d("div",xe,[d("div",Be,[s(p(I),{checked:e.selected,"onUpdate:checked":b},null,8,["checked"]),e.indent===!0?(g(),k("div",Ve)):S("",!0),s(_e,{class:"min-w-0 mr-4","model-value":e.timeEntry.description,onChanged:r},null,8,["model-value"]),s(K,{"create-project":e.createProject,"create-client":e.createClient,"can-create-project":e.canCreateProject,clients:e.clients,projects:e.projects,tasks:e.tasks,"show-badge-border":!1,project:e.timeEntry.project_id,currency:e.currency,"enable-estimated-time":e.enableEstimatedTime,task:e.timeEntry.task_id,onChanged:l},null,8,["create-project","create-client","can-create-project","clients","projects","tasks","project","currency","enable-estimated-time","task"])]),d("div",De,[e.showMember&&e.members?(g(),k("div",Se,C(f.value),1)):S("",!0),s(ke,{"create-tag":e.createTag,tags:e.tags,"model-value":e.timeEntry.tags,onChanged:n},null,8,["create-tag","tags","model-value"]),s(ee,{"model-value":e.timeEntry.billable,class:F(p(A)("opacity-50 group-hover:opacity-100 focus-visible:opacity-100")),size:"small",onChanged:t},null,8,["model-value","class","onChanged"]),d("div",Fe,[s(je,{class:"hidden lg:block",start:e.timeEntry.start,end:e.timeEntry.end,"show-date":e.showDate,onChanged:o},null,8,["start","end","show-date","onChanged"])]),s($e,{start:e.timeEntry.start,end:e.timeEntry.end,onChanged:o},null,8,["start","end","onChanged"]),s(O,{active:!!(e.timeEntry.start&&!e.timeEntry.end),class:"opacity-20 hidden sm:flex focus-visible:opacity-100 group-hover:opacity-100",onChanged:e.onStartStopClick},null,8,["active","onChanged"]),s(we,{onDelete:e.deleteTimeEntry},null,8,["onDelete"])])])]),_:1})]))}}),Me={class:"flex space-x-2"},Ue={class:"space-y-4"},Ae={class:"space-y-2"},Pe={class:"space-y-2"},Ie={class:"space-y-2"},ze={class:"flex space-x-5"},Ne={key:0},Re={key:1},Ke={class:"flex items-center space-x-2"},Le={class:"space-y-2"},qe={class:"flex"},Ge={key:0},He={key:1},Oe={key:2},Je=j({__name:"TimeEntryMassUpdateModal",props:B({timeEntries:{},projects:{},tasks:{},clients:{},tags:{},createProject:{type:Function},createClient:{type:Function},createTag:{type:Function},updateTimeEntries:{type:Function},currency:{},enableEstimatedTime:{type:Boolean},canCreateProject:{type:Boolean}},{show:{default:!1},showModifiers:{}}),emits:B(["submit"],["update:show"]),setup(_,{emit:h}){const a=P(_,"show"),i=w(!1),r=_,n=h,t=w(null);U(a,u=>{u&&se(()=>{var m;(m=t.value)==null||m.focus()})});const o=w(""),l=w(void 0),f=w(null),b=w(void 0),e=w([]),c=x({get:()=>b.value===void 0?"do-not-update":b.value?"billable":"non-billable",set:u=>{u==="do-not-update"?b.value=void 0:u==="billable"?b.value=!0:b.value=!1}});async function T(){i.value=!0;const u={};o.value&&o.value!==""&&(u.description=o.value),f.value!==null&&(f.value===""?u.project_id=null:u.project_id=f.value,u.task_id=null,l.value!==void 0&&(u.task_id=l.value)),b.value!==void 0&&(u.billable=b.value),e.value.length>0&&(u.tags=e.value),E.value&&(u.tags=[]);try{await r.updateTimeEntries({...u}),a.value=!1,n("submit"),o.value="",f.value=null,l.value=void 0,e.value=[],b.value=void 0,i.value=!1,E.value=!1}catch{i.value=!1}}const E=w(!1);return U(E,()=>{E.value&&(e.value=[])}),(u,m)=>(g(),V(me,{closeable:"",show:a.value,onClose:m[7]||(m[7]=y=>a.value=!1)},{title:v(()=>[d("div",Me,[d("span",null," Update "+C(u.timeEntries.length)+" time entries ",1)])]),content:v(()=>[d("div",Ue,[d("div",Ae,[s($,{for:"description",value:"Description"}),s(de,{id:"description",ref_key:"descriptionInput",ref:t,modelValue:o.value,"onUpdate:modelValue":m[0]||(m[0]=y=>o.value=y),type:"text",class:"mt-1 block w-full",onKeydown:M(T,["enter"])},null,8,["modelValue"])]),d("div",Pe,[s($,{for:"project",value:"Project"}),s(K,{project:f.value,"onUpdate:project":m[1]||(m[1]=y=>f.value=y),task:l.value,"onUpdate:task":m[2]||(m[2]=y=>l.value=y),clients:u.clients,"create-project":u.createProject,"create-client":u.createClient,currency:u.currency,"can-create-project":u.canCreateProject,class:"mt-1","empty-placeholder":"Select project...","allow-reset":"",size:"xlarge","enable-estimated-time":u.enableEstimatedTime,projects:u.projects,tasks:u.tasks},null,8,["project","task","clients","create-project","create-client","currency","can-create-project","enable-estimated-time","projects","tasks"])]),d("div",Ie,[s($,{for:"project",value:"Tag"}),d("div",ze,[s(q,{modelValue:e.value,"onUpdate:modelValue":m[3]||(m[3]=y=>e.value=y),"create-tag":u.createTag,tags:u.tags},{trigger:v(()=>[s(p(N),{disabled:E.value,tag:"button",size:"xlarge"},{default:v(()=>[e.value.length>0?(g(),k("span",Ne," Set "+C(e.value.length)+" tags ",1)):(g(),k("span",Re," Select Tags... "))]),_:1},8,["disabled"])]),_:1},8,["modelValue","create-tag","tags"]),d("div",Ke,[s(p(I),{id:"no_tags",checked:E.value,"onUpdate:checked":m[4]||(m[4]=y=>E.value=y)},null,8,["checked"]),s($,{for:"no_tags",value:"Remove all tags"})])])]),d("div",Le,[s($,{for:"project",value:"Billable"}),d("div",qe,[s(fe,{modelValue:c.value,"onUpdate:modelValue":m[5]||(m[5]=y=>c.value=y),"get-key-from-item":y=>y.value,"get-name-for-item":y=>y.label,items:[{label:"Keep current billable status",value:"do-not-update"},{label:"Billable",value:"billable"},{label:"Non Billable",value:"non-billable"}]},{trigger:v(()=>[s(p(N),{tag:"button",size:"xlarge"},{default:v(()=>[b.value===void 0?(g(),k("span",Ge," Set billable status ")):b.value===!0?(g(),k("span",He," Billable ")):(g(),k("span",Oe," Non Billable "))]),_:1})]),_:1},8,["modelValue","get-key-from-item","get-name-for-item"])])])])]),footer:v(()=>[s(ce,{onClick:m[6]||(m[6]=y=>a.value=!1)},{default:v(()=>m[8]||(m[8]=[D(" Cancel")])),_:1,__:[8]}),s(pe,{class:F(["ms-3",{"opacity-25":i.value}]),disabled:i.value,onClick:T},{default:v(()=>m[9]||(m[9]=[D(" Update Time Entries ")])),_:1,__:[9]},8,["class","disabled"])]),_:1},8,["show"]))}}),yt=j({__name:"TimeEntryMassActionRow",props:{selectedTimeEntries:{},deleteSelected:{type:Function},class:{},allSelected:{type:Boolean},projects:{},tasks:{},tags:{},clients:{},createTag:{type:Function},createProject:{type:Function},createClient:{type:Function},updateTimeEntries:{type:Function},currency:{},enableEstimatedTime:{type:Boolean},canCreateProject:{type:Boolean}},emits:["submit","selectAll","unselectAll"],setup(_,{emit:h}){const a=_,i=h,r=w(!1);return(n,t)=>(g(),k(ne,null,[s(Je,{show:r.value,"onUpdate:show":t[0]||(t[0]=o=>r.value=o),projects:n.projects,tasks:n.tasks,tags:n.tags,clients:n.clients,"create-tag":n.createTag,"create-project":n.createProject,"create-client":n.createClient,"update-time-entries":n.updateTimeEntries,"enable-estimated-time":n.enableEstimatedTime,"can-create-project":n.canCreateProject,currency:n.currency,"time-entries":n.selectedTimeEntries,onSubmit:t[1]||(t[1]=o=>i("submit"))},null,8,["show","projects","tasks","tags","clients","create-tag","create-project","create-client","update-time-entries","enable-estimated-time","can-create-project","currency","time-entries"]),s(R,{class:F(p(A)(a.class,"text-sm py-1.5 font-medium border-t border-b bg-secondary border-border-secondary flex items-center space-x-3"))},{default:v(()=>[s(p(I),{id:"selectAll",checked:n.allSelected,"onUpdate:checked":t[2]||(t[2]=o=>n.allSelected?i("unselectAll"):i("selectAll"))},null,8,["checked"]),n.selectedTimeEntries.length>0?(g(),V(p($),{key:0,for:"selectAll",class:"select-none text-text-secondary"},{default:v(()=>[D(C(n.selectedTimeEntries.length)+" selected ",1)]),_:1})):(g(),V(p($),{key:1,for:"selectAll",class:"text-text-secondary select-none"},{default:v(()=>t[5]||(t[5]=[D("Select All")])),_:1,__:[5]})),n.selectedTimeEntries.length?(g(),k("button",{key:2,class:"text-text-tertiary flex space-x-1 items-center hover:text-text-secondary transition focus-visible:ring-2 outline-0 focus-visible:text-text-primary focus-visible:ring-ring rounded h-full px-2",onClick:t[3]||(t[3]=o=>r.value=!0)},[s(p(ve),{class:"w-4"}),t[6]||(t[6]=d("span",null," Edit ",-1))])):S("",!0),n.selectedTimeEntries.length?(g(),k("button",{key:3,class:"text-red-400 h-full px-2 space-x-1 items-center flex hover:text-red-500 transition focus-visible:ring-2 outline-0 focus-visible:text-red-500 focus-visible:ring-ring rounded",onClick:t[4]||(t[4]=(...o)=>n.deleteSelected&&n.deleteSelected(...o))},[s(p(G),{class:"w-3.5"}),t[7]||(t[7]=d("span",null," Delete ",-1))])):S("",!0)]),_:1},8,["class"])],64))}});export{yt as _,bt as a,_e as b,ke as c,we as d};
//# sourceMappingURL=TimeEntryMassActionRow.vue_vue_type_script_setup_true_lang-BFf_DA-f.js.map
