import{M as g}from"./MainContainer-DAB7AmGD.js";import{_ as V}from"./PageTitle.vue_vue_type_script_setup_true_lang-DVaC2uzI.js";import{u as R,R as $,a as q,_ as A}from"./useReporting-S2gixkGw.js";import{a as K}from"./time-DR3Bm2fi.js";import{u as L}from"./useQuery-QapR65Yu.js";import{a as U}from"./notification-BrLDF-00.js";import{a as z}from"./color-NTCrcshl.js";import{d as H,r as I,l as s,v as j,A as O,e as m,o as p,b as i,a as r,u as v,Z as Q,w as f,g as D,t as y,F as b,h as W,c as X}from"./app-CZLkYVhz.js";import{u as Z}from"./theme-DlEllDdR.js";import{a as J}from"./UserCircleIcon-B_03lMym.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./GroupedItemsCountButton.vue_vue_type_script_setup_true_lang-DXMK0t_p.js";import"./bundle-mjs-D696Ktp4.js";import"./install-BiQo9UUP.js";import"./index-CHolqtoz.js";import"./useUser-Dc3_Hjqo.js";import"./useMembers-B2Kv7mzm.js";import"./BillableIcon-BlL7cW2e.js";import"./UserGroupIcon-DEClCgLE.js";import"./FolderIcon-BBOgs1tQ.js";import"./CheckCircleIcon-ByT7Dbrk.js";import"./utc-YQln_hJX.js";const Y={class:"text-text-secondary dark:border-[#303F61] dark:bg-[#0F1426] dark:text-[#BFC7D6]"},ee={class:"flex items-center space-x-3 sm:space-x-6"},te={class:"pt-10 w-full px-3 relative"},re={class:"sm:grid grid-cols-4 pt-6 items-start"},oe={class:"col-span-3 bg-card-background rounded-lg border dark:border-[#3F4961] pt-3"},ae={class:"text-sm flex text-text-primary items-center font-medium px-6 border-b dark:border-[#3F4961] pb-3"},se={class:"px-2"},ne={class:"px-2"},ue={class:"grid items-center",style:{"grid-template-columns":"1fr 100px"}},le={class:"contents [&>*]:transition text-text-tertiary [&>*]:h-[50px]"},ie={class:"justify-end flex items-center font-medium pr-2"},de={key:1,class:"chart flex flex-col items-center justify-center py-12 col-span-3"},pe={class:"px-2 lg:px-4"},Me=H({__name:"SharedReport",setup(ce){const c=I(null),S=s(()=>c.value!==null),{data:a}=L({enabled:S,queryKey:["reporting",c],queryFn:()=>U.getPublicReport({headers:{"X-Api-Key":c.value}})});j(()=>{const e=window.location.href;e.split("#").length===2&&(c.value=e.split("#")[1])});const T=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.currency:"EUR"}),x=s(()=>{var e;return(e=a.value)==null?void 0:e.interval_format}),h=s(()=>{var e;return(e=a.value)==null?void 0:e.number_format}),C=s(()=>{var e;return((e=a.value)==null?void 0:e.currency_format)??"symbol-before"}),w=s(()=>{var e;return(e=a.value)==null?void 0:e.date_format}),B=s(()=>{var e;return(e=a.value)==null?void 0:e.currency_symbol});O("organization",s(()=>({number_format:h.value,interval_format:x.value,currency_format:C.value,currency_symbol:B.value,date_format:w.value})));const u=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.data:{grouped_data:[],grouped_type:"project",seconds:0,cost:0}}),k=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.history_data:{grouped_data:[],grouped_type:"project",seconds:0,cost:0}}),N=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.properties.group:"billable"}),E=s(()=>{var e;return a.value?(e=a.value)==null?void 0:e.properties.sub_group:"project"}),{emptyPlaceholder:_}=R(),G=s(()=>{var e,t;return((t=(e=u.value)==null?void 0:e.grouped_data)==null?void 0:t.map(o=>{var n;return o.description===null?{value:o.seconds,name:_[((n=u.value)==null?void 0:n.grouped_type)??"project"],color:"#CCCCCC"}:{value:o.seconds,name:o.description,color:o.color??z(o.description??"none")}}))??[]}),M=s(()=>{var e,t;return(t=(e=u.value)==null?void 0:e.grouped_data)==null?void 0:t.map(o=>{var n,l;return{seconds:o.seconds,cost:o.cost,description:o.description??_[((n=u.value)==null?void 0:n.grouped_type)??"project"],grouped_data:((l=o.grouped_data)==null?void 0:l.map(d=>({seconds:d.seconds,cost:d.cost,description:d.description??_[o.grouped_type??"project"]})))??[]}})}),{groupByOptions:P}=R();function F(e){var t;return(t=P.find(o=>o.value===e))==null?void 0:t.label}return j(async()=>{Z()}),(e,t)=>{var o;return p(),m(b,null,[i(v(Q),{title:(o=v(a))==null?void 0:o.name},null,8,["title"]),r("div",Y,[i(g,{class:"py-3 sm:py-5 border-b dark:border-[#3F4961] flex justify-between items-center"},{default:f(()=>[r("div",ee,[i(V,{icon:v(J),title:"Reporting"},null,8,["icon"])])]),_:1}),i(g,null,{default:f(()=>{var n,l;return[r("div",te,[i($,{"grouped-type":(n=k.value)==null?void 0:n.grouped_type,"grouped-data":(l=k.value)==null?void 0:l.grouped_data},null,8,["grouped-type","grouped-data"])])]}),_:1}),i(g,null,{default:f(()=>{var n,l;return[r("div",re,[r("div",oe,[r("div",ae,[t[0]||(t[0]=D(" Group by ")),r("strong",se,y(F(N.value)),1),t[1]||(t[1]=D(" and ")),r("strong",ne,y(F(E.value)),1)]),r("div",ue,[t[4]||(t[4]=r("div",{class:"contents [&>*]:dark:border-[#3F4961] [&>*]:border-b [&>*]:bg-tertiary [&>*]:pb-1.5 [&>*]:pt-1 text-text-secondary text-sm"},[r("div",{class:"pl-6"},"Name"),r("div",{class:"text-right pr-2"},"Duration")],-1)),(n=u.value)!=null&&n.grouped_data&&((l=u.value.grouped_data)==null?void 0:l.length)>0?(p(),m(b,{key:0},[(p(!0),m(b,null,W(M.value,d=>(p(),X(q,{key:d.description??"none",currency:T.value,"currency-format":C.value,"grouped-type":u.value.grouped_type,entry:d},null,8,["currency","currency-format","grouped-type","entry"]))),128)),r("div",le,[t[2]||(t[2]=r("div",{class:"flex items-center pl-6 font-medium"},[r("span",null,"Total")],-1)),r("div",ie,y(v(K)(u.value.seconds,x.value,h.value)),1)])],64)):(p(),m("div",de,t[3]||(t[3]=[r("p",{class:"text-lg text-text-primary font-semibold"}," No time entries found ",-1),r("p",null,"Try to change the filters and time range",-1)])))])]),r("div",pe,[i(A,{data:G.value},null,8,["data"])])])]}),_:1})])],64)}}});export{Me as default};
//# sourceMappingURL=SharedReport-nLEPZrq5.js.map
