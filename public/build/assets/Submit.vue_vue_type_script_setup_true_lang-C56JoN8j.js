import{d as L,r as y,bL as O,c as b,o as i,w as g,a,i as R,b as w,u as h,g as k,e as m,F as j,h as M,t as c,f as _,n as q,K as H,I as K}from"./app-CZLkYVhz.js";import"./time-DR3Bm2fi.js";import"./permissions-hl9spDHx.js";import{b as P}from"./notification-BrLDF-00.js";import"./useUser-Dc3_Hjqo.js";import"./useCurrentTimeEntry-CruyZJNI.js";import{d as G}from"./utc-YQln_hJX.js";/* empty css                                                                             */import"./money-BufCQq2I.js";import{_ as J}from"./Modal.vue_vue_type_script_setup_true_lang-DiIZ2Ob1.js";import{_ as C}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-iS1Fl1UI.js";import{_ as Q}from"./ProjectBadge.vue_vue_type_script_setup_true_lang-CJeOBiho.js";import{_ as U}from"./TagBadge.vue_vue_type_script_setup_true_lang-rGtwGI6K.js";import"./theme-DlEllDdR.js";import{r as T}from"./ClockIcon-Cw1e_8UL.js";const W={class:"col-span-full my-1 px-5 pt-5"},X={class:"max-h-20 overflow-y-scroll",style:{"max-height":"50vh"}},Y={class:"font-semibold text-md py-2 px-3 bg-quaternary text-secondary"},Z={class:""},tt={class:"basis-64 flex content-center"},et={class:"basis-32 flex content-center"},st={class:"basis-64 flex content-center"},ot={class:"basis-64"},at={class:"flex items-center lg:space-x-1 min-w-0"},rt={class:"whitespace-nowrap text-xs lg:text-sm"},it={key:1,class:"min-w-0 shrink text-xs lg:text-sm truncate"},nt={class:"basis-64 overflow-hidden"},lt={key:0,class:"w-full"},ct={class:"text-muted-foreground text-sm bold text-text-primary font-semibold text-sm lg:text-base flex items-center mt-2"},dt={class:"flex w-full items-center space-x-2 lg:space-x-2.5"},jt=L({__name:"Submit",props:{groupEntries:{},projects:{},tasks:{},tags:{},isSubmit:{type:Boolean},periodSelected:{}},emits:["clear","getTimesheet"],setup(S,{emit:D}){function x(s,t){return s?t.find(r=>r.id===s):void 0}function $(s,t){return s?t.find(r=>r.id===s):void 0}const u=y(!1);function F(s,t){const r=new Map(t.map(o=>[o.id,o.name]));return s.map(o=>r.get(o)).filter(o=>!!o)}const n=S,{addNotification:E}=P(),v=D;y(null);function I(s){return Object.values(s).flatMap(t=>t.flatMap(r=>r.timeEntries.map(o=>o.id)))}const B=async()=>{const s=I(n.groupEntries);if(u.value=!0,!s.length){console.warn("No time entry IDs to submit.");return}await K.post(route("approval.submit"),{ids:s,period:n.periodSelected},{withCredentials:!0,headers:{Accept:"application/json"}})?(E("success","Submitted","Entry Submitted"),v("clear"),v("getTimesheet"),u.value=!1):(u.value=!1,E("error","Failed","Entry Failed to Submit"))};function N(s){return s?G(s).format("h:mm A"):""}function V(s,t){const r=new Date(s).getTime(),o=new Date(t).getTime();if(isNaN(r)||isNaN(o))return"0h 0m";const d=Math.floor((o-r)/(1e3*60)),e=Math.floor(d/60),l=d%60;return`${e}h ${l}m`}function z(s){let t=0;Object.values(s).forEach(d=>{d.forEach(e=>{e.timeEntries.forEach(l=>{const p=new Date(l.start).getTime(),f=l.end?new Date(l.end).getTime():NaN;if(!isNaN(p)&&!isNaN(f)){const A=Math.floor((f-p)/59910);t+=A}})})});const r=Math.floor(t/60),o=t%60;return`${r}h ${o}m`}return(s,t)=>{const r=O("ChevronRightIcon");return i(),b(J,{show:!0,"max-width":"5xl"},{default:g(()=>[a("div",W,[t[2]||(t[2]=a("h2",{class:"text-lg font-semibold mb-1"},"My Entries",-1)),a("div",X,[(i(!0),m(j,null,M(n.groupEntries,(o,d)=>(i(),m("div",{key:d,class:"mt-4 mb-4 dark:bg-[#171E31] bg-[#E0E3E5] rounded-lg"},[a("h2",Y,"2"+c(d),1),a("ul",Z,[(i(!0),m(j,null,M(o,e=>{var l;return i(),m("li",{key:e.id,class:"flex flex-row px-3 rounded border dark:border-[#303F61] dark:bg-[#171E31] bg-[#F3F3F4] py-2"},[a("div",tt,c(N(e.start))+" - "+c(e.end&&N(e.end)),1),a("div",et,c(e.end&&V(e.start,e.end)),1),a("div",st,c(e.description||"No description"),1),a("div",ot,[e.project_id?(i(),b(Q,{key:0,color:(l=x(e.project_id,n.projects))==null?void 0:l.color,size:"large",border:!0,class:q("focus:border-border-tertiary w-full focus:outline-0 focus:bg-card-background-separator min-w-0 relative  dark:bg-[#171E31] bg-[#E0E3E5]"),project:x(e.project_id,n.projects)},{default:g(()=>{var p,f;return[a("div",at,[a("span",rt,c((p=x(e.project_id,n.projects))==null?void 0:p.name),1),e.task?(i(),b(r,{key:0,class:"w-4 lg:w-5 text-text-secondary shrink-0"})):_("",!0),e.task?(i(),m("div",it,c((f=$(e.task_id,n.tasks))==null?void 0:f.name),1)):_("",!0)])]}),_:2},1032,["color","project"])):_("",!0)]),a("div",nt,[e.tags.length>0?(i(),m("div",lt,[w(U,{class:"truncate text-ellipsis overflow-hidden whitespace-nowrap",border:!1,size:"large",name:F(e.tags,n.tags).join(",")},null,8,["name"])])):_("",!0)])])}),128))])]))),128))]),a("div",ct,[t[1]||(t[1]=k(" Total Hours: ")),h(T)?(i(),b(H(h(T)),{key:0,class:"w-5 lg:w-4 text-icon-default ml-2 mr-1"})):_("",!0),a("div",null,c(z(n.groupEntries)),1)])])]),footer:g(()=>[a("form",{onSubmit:R(B,["prevent"]),class:"space-y-4 w-full px-5 pb-5"},[a("div",dt,[w(h(C),{class:"px-4 py-2 dark:text-white rounded dark:bg-gray-700 bg-gray-200/70",loading:u.value,onClick:t[0]||(t[0]=o=>v("clear"))},{default:g(()=>t[3]||(t[3]=[k("Close ")])),_:1,__:[3]},8,["loading"]),w(h(C),{type:"submit",class:"px-4 py-2 text-gray-900 dark:bg-gray-700 bg-gray-200/70 dark:text-white rounded",loading:u.value},{default:g(()=>t[4]||(t[4]=[k("Submit ")])),_:1,__:[4]},8,["loading"])])],32)]),_:1})}}});export{jt as _};
//# sourceMappingURL=Submit.vue_vue_type_script_setup_true_lang-C56JoN8j.js.map
