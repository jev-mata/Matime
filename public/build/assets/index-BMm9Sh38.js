import{d as z,b as p,o as s,u,n as k,w as c,p as P,Q as U,r as x,c as Q,q as W,e as b,h as m,j as d,g as w,f as e,t as i,F as T,i as B,k as I,l as N,m as K}from"./app-Dzd5B06R.js";import{_ as O}from"./AppLayout.vue_vue_type_script_setup_true_lang-BfXcHqGL.js";import{_ as G}from"./TimeTracker.vue_vue_type_script_setup_true_lang-DqSiGLXj.js";import{M}from"./MainContainer-WpbdfkDp.js";import"./permissions-Cy8U4TFG.js";import{u as J}from"./notification-Cqm5OIAz.js";import"./time-D8Z5bJ3P.js";import"./money-DE8Cj37t.js";import{d as R}from"./utc-BCs3FwGo.js";import{_ as X}from"./ProjectDropdownItem.vue_vue_type_script_setup_true_lang-wvL1v9C2.js";import"./useMembers-D1lZTqLC.js";import{_ as Y}from"./TagBadge.vue_vue_type_script_setup_true_lang-Bl_ueEok.js";import{P as Z,c as ee}from"./utils-CCwwB18o.js";import{b as te}from"./index-DinQ5eO0.js";import{r as se}from"./TimeTrackerProjectTaskDropdown.vue_vue_type_script_setup_true_lang-BwWIfvvx.js";import{r as $}from"./ClockIcon-D8bkQBdi.js";import"./index-NRw1C4BU.js";import"./useFocusGuards-BJPjJVKi.js";import"./billing-BrKRBYHJ.js";import"./useOrganization-fnI1XVs5.js";import"./init-Ddj1H8ev.js";import"./bundle-mjs-D696Ktp4.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./DialogModal.vue_vue_type_script_setup_true_lang-Cdp4pUKI.js";import"./Modal.vue_vue_type_script_setup_true_lang-s_ZkTFQt.js";import"./PrimaryButton.vue_vue_type_script_setup_true_lang-CWUYAS8h.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CcpHAXFE.js";import"./SecondaryButton.vue_vue_type_script_setup_true_lang-DBBC7wMi.js";import"./theme-CJTqdCW4.js";import"./useQuery-BH-Arugy.js";import"./ClockIcon-CYfSOCq5.js";import"./CardTitle.vue_vue_type_script_setup_true_lang-CyznVp_q.js";import"./TagDropdown.vue_vue_type_script_setup_true_lang-DArOXIGF.js";import"./TagCreateModal.vue_vue_type_script_setup_true_lang-BZ1Krxqg.js";import"./TextInput.vue_vue_type_script_setup_true_lang-Cw992cSP.js";import"./CheckCircleIcon-Cls-9biQ.js";import"./component-D2dmHEOx.js";import"./SelectDropdown.vue_vue_type_script_setup_true_lang-CaZ4i_G-.js";import"./DatePicker-DsbVNWEA.js";import"./BillableIcon-C1VJddF3.js";import"./ProjectCreateModal.vue_vue_type_script_setup_true_lang-CZmoGoj9.js";import"./ProjectEditBillableSection.vue_vue_type_script_setup_true_lang-DqRZf2t1.js";import"./InputLabel.vue_vue_type_script_setup_true_lang-BJprejo3.js";import"./BillableRateInput.vue_vue_type_script_setup_true_lang-B9u_Q2bT.js";import"./usePrimitiveElement-Dt-Gdg0c.js";import"./useLocale-CRrU4gHp.js";import"./clamp-D21Fl2C-.js";import"./createLucideIcon-CLDLlRIF.js";import"./PlusIcon-DXN6bajS.js";const j=z({__name:"Button",props:{variant:{},size:{},class:{},asChild:{type:Boolean},as:{default:"button"}},setup(_){const o=_;return(n,h)=>(s(),p(u(Z),{as:n.as,"as-child":n.asChild,class:k(u(ee)(u(te)({variant:n.variant,size:n.size}),o.class))},{default:c(()=>[P(n.$slots,"default")]),_:3},8,["as","as-child","class"]))}}),oe={class:"my-1 p-5 border-2",style:{width:"55%"}},re={class:"col-span-full my-1 py-1"},ie={class:"text-md mb-2"},ae={class:"max-h-20 overflow-y-scroll",style:{"max-height":"50vh"}},le={class:"font-semibold text-md py-2 px-3 bg-gray-900 text-gray-300"},ne={class:""},me={class:"basis-64 flex content-center"},de={class:"basis-64 flex content-center"},ce={class:"basis-64"},ue={class:"flex items-center lg:space-x-1 min-w-0"},pe={class:"whitespace-nowrap text-xs lg:text-sm"},fe={key:1,class:"min-w-0 shrink text-xs lg:text-sm truncate"},be={class:"basis-64 overflow-hidden"},ye={key:0,class:"w-full"},_e={class:"text-muted-foreground text-sm bold text-text-primary font-semibold text-sm lg:text-base flex items-center space-x-2 lg:space-x-2.5"},he={class:"flex w-full items-center space-x-2 lg:space-x-2.5"},ft=z({__name:"index",props:{entries:{},period:{},totalHours:{},totalHoursNotForm:{},isSubmit:{type:Boolean},isApproved:{type:Boolean}},setup(_){const o=J();U();const n=()=>{o.invalidateQueries({queryKey:["latestTasks"]}),o.invalidateQueries({queryKey:["lastSevenDays"]}),o.invalidateQueries({queryKey:["dailyTrackedHours"]}),o.invalidateQueries({queryKey:["latestTeamActivity"]}),o.invalidateQueries({queryKey:["weeklyProjectOverview"]}),o.invalidateQueries({queryKey:["totalWeeklyTime"]}),o.invalidateQueries({queryKey:["totalWeeklyBillableTime"]}),o.invalidateQueries({queryKey:["totalWeeklyBillableAmount"]}),o.invalidateQueries({queryKey:["weeklyHistory"]}),o.invalidateQueries({queryKey:["timeEntries"]})},h=x(!0);function H(a){const l=new Date(a.start).getTime(),y=new Date(a.end).getTime();if(isNaN(l)||isNaN(y))return"0h 0m";const f=Math.floor((y-l)/(1e3*60)),t=Math.floor(f/60),v=f%60;return`${t}h ${v}m`}const r=_,C=x(r.entries);function A(a){return new Date(a).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"2-digit"})}function g(){window.history.back()}function D(a){return new Date(a).toLocaleDateString("en-US",{month:"long",day:"numeric",year:"numeric"})}const F=Q(()=>D(r.period.from)),V=Q(()=>D(r.period.to)),S=x({date_start:r.period.from.split("T")[0],date_end:r.period.to.split("T")[0],hours:r.totalHoursNotForm}),E=async()=>{r.isSubmit?(await K.post("/api/time/unsubmit",S.value),console.log("isSubmit")):(await K.post("/api/time/submit",S.value),console.log("is unSubmit")),g()};function q(a){return a?R(a).format("hh:mm:ss A"):""}W(()=>{console.log(C),h.value=!0});const L=r.isSubmit?" px-4 py-2 bg-red-600 text-white rounded":" px-4 py-2 bg-green-600 text-white rounded";return(a,l)=>(s(),p(O,{title:"Dashboard","data-testid":"dashboard_view"},{default:c(()=>[b(M,{class:"pt-5 sm:pt-8 pb-4 sm:pb-6 border-b border-default-background-separator"},{default:c(()=>[b(G,{onChange:n})]),_:1}),b(M,{class:"grid gap-5 sm:gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 pt-3 sm:pt-5 pb-4 sm:pb-6 border-b border-default-background-separator items-stretch"},{default:c(()=>[h.value?(s(),m("div",{key:0,onClick:w(g,["self"]),class:"fixed inset-0 z-50 flex items-center justify-center",style:{"background-color":"rgba(0,0,0,0.8)"}},[e("div",oe,[e("div",re,[l[0]||(l[0]=e("h2",{class:"text-lg font-semibold mb-1"},"My Entries",-1)),e("div",ie,i(F.value)+" - "+i(V.value),1),e("div",ae,[(s(!0),m(T,null,B(C.value,(y,f)=>(s(),m("div",{key:f,class:"mt-4 mb-4 border"},[e("h2",le,i(A(f)),1),e("ul",ne,[(s(!0),m(T,null,B(y,t=>(s(),m("li",{key:t.id,class:"flex flex-row px-3 rounded border py-2"},[e("div",me,i(q(t.start))+" - "+i(q(t.end)),1),e("div",de,i(H(t))+" - "+i(t.description||"No description"),1),e("div",ce,[t.project?(s(),p(X,{key:0,color:t.project.color,size:"large",border:!0,class:k("focus:border-border-tertiary w-full focus:outline-0 focus:bg-card-background-separator min-w-0 relative ")},{default:c(()=>[e("div",ue,[e("span",pe,i(t.project.name),1),t.task?(s(),p(u(se),{key:0,class:"w-4 lg:w-5 text-text-secondary shrink-0"})):d("",!0),t.task?(s(),m("div",fe,i(t.task.name),1)):d("",!0)])]),_:2},1032,["color"])):d("",!0)]),e("div",be,[t.tags.length>0?(s(),m("div",ye,[b(Y,{class:"truncate text-ellipsis overflow-hidden whitespace-nowrap",border:!1,size:"large",name:t.tags.map(v=>v.name).join(", ")},null,8,["name"])])):d("",!0)])]))),128))])]))),128))]),e("div",_e,[u($)?(s(),p(I(u($)),{key:0,class:"w-5 lg:w-4 text-icon-default mr-2"})):d("",!0),e("div",null,i(r.totalHours),1)])]),e("form",{onSubmit:w(E,["prevent"]),class:"space-y-4 w-full"},[e("div",he,[b(j,{onClick:w(g,["prevent"]),class:"px-4 py-2 bg-blue-600 text-white rounded"},{default:c(()=>l[1]||(l[1]=[N(" Close ")])),_:1,__:[1]}),r.isApproved?d("",!0):(s(),p(j,{key:0,type:"submit",class:k(u(L))},{default:c(()=>[N(i(r.isSubmit?"Unsubmit":"Submit"),1)]),_:1},8,["class"]))])],32)])])):d("",!0)]),_:1})]),_:1}))}});export{ft as default};
