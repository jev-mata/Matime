{"version":3,"file":"UpdateProfileInformationForm.vue_vue_type_script_setup_true_lang-DZstLLQJ.js","sources":["../../../resources/js/Pages/Profile/Partials/UpdateProfileInformationForm.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { ref } from 'vue';\nimport { Link, router, useForm, usePage } from '@inertiajs/vue3';\nimport ActionMessage from '@/Components/ActionMessage.vue';\nimport FormSection from '@/Components/FormSection.vue';\nimport InputError from '@/packages/ui/src/Input/InputError.vue';\nimport InputLabel from '@/packages/ui/src/Input/InputLabel.vue';\nimport PrimaryButton from '@/packages/ui/src/Buttons/PrimaryButton.vue';\nimport SecondaryButton from '@/packages/ui/src/Buttons/SecondaryButton.vue';\nimport TextInput from '@/packages/ui/src/Input/TextInput.vue';\nimport type { User } from '@/types/models';\n\nconst props = defineProps<{\n    user: User;\n}>();\n\nconst form = useForm({\n    _method: 'PUT',\n    name: props.user.name,\n    email: props.user.email,\n    photo: null as File | null,\n    timezone: props.user.timezone,\n    week_start: props.user.week_start,\n});\n\nconst verificationLinkSent = ref<boolean | null>(null);\nconst photoPreview = ref<ArrayBuffer | undefined | string | null>(null);\nconst photoInput = ref<HTMLInputElement | null>(null);\n\nconst updateProfileInformation = () => {\n    const file = photoInput.value?.files?.[0] ?? null;\n\n    if (file instanceof File) {\n        form.photo = file;\n    } else {\n        form.photo = null;\n    }\n\n    form.post(route('user-profile-information.update'), {\n        errorBag: 'updateProfileInformation',\n        preserveScroll: true,\n        onSuccess: () => {\n            clearPhotoFileInput();\n        },\n        onError: (errors) => {\n            console.error('Profile update failed:', errors);\n        },\n    });\n};\n\nconst sendEmailVerification = () => {\n    verificationLinkSent.value = true;\n};\n\nconst selectNewPhoto = () => {\n    photoInput.value?.click();\n};\n\nconst updatePhotoPreview = () => {\n    if (photoInput.value?.files) {\n        const photo = photoInput.value?.files[0];\n        if (!photo) return;\n\n        const reader = new FileReader();\n\n        reader.onload = (e) => {\n            photoPreview.value = e.target?.result;\n        };\n\n        reader.readAsDataURL(photo);\n    }\n};\n\nconst deletePhoto = () => {\n    router.delete(route('current-user-photo.destroy'), {\n        preserveScroll: true,\n        onSuccess: () => {\n            photoPreview.value = null;\n            clearPhotoFileInput();\n        },\n    });\n};\n\nconst clearPhotoFileInput = () => {\n    if (photoInput.value?.value) {\n        photoInput.value.value = '';\n    }\n};\n\nconst page = usePage<{\n    jetstream: {\n        managesProfilePhotos: boolean;\n        hasEmailVerification: boolean;\n    };\n}>();\n</script>\n\n<template>\n    <FormSection @submitted=\"updateProfileInformation\">\n        <template #title> Profile Information</template>\n\n        <template #description>\n            Update your account's profile information and email address.\n        </template>\n\n        <template #form>\n            <!-- Profile Photo -->\n            <div\n                v-if=\"page.props.jetstream.managesProfilePhotos\"\n                class=\"col-span-6 sm:col-span-4\">\n                <!-- Profile Photo File Input -->\n                <input\n                    id=\"photo\"\n                    ref=\"photoInput\"\n                    type=\"file\"\n                    name=\"photo\"\n                    class=\"hidden\"\n                    @change=\"updatePhotoPreview\" />\n\n                <InputLabel for=\"photo\" value=\"Photo\" />\n\n                <!-- Current Profile Photo -->\n                <div v-show=\"!photoPreview\" class=\"mt-2\">\n                    <img\n                        :src=\"user.profile_photo_url\"\n                        :alt=\"user.name\"\n                        class=\"rounded-full h-20 w-20 object-cover\" />\n                </div>\n\n                <!-- New Profile Photo Preview -->\n                <div v-show=\"photoPreview\" class=\"mt-2\">\n                    <span\n                        class=\"block rounded-full w-20 h-20 bg-cover bg-no-repeat bg-center\"\n                        :style=\"\n                            'background-image: url(\\'' + photoPreview + '\\');'\n                        \" />\n                </div>\n\n                <SecondaryButton\n                    class=\"mt-2 me-2\"\n                    type=\"button\"\n                    @click.prevent=\"selectNewPhoto\">\n                    Select A New Photo\n                </SecondaryButton>\n\n                <SecondaryButton\n                    v-if=\"user.profile_photo_path\"\n                    type=\"button\"\n                    class=\"mt-2\"\n                    @click.prevent=\"deletePhoto\">\n                    Remove Photo\n                </SecondaryButton>\n\n                <InputError :message=\"form.errors.photo\" class=\"mt-2\" />\n            </div>\n\n            <!-- Name -->\n            <div class=\"col-span-6 sm:col-span-4\">\n                <InputLabel for=\"name\" value=\"Name\" />\n                <TextInput\n                    id=\"name\"\n                    v-model=\"form.name\"\n                    type=\"text\"\n                    class=\"mt-1 block w-full\"\n                    required\n                    autocomplete=\"name\" />\n                <InputError :message=\"form.errors.name\" class=\"mt-2\" />\n            </div>\n\n            <!-- Email -->\n            <div class=\"col-span-6 sm:col-span-4\">\n                <InputLabel for=\"email\" value=\"Email\" />\n                <TextInput\n                    id=\"email\"\n                    v-model=\"form.email\"\n                    type=\"email\"\n                    class=\"mt-1 block w-full\"\n                    required\n                    autocomplete=\"username\" />\n                <InputError :message=\"form.errors.email\" class=\"mt-2\" />\n\n                <div\n                    v-if=\"\n                        page.props.jetstream.hasEmailVerification &&\n                        user.email_verified_at === null\n                    \">\n                    <p class=\"text-sm mt-2 text-text-primary\">\n                        Your email address is unverified.\n\n                        <Link\n                            :href=\"route('verification.send')\"\n                            method=\"post\"\n                            as=\"button\"\n                            class=\"underline text-sm text-text-secondary hover:text-text-secondary rounded-md focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 dark:focus:ring-offset-gray-800\"\n                            @click.prevent=\"sendEmailVerification\">\n                            Click here to re-send the verification email.\n                        </Link>\n                    </p>\n\n                    <div\n                        v-show=\"verificationLinkSent\"\n                        class=\"mt-2 font-medium text-sm text-green-400\">\n                        A new verification link has been sent to your email\n                        address.\n                    </div>\n                </div>\n            </div>\n\n            <!-- Timezone -->\n            <div class=\"col-span-6 sm:col-span-4\">\n                <InputLabel for=\"timezone\" value=\"Timezone\" />\n                <select\n                    id=\"timezone\"\n                    v-model=\"form.timezone\"\n                    name=\"timezone\"\n                    required\n                    class=\"mt-1 block w-full border-input-border bg-input-background text-text-primary focus:border-input-border-active rounded-md shadow-sm\">\n                    <option value=\"\" disabled>Select a Timezone</option>\n                    <option\n                        v-for=\"(timezoneTranslated, timezoneKey) in $page.props\n                            .timezones\"\n                        :key=\"timezoneKey\"\n                        :value=\"timezoneKey\">\n                        {{ timezoneTranslated }}\n                    </option>\n                </select>\n                <InputError :message=\"form.errors.timezone\" class=\"mt-2\" />\n            </div>\n\n            <!-- Week start -->\n            <div class=\"col-span-6 sm:col-span-4\">\n                <InputLabel for=\"week_start\" value=\"Start of the week\" />\n                <select\n                    id=\"week_start\"\n                    v-model=\"form.week_start\"\n                    name=\"week_start\"\n                    required\n                    class=\"mt-1 block w-full border-input-border bg-input-background text-text-primary focus:border-input-border-active rounded-md shadow-sm\">\n                    <option value=\"\" disabled>Select a week day</option>\n                    <option\n                        v-for=\"(weekdayTranslated, weekdayKey) in $page.props\n                            .weekdays\"\n                        :key=\"weekdayKey\"\n                        :value=\"weekdayKey\">\n                        {{ weekdayTranslated }}\n                    </option>\n                </select>\n                <InputError :message=\"form.errors.week_start\" class=\"mt-2\" />\n            </div>\n        </template>\n\n        <template #actions>\n            <ActionMessage :on=\"form.recentlySuccessful\" class=\"me-3\">\n                Saved.\n            </ActionMessage>\n\n            <PrimaryButton\n                :class=\"{ 'opacity-25': form.processing }\"\n                :disabled=\"form.processing\">\n                Save\n            </PrimaryButton>\n        </template>\n    </FormSection>\n</template>\n"],"names":["props","__props","form","useForm","verificationLinkSent","ref","photoPreview","photoInput","updateProfileInformation","file","_b","_a","clearPhotoFileInput","errors","sendEmailVerification","selectNewPhoto","updatePhotoPreview","photo","reader","e","deletePhoto","router","page","usePage","_createBlock","FormSection","_cache","_unref","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_createVNode","InputLabel","_withDirectives","_hoisted_2","user","_hoisted_4","_normalizeStyle","SecondaryButton","InputError","_hoisted_5","TextInput","$event","_hoisted_6","_hoisted_7","_hoisted_8","Link","route","_hoisted_9","_hoisted_10","_Fragment","_renderList","$page","timezoneTranslated","timezoneKey","_hoisted_11","_vModelSelect","_hoisted_12","weekdayTranslated","weekdayKey","_hoisted_13","ActionMessage","PrimaryButton","_normalizeClass"],"mappings":"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"}