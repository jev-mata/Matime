import{a as B,m as Z,d as U}from"./time-D8Z5bJ3P.js";import{f as W}from"./money-042SSt8Q.js";import{_ as K}from"./GroupedItemsCountButton.vue_vue_type_script_setup_true_lang-DBKB4zI6.js";import{t as Y}from"./bundle-mjs-D696Ktp4.js";import{h as x,o as p,f as v,d as T,r as S,B as j,a as J,F as A,j as E,n as Q,u,b as w,w as X,l as ee,t as C,i as te,C as M,a9 as re,c as _,E as ae,A as k}from"./app-Dzd5B06R.js";import{ag as P,a4 as R,E as V,ah as q,ao as oe,aj as G,ak as O,al as z,am as H,an as I,ai as ne}from"./install-CcUZdaBt.js";import{a as $}from"./index-NRw1C4BU.js";import{_ as se}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as le,a as F}from"./notification-Cqm5OIAz.js";import{g as L,a as ie,e as ce,h as ue,d as pe,b as de,u as me}from"./useMembers-D1lZTqLC.js";import{B as fe}from"./BillableIcon-C1VJddF3.js";import{a as ge,r as ve}from"./MainContainer-WpbdfkDp.js";import{r as be}from"./FolderIcon-DWxb3Ngj.js";import{r as he}from"./CheckCircleIcon-Cls-9biQ.js";function ye(d,r){return p(),x("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[v("path",{"fill-rule":"evenodd",d:"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm1 5.75A.75.75 0 0 1 5.75 7h4.5a.75.75 0 0 1 0 1.5h-4.5A.75.75 0 0 1 5 7.75Zm0 3a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75Z","clip-rule":"evenodd"})])}const _e={class:"contents text-text-primary [&>*]:transition [&>*]:border-card-background-separator [&>*]:border-b [&>*]:h-[50px]"},xe={class:"justify-end flex items-center"},Ce={class:"justify-end pr-6 flex items-center"},ke={key:0,class:"col-span-3 grid bg-quaternary",style:{"grid-template-columns":"1fr 150px 150px"}},Ge=T({__name:"ReportingRow",props:{entry:{},indent:{type:Boolean},currency:{}},setup(d){const r=d,i=S(!1),a=j("organization");return(o,l)=>{var n,m,s,e,t,g;const c=J("ReportingRow",!0);return p(),x(A,null,[v("div",_e,[v("div",{class:Q(u(Y)("pl-6 font-medium flex items-center space-x-3",r.indent?"pl-16":""))},[o.entry.grouped_data&&((n=o.entry.grouped_data)==null?void 0:n.length)>0?(p(),w(K,{key:0,expanded:i.value,onClick:l[0]||(l[0]=f=>i.value=!i.value)},{default:X(()=>{var f;return[ee(C((f=o.entry.grouped_data)==null?void 0:f.length),1)]}),_:1},8,["expanded"])):E("",!0),v("span",null,C(o.entry.description),1)],2),v("div",xe,C(u(B)(o.entry.seconds,(m=u(a))==null?void 0:m.interval_format,(s=u(a))==null?void 0:s.number_format)),1),v("div",Ce,C(o.entry.cost?u(W)(o.entry.cost,r.currency,(e=u(a))==null?void 0:e.currency_format,(t=u(a))==null?void 0:t.currency_symbol,(g=u(a))==null?void 0:g.number_format):"--"),1)]),i.value&&o.entry.grouped_data?(p(),x("div",ke,[(p(!0),x(A,null,te(o.entry.grouped_data,f=>(p(),w(c,{key:f.description??"none",currency:r.currency,indent:"",entry:f},null,8,["currency","entry"]))),128))])):E("",!0)],64)}}}),we={class:"w-[calc(100%-1px)]"},Re={key:1,class:"chart flex flex-col items-center justify-center"},Se=T({__name:"ReportingChart",props:{groupedData:{},groupedType:{}},setup(d){P([q,oe,G,O,z,H]),M(I,"dark");const r=j("organization"),i=re(null),a=d,o=_(()=>{var s,e;return a.groupedType==="week"?(s=a==null?void 0:a.groupedData)==null?void 0:s.map(t=>Z(t.key)):(e=a==null?void 0:a.groupedData)==null?void 0:e.map(t=>{var g;return U(t.key??"",(g=r==null?void 0:r.value)==null?void 0:g.date_format)})}),l=$("--theme-color-chart",null,{observe:!0}),c=$("--color-text-secondary",null,{observe:!0}),n=_(()=>{var s;return(s=a==null?void 0:a.groupedData)==null?void 0:s.map(e=>({value:e.seconds,itemStyle:{borderColor:new R(0,0,0,1,[{offset:0,color:"rgba("+l.value+",0.7)"},{offset:1,color:"rgba("+l.value+",0.5)"}]),emphasis:{color:new R(0,0,0,1,[{offset:0,color:"rgba("+l.value+",0.9)"},{offset:1,color:"rgba("+l.value+",0.7)"}])},borderRadius:[12,12,0,0],color:new R(0,0,0,1,[{offset:0,color:"rgba("+l.value+",0.7)"},{offset:1,color:"rgba("+l.value+",0.5)"}])}}))}),m=_(()=>({tooltip:{trigger:"item"},grid:{top:0,right:0,bottom:50,left:0},backgroundColor:"transparent",xAxis:{type:"category",data:o.value,markLine:{lineStyle:{color:"rgba(125,156,188,0.1)",type:"dashed"}},axisLine:{lineStyle:{color:"transparent"}},axisLabel:{fontSize:12,fontWeight:600,color:c.value,margin:16,fontFamily:"Outfit, sans-serif"},axisTick:{lineStyle:{color:"transparent"}}},yAxis:{type:"value",splitLine:{lineStyle:{color:"rgba(125,156,188,0.2)"}}},series:[{data:n.value,type:"bar",tooltip:{valueFormatter:s=>{var e,t;return B(s,(e=r==null?void 0:r.value)==null?void 0:e.interval_format,(t=r==null?void 0:r.value)==null?void 0:t.number_format)}}}]}));return(s,e)=>{var t;return p(),x("div",we,[s.groupedData&&((t=s.groupedData)==null?void 0:t.length)>0?(p(),w(u(V),{key:0,ref_key:"chart",ref:i,autoresize:!0,class:"chart",option:m.value},null,8,["option"])):(p(),x("div",Re,e[0]||(e[0]=[v("p",{class:"text-lg text-text-primary font-semibold"}," No time entries found ",-1),v("p",null,"Try to change the filters and time range",-1)])))])}}}),Oe=se(Se,[["__scopeId","data-v-5168f716"]]),ze=T({__name:"ReportingPieChart",props:{data:{}},setup(d){P([q,ne,G,O,z,H]),M(I,"dark");const r=j("organization"),i=d,a=$("--color-text-secondary",null,{observe:!0}),o=_(()=>{var c;return(c=i.data)==null?void 0:c.map(n=>({...n,itemStyle:{color:`${n.color}BB`},emphasis:{itemStyle:{color:`${n.color}`}}}))}),l=_(()=>({tooltip:{trigger:"item"},legend:{show:!0,top:"250px",textStyle:{color:a.value}},backgroundColor:"transparent",series:[{label:{show:!1},tooltip:{valueFormatter:c=>{var n,m;return B(c,(n=r==null?void 0:r.value)==null?void 0:n.interval_format,(m=r==null?void 0:r.value)==null?void 0:m.number_format)}},data:o.value,radius:["30%","60%"],top:"-45%",type:"pie"}]}));return(c,n)=>(p(),w(u(V),{class:"background-transparent max-w-[300px] mx-auto h-[460px]",autoresize:!0,option:l.value},null,8,["option"]))}}),He=ae("reporting",()=>{const d=S(null),r=S(null),{handleApiRequestNotifications:i}=le();async function a(e){const t=L();t&&(d.value=await i(()=>F.getAggregatedTimeEntries({params:{organization:t},queries:e}),void 0,"Failed to fetch reporting data"))}async function o(e){const t=L();t&&(r.value=await i(()=>F.getAggregatedTimeEntries({params:{organization:t},queries:e}),void 0,"Failed to fetch reporting data"))}const l=_(()=>{var e;return(e=d.value)==null?void 0:e.data}),c=_(()=>{var e;return(e=r.value)==null?void 0:e.data}),n={user:"No User",project:"No Project",task:"No Task",billable:"Non-Billable",client:"No Client",description:"No Description"};function m(e,t){var g,f,N,D;if(t===null)return null;if(e===null)return n[t];if(t==="project"){const b=ie(),{projects:h}=k(b);return(g=h.value.find(y=>y.id===e))==null?void 0:g.name}if(t==="user"){if(ce()==="employee")return ue().name;const b=pe(),{members:h}=k(b);return(f=h.value.find(y=>y.user_id===e))==null?void 0:f.name}if(t==="task"){const b=de(),{tasks:h}=k(b);return(N=h.value.find(y=>y.id===e))==null?void 0:N.name}if(t==="client"){const b=me(),{clients:h}=k(b);return(D=h.value.find(y=>y.id===e))==null?void 0:D.name}return t==="billable"?e==="0"?"Non-Billable":"Billable":e}return{aggregatedGraphTimeEntries:l,fetchGraphReporting:a,fetchTableReporting:o,aggregatedTableTimeEntries:c,getNameForReportingRowEntry:m,groupByOptions:[{label:"Members",value:"user",icon:ge},{label:"Projects",value:"project",icon:be},{label:"Tasks",value:"task",icon:he},{label:"Clients",value:"client",icon:ve},{label:"Billable",value:"billable",icon:fe},{label:"Description",value:"description",icon:ye}],emptyPlaceholder:n}});export{Oe as R,ze as _,Ge as a,He as u};
