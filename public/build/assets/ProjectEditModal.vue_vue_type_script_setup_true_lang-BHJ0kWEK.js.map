{"version":3,"file":"ProjectEditModal.vue_vue_type_script_setup_true_lang-BHJ0kWEK.js","sources":["../../../resources/js/packages/ui/src/EstimatedTimeProgress.vue","../../../resources/js/Components/Common/UpgradeBadge.vue","../../../resources/js/packages/ui/src/Project/ProjectBillableRateModal.vue","../../../resources/js/Components/Common/Project/ProjectEditModal.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport { computed } from 'vue';\n\nconst props = defineProps<{ estimated: number; current: number }>();\nfunction formatHours(seconds: number) {\n    return Math.round(seconds / 60 / 60) + 'h';\n}\n\nconst isOverEstimate = computed(() => props.current > props.estimated);\nconst progressBarPercentage = computed(() => {\n    return (props.current / props.estimated) * 100;\n});\nconst formattedProgressBarPercentage = computed(() => {\n    return progressBarPercentage.value.toFixed(1) + '%';\n});\n</script>\n<template>\n    <div class=\"w-full\">\n        <div class=\"bg-tertiary h-1 rounded relative overflow-hidden w-full\">\n            <div\n                class=\"h-full\"\n                :class=\"{\n                    'bg-accent-200': !isOverEstimate,\n                    'bg-red-500': isOverEstimate,\n                }\"\n                :style=\"{ width: progressBarPercentage + '%' }\"></div>\n        </div>\n        <div class=\"text-xs font-semibold pt-1.5\">\n            {{ formattedProgressBarPercentage }} of\n            {{ formatHours(estimated) }}\n        </div>\n    </div>\n</template>\n\n<style scoped></style>\n","<script setup lang=\"ts\">\nimport { LockClosedIcon } from '@heroicons/vue/20/solid';\nimport UpgradeModal from '@/Components/Common/UpgradeModal.vue';\nimport { ref } from 'vue';\nconst showUpgradeModal = ref(false);\n</script>\n\n<template>\n    <UpgradeModal v-model:show=\"showUpgradeModal\">\n        <strong>Project and Task Estimates</strong> is only available in\n        solidtime Professional.\n    </UpgradeModal>\n    <button\n        class=\"inline-flex bg-secondary hover:bg-tertiary px-2 py-1 rounded border border-border-secondary hover:border-border-tertiary items-center space-x-1\"\n        @click.prevent=\"showUpgradeModal = true\">\n        <LockClosedIcon class=\"w-3 text-text-tertiary\"></LockClosedIcon>\n        <span class=\"text-xs text-text-secondary font-semibold\"> Upgrade </span>\n    </button>\n</template>\n\n<style scoped></style>\n","<script setup lang=\"ts\">\nimport { formatCents } from '@/packages/ui/src/utils/money';\nimport BillableRateModal from '@/packages/ui/src/BillableRateModal.vue';\nimport { inject, type ComputedRef } from 'vue';\nimport type { Organization } from '@/packages/api/src';\n\nconst show = defineModel('show', { default: false });\nconst saving = defineModel('saving', { default: false });\n\nconst organization = inject<ComputedRef<Organization>>('organization');\n\ndefineProps<{\n    newBillableRate?: number | null;\n    projectName: string;\n    currency: string;\n}>();\n\ndefineEmits<{\n    submit: [];\n}>();\n</script>\n\n<template>\n    <BillableRateModal\n        v-model:show=\"show\"\n        v-model:saving=\"saving\"\n        title=\"Update Project Billable Rate\"\n        @submit=\"$emit('submit')\">\n        <p class=\"py-1 text-center\">\n            The billable rate of {{ projectName }} will be updated to\n            <strong>{{\n                newBillableRate\n                    ? formatCents(\n                          newBillableRate,\n                          currency,\n                          organization?.currency_format,\n                          organization?.currency_symbol,\n                          organization?.number_format\n                      )\n                    : ' the default rate of the organization member'\n            }}</strong\n            >.\n        </p>\n        <p class=\"py-1 text-center font-semibold max-w-md mx-auto\">\n            Do you want to update all existing time entries, where the project\n            billable rate applies as well?\n        </p>\n    </BillableRateModal>\n</template>\n\n<style scoped></style>\n","<script setup lang=\"ts\">\nimport TextInput from '@/packages/ui/src/Input/TextInput.vue';\nimport SecondaryButton from '@/packages/ui/src/Buttons/SecondaryButton.vue';\nimport DialogModal from '@/packages/ui/src/DialogModal.vue';\nimport { computed, ref } from 'vue';\nimport type {\n    CreateClientBody,\n    CreateProjectBody,\n    Project,\n} from '@/packages/api/src';\nimport PrimaryButton from '@/packages/ui/src/Buttons/PrimaryButton.vue';\nimport { useProjectsStore } from '@/utils/useProjects';\nimport { useFocus } from '@vueuse/core';\nimport ClientDropdown from '@/packages/ui/src/Client/ClientDropdown.vue';\nimport Badge from '@/packages/ui/src/Badge.vue';\nimport { useClientsStore } from '@/utils/useClients';\nimport { storeToRefs } from 'pinia';\nimport ProjectColorSelector from '@/packages/ui/src/Project/ProjectColorSelector.vue';\nimport { UserCircleIcon } from '@heroicons/vue/20/solid';\nimport EstimatedTimeSection from '@/packages/ui/src/EstimatedTimeSection.vue';\nimport InputLabel from '@/packages/ui/src/Input/InputLabel.vue';\nimport ProjectBillableRateModal from '@/packages/ui/src/Project/ProjectBillableRateModal.vue';\nimport { getOrganizationCurrencyString } from '@/utils/money';\nimport ProjectEditBillableSection from '@/packages/ui/src/Project/ProjectEditBillableSection.vue';\nimport { isAllowedToPerformPremiumAction } from '@/utils/billing';\n\nconst { updateProject } = useProjectsStore();\nconst { clients } = storeToRefs(useClientsStore());\nconst show = defineModel('show', { default: false });\nconst saving = ref(false);\nconst showBillableRateModal = ref(false);\nconst props = defineProps<{\n    originalProject: Project;\n}>();\n\nasync function createClient(body: CreateClientBody) {\n    return await useClientsStore().createClient(body);\n}\n\nconst project = ref<CreateProjectBody>({\n    name: props.originalProject.name,\n    color: props.originalProject.color,\n    client_id: props.originalProject.client_id,\n    billable_rate: props.originalProject.billable_rate,\n    is_billable: props.originalProject.is_billable,\n    estimated_time: props.originalProject.estimated_time,\n});\n\nasync function submit() {\n    if (props.originalProject.billable_rate !== project.value.billable_rate) {\n        // make sure that the alert modal is not immediately submitted when user presses enter\n        setTimeout(() => {\n            showBillableRateModal.value = true;\n        }, 0);\n        return;\n    }\n    await updateProject(props.originalProject.id, project.value);\n    show.value = false;\n}\n\nconst projectNameInput = ref<HTMLInputElement | null>(null);\n\nuseFocus(projectNameInput, { initialValue: true });\n\nconst currentClientName = computed(() => {\n    if (project.value.client_id) {\n        return clients.value.find(\n            (client) => client.id === project.value.client_id\n        )?.name;\n    }\n    return 'No Client';\n});\n\nasync function submitBillableRate() {\n    await updateProject(props.originalProject.id, project.value);\n    show.value = false;\n    showBillableRateModal.value = false;\n}\n</script>\n\n<template>\n    <DialogModal closeable :show=\"show\" @close=\"show = false\">\n        <template #title>\n            <div class=\"flex space-x-2\">\n                <span> Edit Project {{ props.originalProject.name }} </span>\n            </div>\n        </template>\n\n        <template #content>\n            <div\n                class=\"sm:flex items-center space-y-2 sm:space-y-0 sm:space-x-5\">\n                <div class=\"flex-1 flex items-center\">\n                    <div class=\"text-center\">\n                        <InputLabel for=\"color\" value=\"Color\" />\n                        <ProjectColorSelector\n                            v-model=\"project.color\"\n                            class=\"mt-1\"></ProjectColorSelector>\n                    </div>\n                </div>\n                <div class=\"w-full\">\n                    <InputLabel for=\"projectName\" value=\"Project name\" />\n                    <TextInput\n                        id=\"projectName\"\n                        ref=\"projectNameInput\"\n                        v-model=\"project.name\"\n                        type=\"text\"\n                        placeholder=\"Project Name\"\n                        class=\"mt-1 block w-full\"\n                        required\n                        autocomplete=\"projectName\"\n                        @keydown.enter=\"submit()\" />\n                </div>\n                <div class=\"\">\n                    <InputLabel for=\"client\" value=\"Client\" />\n                    <ClientDropdown\n                        v-model=\"project.client_id\"\n                        :create-client\n                        :clients=\"clients\"\n                        class=\"mt-1\">\n                        <template #trigger>\n                            <Badge\n                                class=\"bg-input-background cursor-pointer hover:bg-tertiary\"\n                                size=\"xlarge\">\n                                <div class=\"flex items-center space-x-2\">\n                                    <UserCircleIcon\n                                        class=\"w-5 text-icon-default\"></UserCircleIcon>\n                                    <span class=\"whitespace-nowrap\">\n                                        {{ currentClientName }}\n                                    </span>\n                                </div>\n                            </Badge>\n                        </template>\n                    </ClientDropdown>\n                </div>\n            </div>\n            <div>\n                <div>\n                    <ProjectEditBillableSection\n                        v-model:is-billable=\"project.is_billable\"\n                        v-model:billable-rate=\"\n                            project.billable_rate\n                        \"\n                        :currency=\"getOrganizationCurrencyString()\"\n                        @submit=\"submit\"></ProjectEditBillableSection>\n                </div>\n                <div>\n                    <EstimatedTimeSection\n                        v-if=\"isAllowedToPerformPremiumAction()\"\n                        v-model=\"project.estimated_time\"\n                        @submit=\"submit()\"></EstimatedTimeSection>\n                </div>\n            </div>\n        </template>\n        <template #footer>\n            <SecondaryButton @click=\"show = false\"> Cancel</SecondaryButton>\n\n            <PrimaryButton\n                class=\"ms-3\"\n                :class=\"{ 'opacity-25': saving }\"\n                :disabled=\"saving\"\n                @click=\"submit\">\n                Update Project\n            </PrimaryButton>\n        </template>\n    </DialogModal>\n    <ProjectBillableRateModal\n        v-model:show=\"showBillableRateModal\"\n        :currency=\"getOrganizationCurrencyString()\"\n        :new-billable-rate=\"project.billable_rate\"\n        :project-name=\"project.name\"\n        @submit=\"submitBillableRate\"></ProjectBillableRateModal>\n</template>\n\n<style scoped></style>\n"],"names":["props","__props","formatHours","seconds","isOverEstimate","computed","progressBarPercentage","formattedProgressBarPercentage","_openBlock","_createElementBlock","_hoisted_1","_createElementVNode","_hoisted_2","_hoisted_3","_toDisplayString","estimated","showUpgradeModal","ref","_createVNode","UpgradeModal","$event","_cache","_unref","LockClosedIcon","show","_useModel","saving","organization","inject","_createBlock","BillableRateModal","$emit","projectName","newBillableRate","formatCents","currency","updateProject","useProjectsStore","clients","storeToRefs","useClientsStore","showBillableRateModal","createClient","body","project","submit","projectNameInput","useFocus","currentClientName","_a","client","submitBillableRate","DialogModal","_hoisted_4","InputLabel","ProjectColorSelector","_hoisted_5","TextInput","_hoisted_6","ClientDropdown","Badge","_hoisted_7","UserCircleIcon","_hoisted_8","ProjectEditBillableSection","getOrganizationCurrencyString","isAllowedToPerformPremiumAction","EstimatedTimeSection","SecondaryButton","PrimaryButton","_normalizeClass","ProjectBillableRateModal"],"mappings":"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"}