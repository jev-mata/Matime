import{M as be}from"./MainContainer-DAB7AmGD.js";import{U as Re,q as Ee,G as Ge,Q as Fe,t as qe,b as Ke,c as Oe,_ as Ze}from"./AppLayout.vue_vue_type_script_setup_true_lang-7v21bPMn.js";import{_ as S}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-iS1Fl1UI.js";import{a as je,b as F,c as $e}from"./useMembers-B2Kv7mzm.js";import{e as h,o as d,a as e,d as U,m as B,r as g,p as D,s as G,l as z,Q as He,B as Q,k as Le,c as w,w as l,f as M,u as t,b as a,q as se,h as Y,F as A,t as V,g as $,n as Z,z as J,C as Qe,i as _e,v as ie,I as ee,j as Je,x as We}from"./app-CZLkYVhz.js";import{_ as Me}from"./TextInput.vue_vue_type_script_setup_true_lang-DUXudii_.js";import{_ as ae}from"./DialogModal.vue_vue_type_script_setup_true_lang-Dn6gUihL.js";import{_ as H}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-DGqi3YE0.js";import{u as oe}from"./index-CHolqtoz.js";import{_ as Xe}from"./ProjectBadge.vue_vue_type_script_setup_true_lang-CJeOBiho.js";import{_ as Ye}from"./Dropdown.vue_vue_type_script_setup_true_lang-2TV_nqEm.js";import{a as K,b as et}from"./notification-BrLDF-00.js";import{g as tt}from"./color-NTCrcshl.js";import{_ as st}from"./ProjectDropdownItem.vue_vue_type_script_setup_true_lang-kZ0urNkA.js";import{U as at,r as ot}from"./component-CexCnHe5.js";import{_ as he}from"./ProjectEditBillableSection.vue_vue_type_script_setup_true_lang-BtqEk6mW.js";import{i as ue}from"./billing-F8TVwX2K.js";import{m as xe,n as Pe,o as re,p as we,q as lt}from"./permissions-hl9spDHx.js";import{_ as Ce,a as Te,b as O,r as Ve,c as Ue}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BgJhjCYQ.js";import{r as de}from"./PencilSquareIcon-krbQY_ys.js";import{r as me}from"./CheckCircleIcon-ByT7Dbrk.js";import{_ as pe,T as Ne}from"./TableHeading-5GheUSuW.js";import{_ as rt,a as nt,b as it}from"./ProjectEditModal.vue_vue_type_script_setup_true_lang-Ck1Rarjd.js";import{a as ut}from"./time-DR3Bm2fi.js";import{r as dt}from"./PlusCircleIcon-DmSaDtTa.js";import{r as te}from"./PlusIcon-gin79_-P.js";import{_ as ge}from"./CardTitle.vue_vue_type_script_setup_true_lang-ClAjIdUA.js";import{C as ke}from"./Card-LvPP0cru.js";import{g as W}from"./useUser-Dc3_Hjqo.js";import{f as le}from"./money-B3Da-j29.js";import{r as Ie,c as ze,_ as mt,a as pt}from"./format-D36BXmpa.js";import{_ as ne}from"./BillableRateInput.vue_vue_type_script_setup_true_lang-B3OqHB-h.js";import{g as R}from"./money-BufCQq2I.js";import{_ as ct}from"./BillableRateModal.vue_vue_type_script_setup_true_lang-Dz7krcgW.js";import{_ as ft}from"./InputLabel.vue_vue_type_script_setup_true_lang-DP24QN7l.js";/* empty css                                                                             */import{_ as X}from"./Badge.vue_vue_type_script_setup_true_lang-Bn80q8dA.js";import"./utc-YQln_hJX.js";import{_ as vt}from"./SelectDropdown.vue_vue_type_script_setup_true_lang-1bxQg4o6.js";import"./useCurrentTimeEntry-CruyZJNI.js";import"./theme-DlEllDdR.js";import{_ as bt,a as ye}from"./TabBar.vue_vue_type_script_setup_true_lang-D5JkrlW4.js";import{r as _t}from"./FolderIcon-BBOgs1tQ.js";import{r as xt}from"./UserGroupIcon-DEClCgLE.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./useOrganization-Dnx8kCk3.js";import"./init-DIMnQ95t.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-DKIr8CEw.js";import"./utils-DLNr0s0q.js";import"./useQuery-QapR65Yu.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CAmSBxXF.js";import"./ClockIcon-DtFwBiYn.js";import"./UserCircleIcon-B_03lMym.js";import"./TagIcon-D32GhY_O.js";import"./Modal.vue_vue_type_script_setup_true_lang-DiIZ2Ob1.js";import"./BillableIcon-BlL7cW2e.js";import"./Collection-Ddu0RjBR.js";import"./usePrimitiveElement-DVmz0I4p.js";import"./useTypeahead-DuqX-vkx.js";import"./RovingFocusGroup-j8ihdqB0.js";import"./UpgradeModal.vue_vue_type_script_setup_true_lang-DX0vhlsO.js";import"./useLocale-BQy7zCNL.js";import"./clamp-CUCcq9G3.js";import"./createLucideIcon-DWD2E6Wp.js";import"./ArrowTopRightOnSquareIcon-CNhq5Q_2.js";function wt(x,v){return d(),h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z","clip-rule":"evenodd"}),e("path",{d:"M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z"})])}const gt={key:0,class:"bg-card-background-active"},kt={class:"flex space-x-3 items-center px-4 py-3 text-xs font-medium border-t rounded-b-lg border-card-background-separator"},yt=U({__name:"ProjectDropdown",props:B({border:{type:Boolean,default:!0}},{modelValue:{default:null},modelModifiers:{}}),emits:B(["update:modelValue","changed"],["update:modelValue"]),setup(x,{emit:v}){const r=g(""),p=g(null),m=D(x,"modelValue"),s=g(!1),n=je(),u=v,{projects:c}=G(n),i=g(null),f=z(()=>c.value.filter(j=>{var C,_;return j.name.toLowerCase().includes(((_=(C=r.value)==null?void 0:C.toLowerCase())==null?void 0:_.trim())||"")})),o=He();async function y(){if(r.value.length>0&&f.value.length===0){const j=await K.createProject({name:r.value,color:tt(),is_billable:!1},{params:{organization:o.props.auth.user.current_team_id}});c.value.unshift(j.data),m.value=j.data.id,r.value="",s.value=!1}}Q(s,j=>{j&&(Le(()=>{var C,_;(_=(C=p.value)==null?void 0:C.$el)==null||_.focus()}),c.value.sort(C=>m.value===C.id?-1:1))});const N=z(()=>c.value.find(j=>j.id===m.value));function P(j){return m.value===j.id}const b=z(()=>{var j;return((j=N.value)==null?void 0:j.name)||"No Project"}),T=z(()=>{var j;return((j=N.value)==null?void 0:j.color)||"var(--theme-color-icon-default)"});function E(j){m.value=j.id,u("changed")}return(j,C)=>(d(),w(Ye,{modelValue:s.value,"onUpdate:modelValue":C[1]||(C[1]=_=>s.value=_),align:"start",width:"60"},{trigger:l(()=>[a(Xe,{ref_key:"projectDropdownTrigger",ref:i,color:T.value,size:"xlarge",border:j.border,tag:"button",name:b.value,class:"focus:border-input-border-active bg-input-background focus:outline-0 focus:bg-card-background-separator hover:bg-card-background-separator"},null,8,["color","border","name"])]),content:l(()=>[s.value?(d(),w(t(at),{key:0,options:{immediate:!0,allowOutsideClick:!0}},{default:l(()=>[a(t(Re),{"search-term":r.value,"onUpdate:searchTerm":C[0]||(C[0]=_=>r.value=_),open:s.value,"model-value":N.value,class:"relative","onUpdate:modelValue":E},{default:l(()=>[a(t(Ee),null,{default:l(()=>[a(t(Ge),{ref_key:"searchInput",ref:p,class:"bg-card-background border-0 placeholder-muted text-sm text-text-primary py-2.5 focus:ring-0 border-b border-card-background-separator focus:border-card-background-separator w-full",placeholder:"Search for a project...",onKeydown:se(y,["enter"])},null,512)]),_:1}),a(t(Fe),null,{default:l(()=>[a(t(qe),{ref:"dropdownViewport",class:"w-60 max-h-60 overflow-y-scroll"},{default:l(()=>[(d(!0),h(A,null,Y(f.value,_=>(d(),w(t(Ke),{key:_.id,value:_,class:"data-[highlighted]:bg-card-background-active","data-project-id":_.id},{default:l(()=>[a(st,{selected:P(_),color:_.color,name:_.name},null,8,["selected","color","name"])]),_:2},1032,["value","data-project-id"]))),128)),r.value.length>0&&f.value.length===0?(d(),h("div",gt,[e("div",kt,[a(t(ot),{class:"w-5 flex-shrink-0"}),e("span",null,'Add "'+V(r.value)+'" as a new Project',1)])])):M("",!0)]),_:1},512)]),_:1})]),_:1},8,["search-term","open","model-value"])]),_:1})):M("",!0)]),_:1},8,["modelValue"]))}}),jt={class:"flex items-center space-x-4"},$t={class:"col-span-6 sm:col-span-4 flex-1"},Mt={class:"col-span-6 sm:col-span-4"},Se=U({__name:"TaskCreateModal",props:B({projectId:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(x){const{createTask:v}=F(),r=D(x,"show"),p=g(!1),m=g(""),s=g(null),n=x,u=g(n.projectId);Q(()=>n.projectId,f=>{u.value=f});async function c(){await v({name:m.value,project_id:u.value,estimated_time:s.value}),r.value=!1,m.value=""}const i=g(null);return oe(i,{initialValue:!0}),(f,o)=>(d(),w(ae,{closeable:"",show:r.value,onClose:o[6]||(o[6]=y=>r.value=!1)},{title:l(()=>o[7]||(o[7]=[e("div",{class:"flex space-x-2"},[e("span",null," Create Task ")],-1)])),content:l(()=>[e("div",jt,[e("div",$t,[a(Me,{id:"taskName",ref_key:"taskNameInput",ref:i,modelValue:m.value,"onUpdate:modelValue":o[0]||(o[0]=y=>m.value=y),type:"text",placeholder:"Task Name",class:"block w-full",required:"",autocomplete:"taskName",onKeydown:o[1]||(o[1]=se(y=>c(),["enter"]))},null,8,["modelValue"])]),e("div",Mt,[a(yt,{modelValue:u.value,"onUpdate:modelValue":o[2]||(o[2]=y=>u.value=y)},null,8,["modelValue"])])]),t(ue)()?(d(),w(he,{key:0,modelValue:s.value,"onUpdate:modelValue":o[3]||(o[3]=y=>s.value=y),onSubmit:o[4]||(o[4]=y=>c())},null,8,["modelValue"])):M("",!0)]),footer:l(()=>[a(S,{onClick:o[5]||(o[5]=y=>r.value=!1)},{default:l(()=>o[8]||(o[8]=[$(" Cancel ")])),_:1,__:[8]}),a(H,{class:Z(["ms-3",{"opacity-25":p.value}]),disabled:p.value,onClick:c},{default:l(()=>o[9]||(o[9]=[$(" Create Task ")])),_:1,__:[9]},8,["class","disabled"])]),_:1},8,["show"]))}}),ht=["aria-label"],Pt={key:0},Ct={key:1},Tt=U({__name:"TaskMoreOptionsDropdown",props:{task:{}},emits:["delete","edit","done"],setup(x,{emit:v}){const r=v,p=x;return(m,s)=>(d(),w(t(Ce),null,{default:l(()=>[a(t(Te),{"as-child":""},{default:l(()=>[e("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Task "+p.task.name},s[3]||(s[3]=[e("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,ht)]),_:1}),a(t(Ue),{class:"min-w-[150px]",align:"end"},{default:l(()=>[t(xe)()?(d(),w(t(O),{key:0,"aria-label":"Edit Task "+p.task.name,"data-testid":"task_edit",class:"flex items-center space-x-3 cursor-pointer",onClick:s[0]||(s[0]=n=>r("edit"))},{default:l(()=>[a(t(de),{class:"w-5 text-icon-active"}),s[4]||(s[4]=e("span",null,"Edit",-1))]),_:1,__:[4]},8,["aria-label"])):M("",!0),t(xe)()?(d(),w(t(O),{key:1,"aria-label":"Mark Task "+p.task.name+" as done",class:"flex items-center space-x-3 cursor-pointer",onClick:s[1]||(s[1]=n=>r("done"))},{default:l(()=>[a(t(me),{class:"w-5 text-icon-active"}),p.task.is_done?(d(),h("span",Pt,"Mark as active")):(d(),h("span",Ct,"Mark as done"))]),_:1},8,["aria-label"])):M("",!0),t(Pe)()?(d(),w(t(O),{key:2,"aria-label":"Delete Task "+p.task.name,"data-testid":"task_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:s[2]||(s[2]=n=>r("delete"))},{default:l(()=>[a(t(Ve),{class:"w-5"}),s[5]||(s[5]=e("span",null,"Delete",-1))]),_:1,__:[5]},8,["aria-label"])):M("",!0)]),_:1})]),_:1}))}}),Vt={class:"flex items-center space-x-4"},Ut={class:"col-span-6 sm:col-span-4 flex-1"},Nt=U({__name:"TaskEditModal",props:B({task:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(x){const{updateTask:v}=F(),r=D(x,"show"),p=g(!1),m=x,s=g({name:m.task.name,estimated_time:m.task.estimated_time});async function n(){await v(m.task.id,s.value),r.value=!1}const u=g(null);return oe(u,{initialValue:!0}),(c,i)=>(d(),w(ae,{closeable:"",show:r.value,onClose:i[5]||(i[5]=f=>r.value=!1)},{title:l(()=>i[6]||(i[6]=[e("div",{class:"flex space-x-2"},[e("span",null," Update Task ")],-1)])),content:l(()=>[e("div",Vt,[e("div",Ut,[a(Me,{id:"taskName",ref_key:"taskNameInput",ref:u,modelValue:s.value.name,"onUpdate:modelValue":i[0]||(i[0]=f=>s.value.name=f),type:"text",placeholder:"Task Name",class:"mt-1 block w-full",required:"",autocomplete:"taskName",onKeydown:i[1]||(i[1]=se(f=>n(),["enter"]))},null,8,["modelValue"])])]),t(ue)()?(d(),w(he,{key:0,modelValue:s.value.estimated_time,"onUpdate:modelValue":i[2]||(i[2]=f=>s.value.estimated_time=f),onSubmit:i[3]||(i[3]=f=>n())},null,8,["modelValue"])):M("",!0)]),footer:l(()=>[a(S,{onClick:i[4]||(i[4]=f=>r.value=!1)},{default:l(()=>i[7]||(i[7]=[$(" Cancel ")])),_:1,__:[7]}),a(H,{class:Z(["ms-3",{"opacity-25":p.value}]),disabled:p.value,onClick:n},{default:l(()=>i[8]||(i[8]=[$(" Update Task ")])),_:1,__:[8]},8,["class","disabled"])]),_:1},8,["show"]))}}),It={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},zt={class:"overflow-ellipsis overflow-hidden"},St={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},Bt={key:0},At={key:1},Dt={class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},Rt={key:2},Et={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},Gt={key:1},Ft={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},qt=U({__name:"TaskTableRow",props:{task:{}},setup(x){const v=x,r=J("organization");function p(){F().deleteTask(v.task.id)}function m(){F().updateTask(v.task.id,{...v.task,is_done:!v.task.is_done})}const s=g(!1);return(n,u)=>(d(),w(pe,null,{default:l(()=>{var c,i;return[e("div",It,[e("span",zt,V(n.task.name),1)]),e("div",St,[n.task.spent_time?(d(),h("span",Bt,V(t(ut)(n.task.spent_time,(c=t(r))==null?void 0:c.interval_format,(i=t(r))==null?void 0:i.number_format)),1)):(d(),h("span",At," -- "))]),e("div",Dt,[t(ue)()?n.task.estimated_time?(d(),w(nt,{key:1,estimated:n.task.estimated_time,current:n.task.spent_time},null,8,["estimated","current"])):(d(),h("span",Rt," -- ")):(d(),w(rt,{key:0}))]),e("div",Et,[n.task.is_done?(d(),h(A,{key:0},[a(t(me),{class:"w-5"}),u[2]||(u[2]=e("span",null,"Done",-1))],64)):(d(),h("span",Gt,"Active"))]),e("div",Ft,[t(Pe)()?(d(),w(Tt,{key:0,task:n.task,onDone:m,onEdit:u[0]||(u[0]=f=>s.value=!0),onDelete:p},null,8,["task"])):M("",!0)]),a(Nt,{show:s.value,"onUpdate:show":u[1]||(u[1]=f=>s.value=f),task:n.task},null,8,["show","task"])]}),_:1}))}}),Kt=U({__name:"TaskTableHeading",setup(x){return(v,r)=>(d(),w(Ne,null,{default:l(()=>r[0]||(r[0]=[e("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Task Name ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Total Time ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Progress ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Status",-1),e("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[e("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),Ot={class:"flow-root"},Zt={class:"inline-block min-w-full align-middle"},Ht={"data-testid":"task_table",role:"table",class:"grid min-w-full",style:{"grid-template-columns":`1fr minmax(80px, auto) minmax(120px, auto) minmax(
                            50px,
                            auto
                        )
                        80px`}},Lt={key:0,class:"col-span-5 py-24 text-center"},Qt={key:0,class:"pb-5"},Jt=U({__name:"TaskTable",props:{projectId:{},tasks:{}},setup(x){const v=x,r=g(!1);Q(()=>v.tasks,m=>{console.log("Updated tasks:",m)});const p=z(()=>{const m=new Intl.Collator(void 0,{numeric:!0,sensitivity:"base"});return[...v.tasks].sort((s,n)=>m.compare(s.name,n.name))});return(m,s)=>(d(),h(A,null,[a(Se,{show:r.value,"onUpdate:show":s[0]||(s[0]=n=>r.value=n),"project-id":v.projectId},null,8,["show","project-id"]),e("div",Ot,[e("div",Zt,[e("div",Ht,[a(Kt),m.tasks.length===0?(d(),h("div",Lt,[a(t(dt),{class:"w-8 text-icon-default inline pb-2"}),s[3]||(s[3]=e("h3",{class:"text-text-primary font-semibold"},"No tasks found",-1)),t(re)()?(d(),h("p",Qt," Create your first task now! ")):M("",!0),t(re)()?(d(),w(S,{key:1,icon:t(te),onClick:s[1]||(s[1]=n=>r.value=!0)},{default:l(()=>s[2]||(s[2]=[$("Create your First Task ")])),_:1,__:[2]},8,["icon"])):M("",!0)])):M("",!0),(d(!0),h(A,null,Y(p.value,n=>(d(),w(qt,{key:n.id,task:n},null,8,["task"]))),128))])])])],64))}}),L=Qe("project-members",()=>{const x=g(null),{handleApiRequestNotifications:v}=et();async function r(u){const c=W();c&&(x.value=await v(()=>K.getProjectMembers({params:{organization:c,project:u}}),void 0,"Failed to fetch project members"))}async function p(u,c){const i=W();i&&(await v(()=>K.createProjectMember(c,{params:{organization:i,project:u}}),"Project member added successfully","Failed to add project member"),await r(u))}async function m(u,c){const i=W();if(i){const f=await v(()=>K.updateProjectMember(c,{params:{organization:i,projectMember:u}}),"Project member updated successfully","Failed to update project member");await r(f.data.project_id)}}async function s(u,c){const i=W();i&&(await v(()=>K.deleteProjectMember(void 0,{params:{organization:i,projectMember:c}}),"Project member removed successfully","Failed to remove project member"),await r(u))}return{projectMembers:z(()=>{var u;return((u=x.value)==null?void 0:u.data)||[]}),fetchProjectMembers:r,createProjectMember:p,deleteProjectMember:s,updateProjectMember:m}}),Wt=["aria-label"],Be=U({__name:"ProjectMemberMoreOptionsDropdown",props:{projectMember:{}},emits:["delete","editProjectMember"],setup(x,{emit:v}){const r=v,p=x,{members:m}=G($e()),s=z(()=>m.value.find(n=>n.id===p.projectMember.user_id));return(n,u)=>(d(),w(t(Ce),null,{default:l(()=>[a(t(Te),{"as-child":""},{default:l(()=>{var c;return[e("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Project Member "+((c=s.value)==null?void 0:c.name)},u[2]||(u[2]=[e("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,Wt)]}),_:1}),a(t(Ue),{class:"min-w-[150px]",align:"end"},{default:l(()=>{var c,i;return[a(t(O),{"aria-label":"Edit Project Member "+((c=s.value)==null?void 0:c.name),class:"flex items-center space-x-3 cursor-pointer",onClick:u[0]||(u[0]=_e(f=>r("editProjectMember"),["prevent"]))},{default:l(()=>[a(t(de),{class:"w-5 text-icon-active"}),u[3]||(u[3]=e("span",null,"Edit",-1))]),_:1,__:[3]},8,["aria-label"]),a(t(O),{"aria-label":"Delete Project Member "+((i=s.value)==null?void 0:i.name),"data-testid":"project_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:u[1]||(u[1]=_e(f=>r("delete"),["prevent"]))},{default:l(()=>[a(t(Ve),{class:"w-5"}),u[4]||(u[4]=e("span",null,"Remove from Team",-1))]),_:1,__:[4]},8,["aria-label"])]}),_:1})]),_:1}))}}),Xt={class:"py-1 text-center"},Yt=U({__name:"ProjectMemberBillableRateModal",props:B({newBillableRate:{},memberName:{}},{show:{default:!1},showModifiers:{},saving:{default:!1},savingModifiers:{}}),emits:B(["submit"],["update:show","update:saving"]),setup(x){const v=D(x,"show"),r=D(x,"saving"),p=J("organization");return(m,s)=>(d(),w(ct,{show:v.value,"onUpdate:show":s[0]||(s[0]=n=>v.value=n),saving:r.value,"onUpdate:saving":s[1]||(s[1]=n=>r.value=n),title:"Update Project Member Billable Rate",onSubmit:s[2]||(s[2]=n=>m.$emit("submit"))},{default:l(()=>{var n,u,c;return[e("p",Xt,[$(" The billable rate of "+V(m.memberName)+" will be updated to ",1),e("strong",null,V(m.newBillableRate?t(le)(m.newBillableRate,t(R)(),(n=t(p))==null?void 0:n.currency_format,(u=t(p))==null?void 0:u.currency_symbol,(c=t(p))==null?void 0:c.number_format):" the default rate of the project"),1),s[3]||(s[3]=$(". "))]),s[4]||(s[4]=e("p",{class:"py-1 text-center font-semibold max-w-md mx-auto"}," Do you want to update all existing time entries, where the project member billable rate applies as well? ",-1))]}),_:1,__:[4]},8,["show","saving"]))}}),es={class:"grid grid-cols-3 items-center space-x-4"},ts={class:"col-span-3 sm:col-span-2 space-x-2 flex items-center"},ss={class:"col-span-3 sm:col-span-1 flex-1"},Ae=U({__name:"ProjectMemberEditModal",props:B({projectMember:{},name:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(x){const{updateProjectMember:v}=L(),r=D(x,"show"),p=g(!1),m=x,s=g({billable_rate:m.projectMember.billable_rate}),n=g(!1);async function u(){if(m.projectMember.billable_rate!==s.value.billable_rate){setTimeout(()=>{n.value=!0},0);return}await v(m.projectMember.id,s.value),r.value=!1,s.value={billable_rate:null}}async function c(){await v(m.projectMember.id,s.value),r.value=!1,n.value=!1}Q(()=>r.value,f=>{f&&(s.value={billable_rate:m.projectMember.billable_rate})});const i=g(null);return oe(i,{initialValue:!0}),(f,o)=>(d(),w(ae,{closeable:"",show:r.value,onClose:o[4]||(o[4]=y=>r.value=!1)},{title:l(()=>o[5]||(o[5]=[e("div",{class:"flex space-x-2"},[e("span",null,"Edit Project Member")],-1)])),content:l(()=>[a(Yt,{show:n.value,"onUpdate:show":o[0]||(o[0]=y=>n.value=y),"member-name":m.name,"new-billable-rate":s.value.billable_rate,onClose:o[1]||(o[1]=y=>n.value=!1),onSubmit:c},null,8,["show","member-name","new-billable-rate"]),e("div",es,[e("div",ts,[a(t(Ie),{class:"w-4 text-text-secondary"}),e("span",null,V(m.name),1)]),e("div",ss,[a(ft,{for:"billable_rate",class:"mb-2",value:"Billable Rate"}),a(ne,{modelValue:s.value.billable_rate,"onUpdate:modelValue":o[2]||(o[2]=y=>s.value.billable_rate=y),currency:t(R)(),name:"billable_rate",onKeydown:se(u,["enter"])},null,8,["modelValue","currency"])])])]),footer:l(()=>[a(S,{onClick:o[3]||(o[3]=y=>r.value=!1)},{default:l(()=>o[6]||(o[6]=[$("Cancel")])),_:1,__:[6]}),a(H,{class:Z(["ms-3",{"opacity-25":p.value}]),disabled:p.value,onClick:u},{default:l(()=>o[7]||(o[7]=[$(" Update Project Member ")])),_:1,__:[7]},8,["class","disabled"])]),_:1},8,["show"]))}}),as={class:"whitespace-nowrap flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},os={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},ls={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},rs={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},ns=U({__name:"ProjectMemberTableRow",props:{projectMember:{}},setup(x){const v=x,r=J("organization");function p(){L().deleteProjectMember(v.projectMember.project_id,v.projectMember.id)}function m(){u.value=!0}const{members:s}=G($e()),n=z(()=>s.value.find(c=>c.id===v.projectMember.member_id)),u=g(!1);return(c,i)=>(d(),w(pe,null,{default:l(()=>{var f,o,y,N,P,b;return[a(Ae,{show:u.value,"onUpdate:show":i[0]||(i[0]=T=>u.value=T),name:(f=n.value)==null?void 0:f.name,"project-member":c.projectMember},null,8,["show","name","project-member"]),e("div",as,[e("span",null,V((o=n.value)==null?void 0:o.name),1)]),e("div",os,V(c.projectMember.billable_rate?t(le)(c.projectMember.billable_rate,t(R)(),(y=t(r))==null?void 0:y.currency_format,(N=t(r))==null?void 0:N.currency_symbol,(P=t(r))==null?void 0:P.number_format):"--"),1),e("div",ls,V(t(ze)(((b=n.value)==null?void 0:b.role)??"")),1),e("div",rs,[a(Be,{"project-member":c.projectMember,onDelete:p,onEdit:m},null,8,["project-member"])])]}),_:1}))}}),is=U({__name:"ProjectMemberTableHeading",setup(x){return(v,r)=>(d(),w(Ne,null,{default:l(()=>r[0]||(r[0]=[e("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Name ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Billable Rate ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Role",-1),e("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[e("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),us={class:"grid grid-cols-3 items-center space-x-4"},ds={class:"col-span-3 sm:col-span-2"},ms={class:"col-span-3 sm:col-span-1 flex-1"},ps={class:"grid grid-cols-3 items-center space-x-4"},cs={class:"col-span-3 sm:col-span-2"},fs={class:"flex-1 truncate"},vs={class:"col-span-3 sm:col-span-1 flex-1"},De=U({__name:"ProjectMemberCreateModal",props:B({projectId:{},existingMembers:{}},{show:{default:!1},showModifiers:{}}),emits:B(["refresh"],["update:show"]),setup(x,{emit:v}){const{createProjectMember:r}=L(),p=D(x,"show"),m=g(!1),s=x,n=v,u=g({member_id:"",billable_rate:null}),c=g([]),i=g(""),f=g(null);async function o(){const{data:_}=await ee.get(`/organizations/teams/projects/${s.projectId}`);c.value=_.team.length>0?_.team:[{id:null,name:"No Group Available",billable_rate:null}]}Q(()=>p.value,_=>{_&&o()}),ie(o);async function y(){await r(s.projectId,u.value),p.value=!1,u.value={member_id:"",billable_rate:null}}async function N(){console.log(i.value);const _=`/teams/${i.value}/projects/${s.projectId}`;console.log(_),p.value=!1;const{data:k}=await ee.post(_);C(),console.log(k),o(),n("refresh")}const P=z(()=>c.value.map(_=>({label:_.name,value:_.id}))),b=z(()=>{var _;return((_=c.value.find(k=>k.id===i.value))==null?void 0:_.name)||"Select Group..."}),T=g(null);oe(T,{initialValue:!0});function E(_){return _.value}function j(_){return _.label}function C(){i.value="",f.value=null}return(_,k)=>(d(),w(ae,{closeable:"",show:p.value,onClose:k[5]||(k[5]=I=>p.value=!1)},{title:l(()=>k[6]||(k[6]=[e("div",{class:"flex space-x-2"},[e("span",null,"Add Project Member")],-1)])),content:l(()=>[e("div",us,[e("div",ds,[a(mt,{modelValue:u.value.member_id,"onUpdate:modelValue":k[0]||(k[0]=I=>u.value.member_id=I),"hidden-members":s.existingMembers,placeholder:"Select Members..."},null,8,["modelValue","hidden-members"])]),e("div",ms,[a(ne,{modelValue:u.value.billable_rate,"onUpdate:modelValue":k[1]||(k[1]=I=>u.value.billable_rate=I),name:"billable_rate",currency:t(R)()},null,8,["modelValue","currency"])])]),k[7]||(k[7]=e("div",{class:"flex items-center gap-4 my-4"},[e("div",{class:"flex-grow border-t border-gray-600"}),e("span",{class:"text-gray-500 text-sm"},"or"),e("div",{class:"flex-grow border-t border-gray-600"})],-1)),e("div",ps,[e("div",cs,[a(vt,{modelValue:i.value,"onUpdate:modelValue":k[2]||(k[2]=I=>i.value=I),items:P.value,getKeyFromItem:E,getNameForItem:j},{trigger:l(()=>[a(t(X),{tag:"button",class:"flex w-full text-base text-left space-x-3 px-3 text-text-secondary bg-input-background font-normal cursor py-1.5"},{default:l(()=>[a(t(Ie),{class:"relative z-10 w-4 text-text-secondary"}),e("div",fs,V(b.value),1),a(t(pt),{class:"w-4 text-text-secondary"})]),_:1})]),_:1},8,["modelValue","items"])]),e("div",vs,[a(ne,{modelValue:f.value,"onUpdate:modelValue":k[3]||(k[3]=I=>f.value=I),name:"group_billable_rate",currency:t(R)()},null,8,["modelValue","currency"])])])]),footer:l(()=>[a(S,{onClick:k[4]||(k[4]=I=>p.value=!1)},{default:l(()=>k[8]||(k[8]=[$("Cancel")])),_:1,__:[8]}),b.value!="Select Group..."?(d(),w(S,{key:0,onClick:C,class:"ml-3"},{default:l(()=>k[9]||(k[9]=[$(" Clear ")])),_:1,__:[9]})):M("",!0),b.value=="Select Group..."?(d(),w(H,{key:1,class:Z(["ms-3",{"opacity-25":m.value}]),disabled:m.value,onClick:y},{default:l(()=>k[10]||(k[10]=[$(" Add Project Member ")])),_:1,__:[10]},8,["class","disabled"])):M("",!0),b.value!="Select Group..."&&b.value!="No Group Available"?(d(),w(H,{key:2,class:Z(["ms-3",{"opacity-25":m.value}]),disabled:m.value,onClick:N},{default:l(()=>k[11]||(k[11]=[$(" Add Project Group ")])),_:1,__:[11]},8,["class","disabled"])):M("",!0)]),_:1},8,["show"]))}}),bs={class:"flow-root"},_s={class:"inline-block min-w-full align-middle"},xs={"data-testid":"project_member_table",class:"grid min-w-full",style:{"grid-template-columns":"1fr 150px 150px 80px"}},ws={key:0,class:"col-span-5 py-24 text-center"},gs={class:"whitespace-nowrap flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},ks={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},ys={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},js={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},$s=U({__name:"ProjectMemberTable",props:{projectId:{},projectMembers:{}},setup(x){const v=J("organization"),r=g(!1),p=g([]);async function m(){const{data:i}=await ee.get(`/organizations/projects/teams/${x.projectId}`);p.value=i.team??[]}ie(()=>{m()});async function s(i){console.log(i);const f=`/teams/${i}/projects/${x.projectId}`;console.log(f);const{data:o}=await ee.delete(f);console.log(o),n()}const n=()=>{console.log("ReInit called"),m()};function u(){c.value=!0}const c=g(!1);return(i,f)=>(d(),h(A,null,[a(De,{show:r.value,"onUpdate:show":f[0]||(f[0]=o=>r.value=o),"existing-members":i.projectMembers,onRefresh:n,"project-id":i.projectId},null,8,["show","existing-members","project-id"]),e("div",bs,[e("div",_s,[e("div",xs,[a(is),i.projectMembers.length===0&&p.value.length===0?(d(),h("div",ws,[a(t(wt),{class:"w-8 text-icon-default inline pb-2"}),f[4]||(f[4]=e("h3",{class:"text-text-primary font-semibold"},"No project members",-1)),f[5]||(f[5]=e("p",{class:"pb-5"},"Add the first project member!",-1)),a(S,{icon:t(te),onClick:f[1]||(f[1]=o=>r.value=!0)},{default:l(()=>f[3]||(f[3]=[$("Add a new Project Member ")])),_:1,__:[3]},8,["icon"])])):M("",!0),(d(!0),h(A,null,Y(i.projectMembers,o=>(d(),w(ns,{key:o.id,"project-member":o},null,8,["project-member"]))),128)),(d(!0),h(A,null,Y(p.value,o=>(d(),w(pe,{key:o.id},{default:l(()=>{var y,N,P;return[a(Ae,{show:c.value,"onUpdate:show":f[2]||(f[2]=b=>c.value=b),name:o==null?void 0:o.name,"project-member":o},null,8,["show","name","project-member"]),e("div",gs,[e("span",null,V(o==null?void 0:o.name),1)]),e("div",ks,V(o.billable_rate?t(le)(o.billable_rate,t(R)(),(y=t(v))==null?void 0:y.currency_format,(N=t(v))==null?void 0:N.currency_symbol,(P=t(v))==null?void 0:P.number_format):"--"),1),e("div",ys,V(t(ze)("Group")),1),e("div",js,[a(Be,{"project-member":o,onDelete:b=>s(o.id),onEditProjectMember:u},null,8,["project-member","onDelete"])])]}),_:2},1024))),128))])])])],64))}}),Ms={class:"flex","aria-label":"Breadcrumb"},hs={role:"list",class:"flex items-center space-x-2"},Ps={class:"flex items-center space-x-6"},Cs={class:"flex items-center space-x-3 text-text-primary font-semibold text-base"},Ts={class:"flex space-x-3 items-center"},Vs={class:"px-4"},Us={class:"grid lg:grid-cols-2 gap-x-6 pt-6"},Ns={class:"w-full items-center flex justify-between"},Is={class:"pl-6"},zs={key:0},Ha=U({__name:"ProjectShow",setup(x){var y,N;const{projects:v}=G(je()),r=J("organization"),p=z(()=>v.value.find(P=>P.id===route().params.project)??null),m=g(!1),s=g(!1),n=(N=(y=route())==null?void 0:y.params)==null?void 0:N.project,{projectMembers:u}=G(L());ie(()=>{we()&&L().fetchProjectMembers(n),F().fetchTasks()});const c=g(!1),i=g("active"),{tasks:f}=G(F()),o=z(()=>f.value.filter(P=>i.value==="active"?P.project_id===n&&!P.is_done:P.project_id===n&&P.is_done));return(P,b)=>(d(),w(Ze,{title:"Projects","data-testid":"projects_view"},{default:l(()=>[a(be,{class:"py-5 border-b border-default-background-separator flex justify-between items-center"},{default:l(()=>{var T,E,j,C,_,k,I;return[e("nav",Ms,[e("ol",hs,[e("li",null,[e("div",Ps,[a(t(Je),{href:P.route("projects"),class:"flex items-center space-x-2.5"},{default:l(()=>[a(t(_t),{class:"w-6 text-icon-default"}),b[7]||(b[7]=e("span",{class:"font-medium"},"Projects",-1))]),_:1,__:[7]},8,["href"])])]),e("li",null,[e("div",Cs,[a(t(Oe),{class:"h-5 w-5 flex-shrink-0 text-text-secondary","aria-hidden":"true"}),e("div",Ts,[e("div",{style:We({backgroundColor:(T=p.value)==null?void 0:T.color,boxShadow:`var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) ${(E=p.value)==null?void 0:E.color}30`}),class:"w-3 h-3 rounded-full"},null,4),e("span",null,V((j=p.value)==null?void 0:j.name),1)])])])]),e("div",Vs,[(C=p.value)!=null&&C.billable_rate?(d(),w(t(X),{key:0},{default:l(()=>{var q,ce,fe,ve;return[$(V(t(le)(((q=p.value)==null?void 0:q.billable_rate)??0,t(R)(),(ce=t(r))==null?void 0:ce.currency_format,(fe=t(r))==null?void 0:fe.currency_symbol,(ve=t(r))==null?void 0:ve.number_format))+" / h ",1)]}),_:1})):M("",!0),(_=p.value)!=null&&_.is_billable&&!((k=p.value)!=null&&k.billable_rate)?(d(),w(t(X),{key:1},{default:l(()=>b[8]||(b[8]=[$(" Default Rate ")])),_:1,__:[8]})):M("",!0),(I=p.value)!=null&&I.is_billable?M("",!0):(d(),w(t(X),{key:2},{default:l(()=>b[9]||(b[9]=[$(" Non-Billable ")])),_:1,__:[9]}))])]),e("div",null,[t(lt)()?(d(),w(S,{key:0,icon:t(de),onClick:b[0]||(b[0]=q=>c.value=!0)},{default:l(()=>b[10]||(b[10]=[$(" Edit Project ")])),_:1,__:[10]},8,["icon"])):M("",!0),p.value?(d(),w(it,{key:1,show:c.value,"onUpdate:show":b[1]||(b[1]=q=>c.value=q),"original-project":p.value},null,8,["show","original-project"])):M("",!0)])]}),_:1}),a(be,null,{default:l(()=>[e("div",Us,[e("div",null,[a(ge,{title:"Tasks",icon:t(me)},{actions:l(()=>[e("div",Ns,[e("div",Is,[a(bt,{modelValue:i.value,"onUpdate:modelValue":b[2]||(b[2]=T=>i.value=T)},{default:l(()=>[a(ye,{value:"active"},{default:l(()=>b[11]||(b[11]=[$("Active ")])),_:1,__:[11]}),a(ye,{value:"done"},{default:l(()=>b[12]||(b[12]=[$("Done ")])),_:1,__:[12]})]),_:1},8,["modelValue"])]),t(re)()?(d(),w(S,{key:0,icon:t(te),onClick:b[3]||(b[3]=T=>m.value=!0)},{default:l(()=>b[13]||(b[13]=[$(" Create Task ")])),_:1,__:[13]},8,["icon"])):M("",!0),a(Se,{show:m.value,"onUpdate:show":b[4]||(b[4]=T=>m.value=T),"project-id":t(n)},null,8,["show","project-id"])])]),_:1},8,["icon"]),a(ke,null,{default:l(()=>[a(Jt,{tasks:o.value,"project-id":t(n)},null,8,["tasks","project-id"])]),_:1})]),t(we)()?(d(),h("div",zs,[a(ge,{title:"Project Members",icon:t(xt)},{actions:l(()=>[a(S,{icon:t(te),onClick:b[5]||(b[5]=T=>s.value=!0)},{default:l(()=>b[14]||(b[14]=[$(" Add Member ")])),_:1,__:[14]},8,["icon"]),a(De,{show:s.value,"onUpdate:show":b[6]||(b[6]=T=>s.value=T),"project-id":t(n),"existing-members":t(u)},null,8,["show","project-id","existing-members"])]),_:1},8,["icon"]),a(ke,null,{default:l(()=>[a($s,{"project-members":t(u),"project-id":t(n)},null,8,["project-members","project-id"])]),_:1})])):M("",!0)])]),_:1})]),_:1}))}});export{Ha as default};
//# sourceMappingURL=ProjectShow-DsGm-cAa.js.map
