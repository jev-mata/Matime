import{M as Y}from"./MainContainer-DtfFNECZ.js";import{_ as G}from"./AppLayout.vue_vue_type_script_setup_true_lang-B5it3Y5_.js";import{_ as H}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-BtFFhAH2.js";import{_ as q}from"./ProjectCreateModal.vue_vue_type_script_setup_true_lang-DoyrMytA.js";import{T as J,_ as L}from"./TableHeading-vuCruovc.js";import{d as C,b as x,o as l,w as d,f as t,h as u,j as w,e as n,u as r,g as M,t as y,A as g,c as $,B as K,r as A,F as B,L as z,D as Q,l as R,i as W,q as X}from"./app-DUID27fb.js";import{r as U,s as Z,q as T}from"./permissions-BsGx_A78.js";import{a as ee,c as te,b as S,r as re,_ as se}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D3HYVzWM.js";import{r as oe}from"./PencilSquareIcon-Cn40sn4D.js";import{r as ae}from"./ArchiveBoxIcon-CsdrITqo.js";import{u as P,b as ie,a as k,e as le}from"./useMembers-fKrmzvmk.js";import{b as ne,_ as pe,a as ce}from"./ProjectEditModal.vue_vue_type_script_setup_true_lang-BHJ0kWEK.js";import{f as me}from"./money-CQyR8ykW.js";import{g as D}from"./money-C8rBYmfS.js";import{a as de}from"./time-D8fzVCgi.js";import{i as N}from"./billing-BjyYMmvp.js";import{r as ue}from"./CheckCircleIcon-CR_8rZI8.js";import{r as fe}from"./FolderPlusIcon-B5KZEUC8.js";import{r as I}from"./PlusIcon-BdS72468.js";import{_ as xe}from"./PageTitle.vue_vue_type_script_setup_true_lang-BxZn5Rae.js";import{_ as ve,a as O}from"./TabBar.vue_vue_type_script_setup_true_lang-FxptvPJp.js";import{u as F}from"./useOrganization-BJAvoR2D.js";import{r as we}from"./FolderIcon-DbiJK5M-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-BeV0Y9mJ.js";import"./index-D03bkDOQ.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-D60G0-_2.js";import"./init-BsFOScD8.js";import"./notification-cXlbw5Vr.js";import"./utc-CJhWvcZK.js";import"./DialogModal.vue_vue_type_script_setup_true_lang-XAFzrvZ5.js";import"./Modal.vue_vue_type_script_setup_true_lang-CNtdiaUN.js";import"./PrimaryButton.vue_vue_type_script_setup_true_lang-B1YYrMbH.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-Bs-sRE9c.js";import"./theme-idUPXIqc.js";import"./useQuery-BllrDSBf.js";import"./ClockIcon-DymtNJg4.js";import"./TextInput.vue_vue_type_script_setup_true_lang-DItGfPyY.js";import"./BillableIcon-BvHKiDs7.js";import"./ProjectEditBillableSection.vue_vue_type_script_setup_true_lang-BxZFHWr7.js";import"./component-CGwmUpCj.js";import"./InputLabel.vue_vue_type_script_setup_true_lang-BZNuSpdv.js";import"./BillableRateInput.vue_vue_type_script_setup_true_lang-DaSVXXWo.js";import"./usePrimitiveElement-b6ljwxpe.js";import"./useLocale-BjfOTVRz.js";import"./clamp-AKXC_gH0.js";import"./createLucideIcon-l232JYPa.js";import"./SelectDropdown.vue_vue_type_script_setup_true_lang-BzQ1fREU.js";import"./Collection-DeTUl_xM.js";import"./useTypeahead-CLCWGywH.js";import"./RovingFocusGroup-BeTyvml_.js";import"./UpgradeModal.vue_vue_type_script_setup_true_lang-BVwe-qjt.js";import"./BillableRateModal.vue_vue_type_script_setup_true_lang-D_WmsSjf.js";import"./ArrowTopRightOnSquareIcon-DdjFU7BP.js";const _e={key:0,class:"px-3 py-1.5 text-left font-semibold text-text-primary"},ye=C({__name:"ProjectTableHeading",props:{showBillableRate:{type:Boolean}},setup(j){return(f,o)=>(l(),x(J,null,{default:d(()=>[o[0]||(o[0]=t("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Name ",-1)),o[1]||(o[1]=t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Client",-1)),o[2]||(o[2]=t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Total Time ",-1)),o[3]||(o[3]=t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Progress ",-1)),f.showBillableRate?(l(),u("div",_e," Billable Rate ")):w("",!0),o[4]||(o[4]=t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Status",-1)),o[5]||(o[5]=t("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[t("span",{class:"sr-only"},"Edit")],-1))]),_:1,__:[0,1,2,3,4,5]}))}}),be=["aria-label"],je=C({__name:"ProjectMoreOptionsDropdown",props:{project:{}},emits:["delete","edit","archive"],setup(j,{emit:f}){const o=f,c=j;return(_,p)=>(l(),x(r(se),null,{default:d(()=>[n(r(ee),{"as-child":""},{default:d(()=>[t("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Project "+c.project.name},p[3]||(p[3]=[t("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,be)]),_:1}),n(r(te),{class:"min-w-[150px]",align:"end"},{default:d(()=>[r(U)()?(l(),x(r(S),{key:0,"aria-label":"Edit Project "+c.project.name,"data-testid":"project_edit",class:"flex items-center space-x-3 cursor-pointer",onClick:p[0]||(p[0]=M(b=>o("edit"),["prevent"]))},{default:d(()=>[n(r(oe),{class:"w-5 text-icon-active"}),p[4]||(p[4]=t("span",null,"Edit",-1))]),_:1,__:[4]},8,["aria-label"])):w("",!0),r(U)()?(l(),x(r(S),{key:1,"aria-label":"Archive Project "+c.project.name,class:"flex items-center space-x-3 cursor-pointer",onClick:p[1]||(p[1]=M(b=>o("archive"),["prevent"]))},{default:d(()=>[n(r(ae),{class:"w-5 text-icon-active"}),t("span",null,y(_.project.is_archived?"Unarchive":"Archive"),1)]),_:1},8,["aria-label"])):w("",!0),r(Z)()?(l(),x(r(S),{key:2,"aria-label":"Delete Project "+c.project.name,"data-testid":"project_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:p[2]||(p[2]=M(b=>o("delete"),["prevent"]))},{default:d(()=>[n(r(re),{class:"w-5"}),p[5]||(p[5]=t("span",null,"Delete",-1))]),_:1,__:[5]},8,["aria-label"])):w("",!0)]),_:1})]),_:1}))}}),he={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},ge={class:"overflow-ellipsis overflow-hidden"},$e={class:"text-text-secondary"},ke={class:"whitespace-nowrap min-w-0 px-3 py-4 text-sm text-text-secondary"},Pe={key:0,class:"overflow-ellipsis overflow-hidden"},Ce={key:1},Be={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},Re={key:0},Te={key:1},Ae={class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},Me={key:2},Se={key:0,class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},De={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},Ne={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},Ve=C({__name:"ProjectTableRow",props:{project:{},showBillableRate:{type:Boolean}},setup(j){const{clients:f}=g(P()),{tasks:o}=g(ie()),c=j,_=$(()=>f.value.find(e=>e.id===c.project.client_id)),p=$(()=>o.value.filter(e=>e.project_id===c.project.id).length);function b(){k().deleteProject(c.project.id)}function h(){k().updateProject(c.project.id,{...c.project,is_archived:!c.project.is_archived})}const a=K("organization"),i=$(()=>{var e,m,v;return c.project.is_billable?c.project.billable_rate?me(c.project.billable_rate,D(),(e=a==null?void 0:a.value)==null?void 0:e.currency_format,(m=a==null?void 0:a.value)==null?void 0:m.currency_symbol,(v=a==null?void 0:a.value)==null?void 0:v.number_format):"Default Rate":"--"}),s=A(!1);return(e,m)=>(l(),u(B,null,[n(ne,{show:s.value,"onUpdate:show":m[0]||(m[0]=v=>s.value=v),"original-project":e.project},null,8,["show","original-project"]),n(L,{href:e.route("projects.show",{project:e.project.id})},{default:d(()=>{var v,V,E;return[t("div",he,[t("div",{style:z({backgroundColor:e.project.color,boxShadow:`var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) ${e.project.color}30`}),class:"w-3 h-3 rounded-full"},null,4),t("span",ge,y(e.project.name),1),t("span",$e,y(p.value)+" Tasks ",1)]),t("div",ke,[e.project.client_id?(l(),u("div",Pe,y((v=_.value)==null?void 0:v.name),1)):(l(),u("div",Ce,"No client"))]),t("div",Be,[e.project.spent_time?(l(),u("div",Re,y(r(de)(e.project.spent_time,(V=r(a))==null?void 0:V.interval_format,(E=r(a))==null?void 0:E.number_format)),1)):(l(),u("div",Te,"--"))]),t("div",Ae,[r(N)()?e.project.estimated_time?(l(),x(ce,{key:1,estimated:e.project.estimated_time,current:e.project.spent_time},null,8,["estimated","current"])):(l(),u("span",Me," -- ")):(l(),x(pe,{key:0}))]),e.showBillableRate?(l(),u("div",Se,y(i.value),1)):w("",!0),t("div",De,[n(r(ue),{class:"w-5"}),m[2]||(m[2]=t("span",null,"Active",-1))]),t("div",Ne,[n(je,{project:e.project,onEdit:m[1]||(m[1]=Ye=>s.value=!0),onArchive:h,onDelete:b},null,8,["project"])])]}),_:1},8,["href"])],64))}}),Ee={class:"flow-root max-w-[100vw] overflow-x-auto"},Ue={class:"inline-block min-w-full align-middle"},Oe={key:0,class:"col-span-5 py-24 text-center"},Fe={class:"text-text-primary font-semibold"},He={class:"pb-5 max-w-md mx-auto text-sm pt-1"},qe={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},Le={key:0,class:"overflow-ellipsis overflow-hidden"},ze=C({__name:"ProjectTable",props:{projects:{},showBillableRate:{type:Boolean}},setup(j){const f=j,o=A(!1);async function c(a){return await k().createProject(a)}async function _(a){return await P().createClient(a)}const{clients:p}=g(P()),b=$(()=>`grid-template-columns: minmax(300px, 1fr) minmax(150px, auto) minmax(140px, auto) minmax(130px, auto) ${f.showBillableRate?"minmax(130px, auto)":""} minmax(120px, auto) 80px;`);Q(()=>f.projects,a=>{console.log("Projects changed:",a)},{deep:!0,immediate:!1});const h=a=>p.value.find(i=>i.id===a);return(a,i)=>(l(),u(B,null,[n(q,{show:o.value,"onUpdate:show":i[0]||(i[0]=s=>o.value=s),"create-project":c,"create-client":_,currency:r(D)(),clients:r(p),"enable-estimated-time":r(N)},null,8,["show","currency","clients","enable-estimated-time"]),t("div",Ee,[t("div",Ue,[t("div",{"data-testid":"project_table",class:"grid min-w-full",style:z(b.value)},[n(ye,{"show-billable-rate":f.showBillableRate},null,8,["show-billable-rate"]),a.projects.length===0?(l(),u("div",Oe,[n(r(fe),{class:"w-8 text-icon-default inline pb-2"}),t("h3",Fe,y(r(T)()?"No projects found":"You are not a member of any projects"),1),t("p",He,y(r(T)()?"Create your first project now!":"Ask your manager to add you to a project as a team member."),1),r(T)()?(l(),x(H,{key:0,icon:r(I),onClick:i[1]||(i[1]=s=>o.value=!0)},{default:d(()=>i[2]||(i[2]=[R(" Create your First Project ")])),_:1,__:[2]},8,["icon"])):w("",!0)])):w("",!0),(l(!0),u(B,null,W(a.projects,(s,e)=>{var m;return l(),u(B,{key:s.id},[(s==null?void 0:s.client_id)!==((m=a.projects[e-1])==null?void 0:m.client_id)?(l(),x(L,{key:0,class:"w-full mt-5"},{default:d(()=>{var v;return[t("div",qe,[s.client_id?(l(),u("div",Le,y((v=h(s==null?void 0:s.client_id))==null?void 0:v.name),1)):w("",!0)]),i[3]||(i[3]=t("div",{class:"whitespace-nowrap min-w-0 px-3 py-4 text-sm text-text-secondary"},null,-1)),i[4]||(i[4]=t("div",{class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},null,-1)),i[5]||(i[5]=t("div",{class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},null,-1)),i[6]||(i[6]=t("div",{class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},null,-1)),i[7]||(i[7]=t("div",{class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},null,-1)),i[8]||(i[8]=t("div",{class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},null,-1))]}),_:2,__:[3,4,5,6,7,8]},1024)):w("",!0),n(Ve,{"show-billable-rate":f.showBillableRate,project:s},null,8,["show-billable-rate","project"])],64)}),128))],4)])])],64))}}),Ie={class:"flex items-center space-x-3 sm:space-x-6"},Jt=C({__name:"Projects",setup(j){X(()=>{k().fetchProjects(),F().fetchOrganization()});const{clients:f}=g(P()),o=A(!1),{organization:c}=g(F()),_=A("active"),{projects:p}=g(k()),b=$(()=>p.value.filter(s=>_.value==="active"?!s.is_archived:s.is_archived));async function h(s){return await k().createProject(s)}async function a(s){return await P().createClient(s)}const i=$(()=>{var s;return!!(le()!=="employee"||(s=c.value)!=null&&s.employees_can_see_billable_rates)});return(s,e)=>(l(),x(G,{title:"Projects","data-testid":"projects_view"},{default:d(()=>[n(Y,{class:"py-3 sm:py-5 border-b border-default-background-separator flex justify-between items-center"},{default:d(()=>[t("div",Ie,[n(xe,{icon:r(we),title:"Projects"},null,8,["icon"]),n(ve,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=m=>_.value=m)},{default:d(()=>[n(O,{value:"active"},{default:d(()=>e[3]||(e[3]=[R("Active")])),_:1,__:[3]}),n(O,{value:"archived"},{default:d(()=>e[4]||(e[4]=[R("Archived")])),_:1,__:[4]})]),_:1},8,["modelValue"])]),r(T)()?(l(),x(H,{key:0,icon:r(I),onClick:e[1]||(e[1]=m=>o.value=!0)},{default:d(()=>e[5]||(e[5]=[R("Create Project ")])),_:1,__:[5]},8,["icon"])):w("",!0),n(q,{show:o.value,"onUpdate:show":e[2]||(e[2]=m=>o.value=m),"create-project":h,"enable-estimated-time":r(N),"create-client":a,currency:r(D)(),clients:r(f),onSubmit:h},null,8,["show","enable-estimated-time","currency","clients"])]),_:1}),n(ze,{"show-billable-rate":i.value,projects:b.value},null,8,["show-billable-rate","projects"])]),_:1}))}});export{Jt as default};
//# sourceMappingURL=Projects-C3kcpRWT.js.map
