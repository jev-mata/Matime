import{h as n,o as i,f as t,d as N,r as d,q as z,c as I,e as a,w as u,l as p,t as m,u as b,G as A,j as R,F as T,i as j,H as L}from"./app-Dzd5B06R.js";import{_ as Z}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-CWUYAS8h.js";import{b as D,a as S}from"./notification-Cqm5OIAz.js";import{_ as U}from"./InputLabel.vue_vue_type_script_setup_true_lang-BJprejo3.js";import{g as V}from"./useMembers-D1lZTqLC.js";import{_ as q}from"./DialogModal.vue_vue_type_script_setup_true_lang-Cdp4pUKI.js";import{_ as E}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-DBBC7wMi.js";import{i as G}from"./init-Ddj1H8ev.js";import"./time-D8Z5bJ3P.js";import"./money-DE8Cj37t.js";import"./utc-BCs3FwGo.js";import{_ as J}from"./CardTitle.vue_vue_type_script_setup_true_lang-CyznVp_q.js";import"./permissions-Cy8U4TFG.js";import{C as B}from"./Card-C6IHIwAo.js";import{r as K}from"./InformationCircleIcon-BNRus3TC.js";function O(_,y){return i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","stroke-width":"1.5",stroke:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round",d:"M9 8.25H7.5a2.25 2.25 0 0 0-2.25 2.25v9a2.25 2.25 0 0 0 2.25 2.25h9a2.25 2.25 0 0 0 2.25-2.25v-9a2.25 2.25 0 0 0-2.25-2.25H15M9 12l3 3m0 0 3-3m-3 3V2.25"})])}function Q(_,y){return i(),n("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[t("path",{d:"M5.625 1.5c-1.036 0-1.875.84-1.875 1.875v17.25c0 1.035.84 1.875 1.875 1.875h12.75c1.035 0 1.875-.84 1.875-1.875V12.75A3.75 3.75 0 0 0 16.5 9h-1.875a1.875 1.875 0 0 1-1.875-1.875V5.25A3.75 3.75 0 0 0 9 1.5H5.625Z"}),t("path",{d:"M12.971 1.816A5.23 5.23 0 0 1 14.25 5.25v1.875c0 .207.168.375.375.375H16.5a5.23 5.23 0 0 1 3.434 1.279 9.768 9.768 0 0 0-6.963-6.963Z"})])}const W={class:"py-2.5 px-3 border-t border-t-card-background-separator"},X={class:"py-2.5 px-3 border-t border-t-card-background-separator"},Y={class:"py-2.5 px-3 border-t border-t-card-background-separator"},ee={class:"py-2.5 px-3 border-t border-t-card-background-separator"},te={class:"py-2 px-3 sm:px-4 text-sm flex items-center space-x-3"},re={class:"px-4 py-5 sm:px-5"},oe=["value"],se={key:0,class:"py-3 text-text-primary"},ae=["innerHTML"],ne={class:"mt-2 flex justify-center rounded-lg border border-dashed border-border-primary px-6 py-10"},ie={class:"text-center"},le={class:"mt-4 flex text-sm leading-6 text-text-secondary"},de={for:"file-upload",class:"relative cursor-pointer rounded-md font-semibold text-text-primary focus-within:outline-none focus-within:ring-2 focus-within:ring-indigo-600 focus-within:ring-offset-2 focus-within:ring-offset-gray-900 hover:text-indigo-500"},ue={key:0},pe={key:1},ce={class:"flex items-center justify-end px-4 py-3 bg-card-background border-t border-card-background-separator text-end sm:px-6 shadow sm:rounded-bl-md sm:rounded-br-md"},Se=N({__name:"ImportData",setup(_){const y=d([]),{addNotification:h}=D(),w=d(!1);z(async()=>{const s=V();s&&(y.value=(await S.getImporters({params:{organization:s}})).data)});const c=d(),f=d(null);async function M(){var o;if(l.value===null){h("error","Please select the import type");return}if(((o=f.value)==null?void 0:o.length)!==1){h("error","Please select the CSV or ZIP file that you want to import");return}const e=(await $(f.value[0])).split(";")[1].replace("base64,",""),r=V();if(r!==null){const{handleApiRequestNotifications:v}=D();w.value=!0;try{c.value=await v(()=>l.value?S.importData({type:l.value.key,data:e},{params:{organization:r}}):new Promise((x,F)=>{F("Import type is null")})),G(),c.value&&(g.value=!0)}finally{w.value=!1}}}const k=d();function $(s){return new Promise((e,r)=>{const o=new FileReader;o.readAsDataURL(s),o.onload=()=>{if(o.result instanceof ArrayBuffer){const x=new TextDecoder().decode(o.result);return r(x)}else o.result&&e(o.result)},o.onerror=r})}function H(){var s;f.value=((s=k.value)==null?void 0:s.files)??null}const C=I(()=>l.value===null?"":l.value.description),P=I(()=>{var s,e;return((e=(s=f.value)==null?void 0:s.item(0))==null?void 0:e.name)??"Import File selected"}),l=d(null),g=d(!1);return(s,e)=>(i(),n(T,null,[a(q,{closeable:"",show:g.value,onClose:e[1]||(e[1]=r=>g.value=!1)},{title:u(()=>e[3]||(e[3]=[p("Import Result")])),content:u(()=>{var r,o,v,x;return[e[8]||(e[8]=t("div",{class:"pb-6"}," The import was successful! Here is an overview of the imported data: ",-1)),t("div",W,[e[4]||(e[4]=t("span",{class:"text-text-primary font-semibold"},"Clients created:",-1)),p(" "+m((r=c.value)==null?void 0:r.report.clients.created),1)]),t("div",X,[e[5]||(e[5]=t("span",{class:"text-text-primary font-semibold"},"Projects created:",-1)),p(" "+m((o=c.value)==null?void 0:o.report.projects.created),1)]),t("div",Y,[e[6]||(e[6]=t("span",{class:"text-text-primary font-semibold"},"Tasks created:",-1)),p(" "+m((v=c.value)==null?void 0:v.report.tasks.created),1)]),t("div",ee,[e[7]||(e[7]=t("span",{class:"text-text-primary font-semibold"},"Time entries created:",-1)),p(" "+m((x=c.value)==null?void 0:x.report.time_entries.created),1)])]}),footer:u(()=>[a(E,{onClick:e[0]||(e[0]=r=>g.value=!1)},{default:u(()=>e[9]||(e[9]=[p(" Close ")])),_:1,__:[9]})]),_:1},8,["show"]),t("div",null,[a(b(J),{title:"Import Data",icon:b(O)},null,8,["icon"]),a(B,{class:"mb-3"},{default:u(()=>[t("div",te,[a(b(K),{class:"h-5 min-w-0 w-5 text-bg-tertiary"}),e[10]||(e[10]=t("p",{class:"flex-1"}," Import existing data from Toggl, Clockify or a different solidtime instance. Please select the type of data you want to import and follow the instructions. ",-1))])]),_:1}),a(B,null,{default:u(()=>[t("div",re,[t("div",null,[a(U,{for:"importType",value:"Import Type"}),A(t("select",{id:"importType","onUpdate:modelValue":e[2]||(e[2]=r=>l.value=r),name:"importType",class:"mt-1 block w-full border-input-border bg-input-background text-text-primary focus:border-input-border-active rounded-md shadow-sm"},[e[11]||(e[11]=t("option",{value:null,selected:"",disabled:""}," Select an import type to get instructions... ",-1)),(i(!0),n(T,null,j(y.value,r=>(i(),n("option",{key:r.key,value:r},m(r.name),9,oe))),128))],512),[[L,l.value]]),C.value?(i(),n("div",se,[e[12]||(e[12]=t("div",{class:"font-semibold text-text-secondary py-1"}," Instructions: ",-1)),t("div",{class:"max-w-2xl",innerHTML:C.value},null,8,ae)])):R("",!0)]),t("div",ne,[t("div",ie,[a(b(Q),{class:"mx-auto h-8 w-8 text-text-secondary","aria-hidden":"true"}),t("div",le,[t("label",de,[f.value?(i(),n("span",ue,m(P.value),1)):(i(),n("span",pe,"Upload a Toggl/Clockify Export")),t("input",{id:"file-upload",ref_key:"importFile",ref:k,name:"file-upload",type:"file",class:"sr-only",onChange:H},null,544)])]),e[13]||(e[13]=t("p",{class:"text-xs leading-5 text-text-secondary"}," CSV and ZIP are supported ",-1))])])]),t("div",ce,[a(Z,{loading:w.value,onClick:M},{default:u(()=>e[14]||(e[14]=[p("Import Data ")])),_:1,__:[14]},8,["loading"])])]),_:1})])],64))}});export{Se as _};
//# sourceMappingURL=ImportData.vue_vue_type_script_setup_true_lang-B5BQ2s7z.js.map
