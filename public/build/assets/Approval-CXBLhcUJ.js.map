{"version":3,"file":"Approval-CXBLhcUJ.js","sources":["../../../resources/js/Pages/Timesheet/Approval.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport AppLayout from \"@/Layouts/AppLayout.vue\";\nimport TimeTracker from \"@/Components/TimeTracker.vue\";\nimport MainContainer from \"@/packages/ui/src/MainContainer.vue\";\n\nimport { ClockIcon } from \"@heroicons/vue/24/outline\";\nimport { usePage } from \"@inertiajs/vue3\";\n\nimport type { Tag } from '@/packages/api/src';\nimport { useQueryClient } from \"@tanstack/vue-query\";\nimport { computed } from \"vue\";\nimport axios from \"axios\";\nimport { ref } from \"vue\";\nimport dayjs from \"dayjs\";\nimport ProjectBadge from \"@/packages/ui/src/Project/ProjectBadge.vue\";\nimport Modal from \"@/packages/ui/src/Modal.vue\";\n\nconst queryClient = useQueryClient();\nconst refreshDashboardData = () => {\n  // Invalidate all dashboard queries to trigger refetching\n  queryClient.invalidateQueries({ queryKey: [\"latestTasks\"] });\n  queryClient.invalidateQueries({ queryKey: [\"lastSevenDays\"] });\n  queryClient.invalidateQueries({ queryKey: [\"dailyTrackedHours\"] });\n  queryClient.invalidateQueries({ queryKey: [\"latestTeamActivity\"] });\n  queryClient.invalidateQueries({ queryKey: [\"weeklyProjectOverview\"] });\n  queryClient.invalidateQueries({ queryKey: [\"totalWeeklyTime\"] });\n  queryClient.invalidateQueries({ queryKey: [\"totalWeeklyBillableTime\"] });\n  queryClient.invalidateQueries({ queryKey: [\"totalWeeklyBillableAmount\"] });\n  queryClient.invalidateQueries({ queryKey: [\"weeklyHistory\"] });\n  queryClient.invalidateQueries({ queryKey: [\"timeEntries\"] });\n};\nconst props = defineProps<{\n  entries: any[];\n  totalHours: string;\n  totalHoursNotForm: any;\n  isSubmit: boolean;\n  from: string;\n  to: string;\n  timesheet: any[];\n  groups: any[];\n}>();\n// const page = usePage<{\n//   entries: any[];\n//   totalHours: string;\n//   totalHoursNotForm: any;\n//   isSubmit: boolean;\n//   from: string;\n//   to: string;\n//   timesheet: any[];\n//   groups: any[];\n// }>();\n\nfunction goBack() {\n  window.history.back();\n}\nconst form = ref({\n  date_start: '',\n  date_end: '',\n  hours: props.totalHoursNotForm,\n})\n\nfunction formatDate2(dateStr: string) {\n  const date = new Date(dateStr)\n  return date.toLocaleDateString('en-US', {\n    month: 'long',\n    day: 'numeric',\n    year: 'numeric'\n  })\n}\nconst submit = async () => {\n  if (!props.isSubmit) {\n\n    await axios.post('/api/time/submit', form.value)\n    // load()\n    console.log('is unSubmit');\n  } else {\n    await axios.post('/api/time/unsubmit', form.value)\n\n    console.log('isSubmit');\n  }\n  goBack();\n\n}\nfunction formatDate(date: number) {\n  return new Date(date).toLocaleDateString('en-US', {\n    weekday: 'long',\n    year: 'numeric',\n    month: 'long',\n    day: '2-digit'\n  })\n}\nconst formattedFrom = computed(() => formatDate2(props.from))\nconst formattedTo = computed(() => formatDate2(props.to))\n\nfunction formatTime(dateString: string) {\n  return dateString ? dayjs(dateString).format('hh:mm:ss A') : '';\n}\nfunction duration(entry: { start: string; end: string }) {\n  const start = new Date(entry.start).getTime();\n  const end = new Date(entry.end).getTime();\n\n  if (isNaN(start) || isNaN(end)) return '0h 0m';\n\n  const diffInMinutes = Math.floor((end - start) / (1000 * 60));\n  const hours = Math.floor(diffInMinutes / 60);\n  const minutes = diffInMinutes % 60;\n\n  return `${hours}h ${minutes}m`;\n}\n\n</script>\n\n<template>\n  <Modal :show=\"true\" max-width=\"5xl\">\n    <template #default>\n      <div class=\"col-span-full my-1 p-5\">\n        <h2 class=\"text-lg font-semibold mb-1\">My Entries</h2>\n        <div class=\"text-md mb-2\">{{ formattedFrom }} - {{ formattedTo }}</div>\n        <div class=\"max-h-20 overflow-y-scroll \" style=\"max-height: 50vh;\">\n          <div v-for=\"(entries, date2) in props.entries\" :key=\"date2\" class=\"mt-4 mb-4 border dark:border-[#303F61]\">\n            <h2 class=\"font-semibold text-md py-2 px-3 bg-quaternary text-secondary\">{{ formatDate(date2) }}</h2>\n\n            <ul class=\"\">\n              <li v-for=\"entry in entries\" :key=\"entry.id\" class=\"flex flex-row px-3 rounded border py-2\">\n\n                <div class=\"basis-64 flex content-center\">\n                  {{ formatTime(entry.start) }} - {{ formatTime(entry.end) }}\n                </div>\n                <div class=\"basis-64 flex content-center\">\n                  {{ duration(entry) }} - {{ entry.description || 'No description' }}\n                </div>\n                <div class=\"basis-64\">\n\n                  <ProjectBadge v-if=\"entry.project\" :color=\"entry.project.color\" :size=\"'large'\" :border=\"true\" :class=\"'focus:border-border-tertiary w-full  dark:border-[#303F61] focus:outline-0 focus:bg-card-background-separator min-w-0 relative '\n                    \">\n\n                    <div class=\"flex items-center lg:space-x-1 min-w-0\">\n                      <span class=\"whitespace-nowrap text-xs lg:text-sm\">\n                        {{ entry.project.name }}\n                      </span>\n                      <ChevronRightIcon v-if=\"entry.task\" class=\"w-4 lg:w-5 text-text-secondary shrink-0\">\n                      </ChevronRightIcon>\n                      <div v-if=\"entry.task\" class=\"min-w-0 shrink text-xs lg:text-sm truncate\">\n                        {{ entry.task.name }}\n                      </div>\n                    </div>\n                  </ProjectBadge>\n                </div>\n                <div class=\"basis-64 overflow-hidden\">\n                  <div v-if=\"entry.tags.length > 0\" class=\" w-full\">\n                    <TagBadge class=\"truncate text-ellipsis overflow-hidden whitespace-nowrap\" :border=\"false\"\n                      size=\"large\" :name=\"entry.tags.map((tag: Tag) => tag.name).join(', ')\" />\n                  </div>\n                </div>\n\n\n              </li>\n            </ul>\n          </div>\n\n        </div>\n\n        <div\n          class=\" text-muted-foreground text-sm bold text-text-primary font-semibold text-sm lg:text-base flex items-center space-x-2 lg:space-x-2.5\">\n          <component :is=\"ClockIcon\" v-if=\"ClockIcon\" class=\"w-5 lg:w-4 text-icon-default mr-2\"></component>\n          <div>{{ props.totalHours }}</div>\n        </div>\n      </div>\n    </template>\n\n    <template #footer>\n      <form @submit.prevent=\"submit\" class=\"space-y-4 w-full px-5 pb-5\">\n        <div class=\"flex w-full items-center space-x-2 lg:space-x-2.5\">\n\n          <Button @click.prevent=\"goBack\" class=\"px-4 py-2 bg-blue-600 text-white rounded\">\n            Close\n          </Button>\n          <Button type=\"submit\" :class=\"' px-4 py-2 bg-green-600 text-white rounded'\">Reject</Button>\n          <Button type=\"submit\" :class=\"'px-4 py-2 bg-red-600 text-white rounded'\">Approve</Button>\n        </div>\n      </form>\n    </template>\n  </Modal>\n</template>"],"names":["useQueryClient","props","__props","goBack","form","ref","formatDate2","dateStr","submit","axios","formatDate","date","formattedFrom","computed","formattedTo","formatTime","dateString","dayjs","duration","entry","start","end","diffInMinutes","hours","minutes","_createBlock","Modal","_createElementVNode","_hoisted_1","_cache","_hoisted_2","_toDisplayString","_hoisted_3","_openBlock","_createElementBlock","_Fragment","entries","date2","_hoisted_4","_hoisted_5","_renderList","_hoisted_6","_hoisted_7","_hoisted_8","ProjectBadge","_normalizeClass","_hoisted_9","_hoisted_10","_component_ChevronRightIcon","_hoisted_11","_hoisted_12","_hoisted_13","_createVNode","_component_TagBadge","tag","_hoisted_14","_unref","ClockIcon","_resolveDynamicComponent","_hoisted_15","_component_Button"],"mappings":"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"}