{"version":3,"file":"useCurrentTimeEntry-CruyZJNI.js","sources":["../../../resources/js/utils/useTimeEntries.ts","../../../resources/js/utils/useCurrentTimeEntry.ts"],"sourcesContent":["import { defineStore } from 'pinia';\nimport {\n    getCurrentMembershipId,\n    getCurrentOrganizationId,\n} from '@/utils/useUser';\n\nimport { reactive, ref } from 'vue';\nimport {\n    api,\n    type CreateTimeEntryBody,\n    type TimeEntriesQueryParams,\n    type TimeEntry,\n} from '@/packages/api/src';\nimport dayjs from 'dayjs';\nimport { useNotificationsStore } from '@/utils/notification';\nimport type { UpdateMultipleTimeEntriesChangeset } from '@/packages/api/src';\nimport { useQueryClient } from '@tanstack/vue-query';\nimport { useCurrentTimeEntryStore } from './useCurrentTimeEntry';\n\nexport const useTimeEntriesStore = defineStore('timeEntries', () => {\n    const timeEntries = ref<TimeEntry[]>(reactive([]));\n\n    const allTimeEntriesLoaded = ref(false);\n    const { handleApiRequestNotifications } = useNotificationsStore();\n\n    const queryClient = useQueryClient();\n\n    async function patchTimeEntries(\n        queryParams: TimeEntriesQueryParams = {\n            only_full_dates: 'true',\n            member_id: getCurrentMembershipId(),\n        }\n    ) {\n        const organizationId = getCurrentOrganizationId();\n\n        if (organizationId) {\n            const timeEntriesResponse = await handleApiRequestNotifications(\n                () =>\n                    api.getTimeEntries({\n                        params: {\n                            organization: organizationId,\n                        },\n                        queries: queryParams,\n                    }),\n                undefined,\n                'Failed to fetch time entries'\n            );\n            if (timeEntriesResponse?.data) {\n                // insert missing time entries\n                const missingTimeEntries = timeEntriesResponse.data.filter(\n                    (entry) => !timeEntries.value.find((e) => e.id === entry.id)\n                );\n                timeEntries.value = [\n                    ...missingTimeEntries,\n                    ...timeEntries.value,\n                ];\n            }\n        }\n    }\n\n    async function fetchTimeEntries(\n        queryParams: TimeEntriesQueryParams = {\n            only_full_dates: 'true',\n            member_id: getCurrentMembershipId(),\n        }\n    ) {\n        const organizationId = getCurrentOrganizationId();\n\n        if (organizationId) {\n            const timeEntriesResponse = await handleApiRequestNotifications(\n                () =>\n                    api.getTimeEntries({\n                        params: {\n                            organization: organizationId,\n                        },\n                        queries: queryParams,\n                    }),\n                undefined,\n                'Failed to fetch time entries'\n            );\n            if (timeEntriesResponse?.data) {\n                timeEntries.value = timeEntriesResponse.data;\n            }\n        }\n    }\n\n    async function fetchMoreTimeEntries() {\n        const organizationId = getCurrentOrganizationId();\n        if (organizationId) {\n            const latestTimeEntry =\n                timeEntries.value[timeEntries.value.length - 1];\n            dayjs(latestTimeEntry.start).utc().format('YYYY-MM-DD');\n\n            const timeEntriesResponse = await handleApiRequestNotifications(\n                () =>\n                    api.getTimeEntries({\n                        params: {\n                            organization: organizationId,\n                        },\n                        queries: {\n                            only_full_dates: 'true',\n                            member_id: getCurrentMembershipId(),\n                            end: dayjs(latestTimeEntry.start).utc().format(),\n                        },\n                    }),\n                undefined,\n                'Failed to fetch time entries'\n            );\n            if (\n                timeEntriesResponse?.data &&\n                timeEntriesResponse.data.length > 0\n            ) {\n                timeEntries.value = timeEntries.value.concat(\n                    timeEntriesResponse.data\n                );\n            } else {\n                allTimeEntriesLoaded.value = true;\n            }\n        }\n    }\n\n    async function updateTimeEntries(\n        ids: string[],\n        changes: UpdateMultipleTimeEntriesChangeset\n    ) {\n        const organizationId = getCurrentOrganizationId();\n        if (organizationId) {\n            await handleApiRequestNotifications(\n                () =>\n                    api.updateMultipleTimeEntries(\n                        {\n                            ids: ids,\n                            changes: changes,\n                        },\n                        {\n                            params: {\n                                organization: organizationId,\n                            },\n                        }\n                    ),\n                'Time entries updated successfully',\n                'Failed to update time entries'\n            );\n        }\n    }\n\n    async function updateTimeEntry(timeEntry: TimeEntry) {\n        const organizationId = getCurrentOrganizationId();\n        if (organizationId) {\n            const response = await handleApiRequestNotifications(\n                () =>\n                    api.updateTimeEntry(timeEntry, {\n                        params: {\n                            organization: organizationId,\n                            timeEntry: timeEntry.id,\n                        },\n                    }),\n                'Time entry updated successfully',\n                'Failed to update time entry'\n            );\n            timeEntries.value = timeEntries.value.map((entry) =>\n                entry.id === timeEntry.id ? response.data : entry\n            );\n            queryClient.invalidateQueries({ queryKey: ['timeEntry'] });\n        }\n\n        await fetchTimeEntries();\n    }\n\n    async function createTimeEntry(\n        timeEntry: Omit<CreateTimeEntryBody, 'member_id'>\n    ) {\n        const organizationId = getCurrentOrganizationId();\n        const memberId = getCurrentMembershipId();\n        if (organizationId && memberId !== undefined) {\n            const newTimeEntry = {\n                ...timeEntry,\n                member_id: memberId,\n            } as CreateTimeEntryBody;\n            await handleApiRequestNotifications(\n                () =>\n                    api.createTimeEntry(newTimeEntry, {\n                        params: {\n                            organization: organizationId,\n                        },\n                    }),\n                'Time entry created successfully',\n                'Failed to create time entry'\n            );\n            await fetchTimeEntries();\n        }\n    }\n\n    async function deleteTimeEntry(timeEntryId: string) {\n        const organizationId = getCurrentOrganizationId();\n        if (organizationId) {\n            await handleApiRequestNotifications(\n                () =>\n                    api.deleteTimeEntry(undefined, {\n                        params: {\n                            organization: organizationId,\n                            timeEntry: timeEntryId,\n                        },\n                    }),\n                'Time entry deleted successfully',\n                'Failed to delete time entry'\n            );\n            await fetchTimeEntries();\n        }\n    }\n\n    async function discardTimer(\n        isActive: boolean,\n        currentTimeEntry: TimeEntry[]\n    ) {\n        if (isActive) { \n            const organizationId = getCurrentOrganizationId();\n            const timeEntryIds = currentTimeEntry.map((entry) => entry.id);\n            if (organizationId) {\n                await handleApiRequestNotifications(\n                    () =>\n                        api.deleteTimeEntries(undefined, {\n                            queries: {\n                                ids: timeEntryIds,\n                            },\n                            params: {\n                                organization: organizationId,\n                            },\n                        }),\n                    'Time entries discarded successfully',\n                    'Failed to discarded time entries'\n                );\n                useCurrentTimeEntryStore().$reset();\n                useCurrentTimeEntryStore().fetchCurrentTimeEntry();\n                await fetchTimeEntries();\n            }\n        } else {\n            useNotificationsStore().addNotification(\n                'error',\n                'Entries not found'\n            );\n        }\n        fetchTimeEntries();\n    }\n    async function deleteTimeEntries(\n        timeEntries: TimeEntry[],\n        resMSG?: string\n    ) {\n        const organizationId = getCurrentOrganizationId();\n        const timeEntryIds = timeEntries.map((entry) => entry.id);\n        if (organizationId) {\n            await handleApiRequestNotifications(\n                () =>\n                    api.deleteTimeEntries(undefined, {\n                        queries: {\n                            ids: timeEntryIds,\n                        },\n                        params: {\n                            organization: organizationId,\n                        },\n                    }),\n                resMSG ? resMSG : 'Time entries deleted successfully',\n                'Failed to delete time entries'\n            );\n            await fetchTimeEntries();\n        }\n    }\n\n    return {\n        discardTimer,\n        timeEntries,\n        fetchTimeEntries,\n        updateTimeEntry,\n        createTimeEntry,\n        deleteTimeEntry,\n        fetchMoreTimeEntries,\n        allTimeEntriesLoaded,\n        updateTimeEntries,\n        deleteTimeEntries,\n        patchTimeEntries,\n    };\n});\n","import { defineStore } from 'pinia';\nimport { computed, reactive, ref } from 'vue';\nimport { api } from '@/packages/api/src';\nimport type { TimeEntry } from '@/packages/api/src';\nimport dayjs, { Dayjs } from 'dayjs';\nimport utc from 'dayjs/plugin/utc';\nimport {\n    getCurrentMembershipId,\n    getCurrentOrganizationId,\n    getCurrentUserId,\n} from '@/utils/useUser';\nimport { useLocalStorage } from '@vueuse/core';\nimport { useTimeEntriesStore } from '@/utils/useTimeEntries';\nimport { useNotificationsStore } from '@/utils/notification';\n\ndayjs.extend(utc);\n\nconst emptyTimeEntry = {\n    id: '',\n    description: '',\n    user_id: '',\n    start: '',\n    end: null,\n    duration: null,\n    task_id: null,\n    project_id: null,\n    tags: [],\n    billable: false,\n    organization_id: '',\n    approval: '',\n    approved_by: '',\n} as TimeEntry;\n\nexport const useCurrentTimeEntryStore = defineStore('currentTimeEntry', () => {\n    const currentTimeEntry = ref<TimeEntry>(reactive(emptyTimeEntry));\n    const { handleApiRequestNotifications } = useNotificationsStore();\n\n    useLocalStorage('solidtime/current-time-entry', currentTimeEntry, {\n        deep: true,\n    });\n\n    function $reset() {\n        currentTimeEntry.value = { ...emptyTimeEntry };\n    }\n\n    const now = ref<null | Dayjs>(null);\n    const interval = ref<ReturnType<typeof setInterval> | null>(null);\n\n    const diffTime = (timeStart: string, now: Dayjs): string => {\n        const start = dayjs(timeStart).utc();\n        const seconds = now.diff(start, 'second'); // elapsed seconds\n\n        const mins = Math.floor(seconds / 60)\n            .toString()\n            .padStart(2, '0');\n        const secs = (seconds % 60).toString().padStart(2, '0');\n        return `${mins}:${secs}`;\n    };\n    function startLiveTimer() {\n        stopLiveTimer();\n        now.value = dayjs().utc();\n        interval.value = setInterval(() => {\n            now.value = dayjs().utc();\n\n            document.title = `â± ${diffTime(currentTimeEntry.value.start, now.value)} - Panso`;\n        }, 1000);\n    }\n\n    function stopLiveTimer() {\n        if (interval.value !== null) {\n            clearInterval(interval.value);\n            document.title = `Dashboard - Panso`;\n        }\n    }\n\n    async function fetchCurrentTimeEntry() {\n        const organizationId = getCurrentOrganizationId();\n        if (organizationId) {\n            try {\n                const timeEntriesResponse = await api.getMyActiveTimeEntry({});\n                if (timeEntriesResponse?.data) {\n                    if (timeEntriesResponse.data) {\n                        currentTimeEntry.value = timeEntriesResponse.data;\n                        if (\n                            currentTimeEntry.value.start !== '' &&\n                            currentTimeEntry.value.end === null\n                        ) {\n                            startLiveTimer();\n                        }\n                    } else {\n                        currentTimeEntry.value = { ...emptyTimeEntry };\n                    }\n                }\n            } catch {\n                currentTimeEntry.value = { ...emptyTimeEntry };\n            }\n        } else {\n            throw new Error(\n                'Failed to fetch current time entry because organization ID is missing.'\n            );\n        }\n    }\n\n    async function startTimer() {\n        const organization = getCurrentOrganizationId();\n        const membership = getCurrentMembershipId();\n        if (organization && membership) {\n            const startTime =\n                currentTimeEntry.value.start !== ''\n                    ? currentTimeEntry.value.start\n                    : dayjs().utc().format();\n            const response = await handleApiRequestNotifications(\n                () =>\n                    api.createTimeEntry(\n                        {\n                            member_id: membership,\n                            start: startTime,\n                            description: currentTimeEntry.value?.description,\n                            project_id: currentTimeEntry.value?.project_id,\n                            task_id: currentTimeEntry.value?.task_id,\n                            billable: currentTimeEntry.value.billable,\n                            tags: currentTimeEntry.value?.tags,\n                        },\n                        { params: { organization: organization } }\n                    ),\n                'Timer started!'\n            );\n            if (response?.data) {\n                currentTimeEntry.value = response.data;\n            }\n        } else {\n            throw new Error(\n                'Failed to fetch current time entry because organization ID is missing.'\n            );\n        }\n    }\n\n    async function stopTimer(msg?: string) {\n        const user = getCurrentUserId();\n        const organization = getCurrentOrganizationId();\n        if (organization) {\n            const currentDateTime = dayjs().utc().format();\n            await handleApiRequestNotifications(\n                () =>\n                    api.updateTimeEntry(\n                        {\n                            user_id: user,\n                            start: currentTimeEntry.value.start,\n                            end: currentDateTime,\n                        },\n                        {\n                            params: {\n                                organization: organization,\n                                timeEntry: currentTimeEntry.value.id,\n                            },\n                        }\n                    ),\n                msg ? msg : 'Timer stopped!'\n            );\n            $reset();\n        } else {\n            throw new Error(\n                'Failed to stop current timer because organization ID is missing.'\n            );\n        }\n    }\n\n    async function updateTimer() {\n        const user = getCurrentUserId();\n        const organization = getCurrentOrganizationId();\n        if (organization) {\n            const response = await handleApiRequestNotifications(\n                () =>\n                    api.updateTimeEntry(\n                        {\n                            description: currentTimeEntry.value.description,\n                            user_id: user,\n                            project_id: currentTimeEntry.value.project_id,\n                            task_id: currentTimeEntry.value.task_id,\n                            start: currentTimeEntry.value.start,\n                            billable: currentTimeEntry.value.billable,\n                            end: null,\n                            tags: currentTimeEntry.value.tags,\n                        },\n                        {\n                            params: {\n                                organization: organization,\n                                timeEntry: currentTimeEntry.value.id,\n                            },\n                        }\n                    ),\n                'Time entry updated!'\n            );\n            if (response?.data) {\n                currentTimeEntry.value = response.data;\n            }\n        } else {\n            throw new Error(\n                'Failed to fetch current time entry because organization ID is missing.'\n            );\n        }\n    }\n\n    const isActive = computed(() => {\n        if (currentTimeEntry.value) {\n            return (\n                currentTimeEntry.value.start !== '' &&\n                currentTimeEntry.value.start !== null &&\n                currentTimeEntry.value.end === null\n            );\n        }\n        return false;\n    }); \n    async function setActiveState(newState: boolean, msg?: string) {\n        if (newState) {\n            startLiveTimer();\n            await startTimer();\n        } else {\n            stopLiveTimer();\n            await stopTimer(msg);\n        }\n        useTimeEntriesStore().fetchTimeEntries();\n    }\n\n    return { \n        currentTimeEntry,\n        fetchCurrentTimeEntry,\n        updateTimer,\n        isActive,\n        startLiveTimer,\n        stopLiveTimer,\n        now,\n        setActiveState,\n    };\n});\n"],"names":["useTimeEntriesStore","defineStore","timeEntries","ref","reactive","allTimeEntriesLoaded","handleApiRequestNotifications","useNotificationsStore","queryClient","useQueryClient","patchTimeEntries","queryParams","getCurrentMembershipId","organizationId","getCurrentOrganizationId","timeEntriesResponse","api","missingTimeEntries","entry","e","fetchTimeEntries","fetchMoreTimeEntries","latestTimeEntry","dayjs","updateTimeEntries","ids","changes","updateTimeEntry","timeEntry","response","createTimeEntry","memberId","newTimeEntry","deleteTimeEntry","timeEntryId","discardTimer","isActive","currentTimeEntry","timeEntryIds","useCurrentTimeEntryStore","deleteTimeEntries","resMSG","utc","emptyTimeEntry","useLocalStorage","$reset","now","interval","diffTime","timeStart","start","seconds","mins","secs","startLiveTimer","stopLiveTimer","fetchCurrentTimeEntry","startTimer","organization","membership","startTime","_a","_b","_c","_d","stopTimer","msg","user","getCurrentUserId","currentDateTime","updateTimer","computed","setActiveState","newState"],"mappings":"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"}