import{a as S,m as Z,d as U}from"./time-DR3Bm2fi.js";import{_ as W}from"./GroupedItemsCountButton.vue_vue_type_script_setup_true_lang-DXMK0t_p.js";import{t as K}from"./bundle-mjs-D696Ktp4.js";import{e as y,o as u,a as v,d as $,r as R,z as B,bL as Y,f as A,n as J,u as _,c as C,w as Q,g as X,t as k,F as E,h as ee,A as M,a8 as te,l as b,C as re,s as x}from"./app-CZLkYVhz.js";import{ag as P,a4 as w,E as V,ah as q,ao as ae,aj as z,ak as G,al as I,am as H,an as O,ai as oe}from"./install-BiQo9UUP.js";import{_ as ne}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{a as se}from"./index-CHolqtoz.js";import{b as le,a as L}from"./notification-BrLDF-00.js";import{g as F,b as ie,d as ce}from"./useUser-Dc3_Hjqo.js";import{a as ue,c as pe,b as de,u as me}from"./useMembers-B2Kv7mzm.js";import{B as fe}from"./BillableIcon-BlL7cW2e.js";import{r as ge}from"./UserGroupIcon-DEClCgLE.js";import{r as ve}from"./FolderIcon-BBOgs1tQ.js";import{r as be}from"./CheckCircleIcon-ByT7Dbrk.js";import{r as he}from"./UserCircleIcon-B_03lMym.js";function _e(p,r){return u(),y("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[v("path",{"fill-rule":"evenodd",d:"M4 2a1.5 1.5 0 0 0-1.5 1.5v9A1.5 1.5 0 0 0 4 14h8a1.5 1.5 0 0 0 1.5-1.5V6.621a1.5 1.5 0 0 0-.44-1.06L9.94 2.439A1.5 1.5 0 0 0 8.878 2H4Zm1 5.75A.75.75 0 0 1 5.75 7h4.5a.75.75 0 0 1 0 1.5h-4.5A.75.75 0 0 1 5 7.75Zm0 3a.75.75 0 0 1 .75-.75h4.5a.75.75 0 0 1 0 1.5h-4.5a.75.75 0 0 1-.75-.75Z","clip-rule":"evenodd"})])}const ye={class:"grid grid-cols-12 text-text-primary [&>*]:transition hover:border-b [&>*]:h-[50px]"},xe={class:"justify-start col-span-2 flex items-center pr-2"},Ce={key:0,class:"col-span-2 grid bg-quaternary",style:{"grid-template-columns":"1fr 150px"}},Ge=$({__name:"ReportingRow",props:{entry:{},indent:{type:Boolean},currency:{}},setup(p){const r=p,i=R(!1),o=B("organization");return(n,d)=>{var t,a,s;const c=Y("ReportingRow",!0);return u(),y(E,null,[v("div",ye,[v("div",{class:J(_(K)("pl-6 col-span-10 font-medium flex items-center space-x-3",r.indent?"pl-16":""))},[n.entry.grouped_data&&((t=n.entry.grouped_data)==null?void 0:t.length)>0?(u(),C(W,{key:0,expanded:i.value,onClick:d[0]||(d[0]=e=>i.value=!i.value)},{default:Q(()=>{var e;return[X(k((e=n.entry.grouped_data)==null?void 0:e.length),1)]}),_:1},8,["expanded"])):A("",!0),v("span",null,k(n.entry.description),1)],2),v("div",xe,k(_(S)(n.entry.seconds,(a=_(o))==null?void 0:a.interval_format,(s=_(o))==null?void 0:s.number_format)),1)]),i.value&&n.entry.grouped_data?(u(),y("div",Ce,[(u(!0),y(E,null,ee(n.entry.grouped_data,e=>(u(),C(c,{key:e.description??"none",currency:r.currency,indent:"",entry:e},null,8,["currency","entry"]))),128))])):A("",!0)],64)}}}),ke={class:"w-[calc(100%-1px)]"},we={key:1,class:"chart flex flex-col items-center justify-center"},h="#2770DB",Re="#636E88",Se=$({__name:"ReportingChart",props:{groupedData:{},groupedType:{}},setup(p){P([q,ae,z,G,I,H]),M(O,"dark");const r=B("organization"),i=te(null),o=p,n=b(()=>{var t,a;return o.groupedType==="week"?(t=o==null?void 0:o.groupedData)==null?void 0:t.map(s=>Z(s.key)):(a=o==null?void 0:o.groupedData)==null?void 0:a.map(s=>{var e;return U(s.key??"",(e=r==null?void 0:r.value)==null?void 0:e.date_format)})}),d=b(()=>{var t;return(t=o==null?void 0:o.groupedData)==null?void 0:t.map(a=>({value:a.seconds,itemStyle:{borderColor:new w(0,0,0,1,[{offset:0,color:h},{offset:1,color:h}]),emphasis:{color:new w(0,0,0,1,[{offset:0,color:h},{offset:1,color:h}])},borderRadius:[12,12,0,0],color:new w(0,0,0,1,[{offset:0,color:h},{offset:1,color:h}])}}))}),c=b(()=>({tooltip:{trigger:"item"},grid:{top:0,right:0,bottom:50,left:0},backgroundColor:"transparent",xAxis:{type:"category",data:n.value,markLine:{lineStyle:{color:"rgba(125,156,188,0.1)",type:"dashed"}},axisLine:{lineStyle:{color:"transparent"}},axisLabel:{fontSize:12,fontWeight:600,color:Re,margin:16,fontFamily:"Inter, sans-serif"},axisTick:{lineStyle:{color:"transparent"}}},yAxis:{type:"value",splitLine:{lineStyle:{color:"rgba(125,156,188,0.2)"}}},series:[{data:d.value,type:"bar",tooltip:{valueFormatter:t=>{var a,s;return S(t,(a=r==null?void 0:r.value)==null?void 0:a.interval_format,(s=r==null?void 0:r.value)==null?void 0:s.number_format)}}}]}));return(t,a)=>{var s;return u(),y("div",ke,[t.groupedData&&((s=t.groupedData)==null?void 0:s.length)>0?(u(),C(_(V),{key:0,ref_key:"chart",ref:i,autoresize:!0,class:"chart",option:c.value},null,8,["option"])):(u(),y("div",we,a[0]||(a[0]=[v("p",{class:"text-lg text-text-primary font-semibold"}," No time entries found ",-1),v("p",null,"Try to change the filters and time range",-1)])))])}}}),Ie=ne(Se,[["__scopeId","data-v-fa6e5bf0"]]),He=$({__name:"ReportingPieChart",props:{data:{}},setup(p){P([q,oe,z,G,I,H]),M(O,"dark");const r=B("organization"),i=p,o=se("--label-color-vchart",null,{observe:!0}),n=b(()=>{var c;return(c=i.data)==null?void 0:c.map(t=>({...t,itemStyle:{color:`${t.color}BB`},emphasis:{itemStyle:{color:`${t.color}`}}}))}),d=b(()=>({tooltip:{trigger:"item"},legend:{show:!0,top:"250px",textStyle:{color:o.value}},backgroundColor:"transparent",series:[{label:{show:!1},tooltip:{valueFormatter:c=>{var t,a;return S(c,(t=r==null?void 0:r.value)==null?void 0:t.interval_format,(a=r==null?void 0:r.value)==null?void 0:a.number_format)}},data:n.value,radius:["30%","60%"],top:"-45%",type:"pie"}]}));return(c,t)=>(u(),C(_(V),{class:"background-transparent max-w-[300px] mx-auto h-[460px]",autoresize:!0,option:d.value},null,8,["option"]))}}),Oe=re("reporting",()=>{const p=R(null),r=R(null),{handleApiRequestNotifications:i}=le();async function o(e){const l=F();l&&(p.value=await i(()=>L.getAggregatedTimeEntries({params:{organization:l},queries:e}),void 0,"Failed to fetch reporting data"))}async function n(e){const l=F();l&&(r.value=await i(()=>L.getAggregatedTimeEntries({params:{organization:l},queries:e}),void 0,"Failed to fetch reporting data"))}const d=b(()=>{var e;return(e=p.value)==null?void 0:e.data}),c=b(()=>{var e;return(e=r.value)==null?void 0:e.data}),t={user:"No User",project:"No Project",task:"No Task",billable:"Non-Billable",client:"No Client",description:"No Description"};function a(e,l){var T,D,N,j;if(l===null)return null;if(e===null)return t[l];if(l==="project"){const m=ue(),{projects:f}=x(m);return(T=f.value.find(g=>g.id===e))==null?void 0:T.name}if(l==="user"){if(ie()==="employee")return ce().name;const m=pe(),{members:f}=x(m);return(D=f.value.find(g=>g.user_id===e))==null?void 0:D.name}if(l==="task"){const m=de(),{tasks:f}=x(m);return(N=f.value.find(g=>g.id===e))==null?void 0:N.name}if(l==="client"){const m=me(),{clients:f}=x(m);return(j=f.value.find(g=>g.id===e))==null?void 0:j.name}return l==="billable"?e==="0"?"Non-Billable":"Billable":e}return{aggregatedGraphTimeEntries:d,fetchGraphReporting:o,fetchTableReporting:n,aggregatedTableTimeEntries:c,getNameForReportingRowEntry:a,groupByOptions:[{label:"Members",value:"user",icon:ge},{label:"Projects",value:"project",icon:ve},{label:"Tasks",value:"task",icon:be},{label:"Clients",value:"client",icon:he},{label:"Billable",value:"billable",icon:fe},{label:"Description",value:"description",icon:_e}],emptyPlaceholder:t}});export{Ie as R,He as _,Ge as a,Oe as u};
//# sourceMappingURL=useReporting-S2gixkGw.js.map
