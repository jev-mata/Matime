import{M as be,a as Re}from"./MainContainer-DtfFNECZ.js";import{b as Ee,U as Ge,q as Fe,G as qe,Q as Ke,t as Oe,c as Ze,d as Le,_ as He}from"./AppLayout.vue_vue_type_script_setup_true_lang-B5it3Y5_.js";import{_ as S}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-BtFFhAH2.js";import{a as je,b as F,g as J,d as $e}from"./useMembers-fKrmzvmk.js";import{h,o as m,f as e,d as N,x as A,r as g,y as D,A as G,c as z,Q as Qe,D as ne,v as Je,b as w,w as o,j as M,u as t,e as s,z as te,i as X,F as B,t as V,l as $,n as Z,B as Q,E as We,g as _e,q as ie,m as Y,s as Xe,L as Ye}from"./app-DUID27fb.js";import{_ as Me}from"./TextInput.vue_vue_type_script_setup_true_lang-DItGfPyY.js";import{_ as ae}from"./DialogModal.vue_vue_type_script_setup_true_lang-XAFzrvZ5.js";import{_ as L}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-B1YYrMbH.js";import{u as se}from"./index-D03bkDOQ.js";import{_ as et,a as tt}from"./ProjectDropdownItem.vue_vue_type_script_setup_true_lang-DK8_tzCt.js";import{a as K,b as at}from"./notification-cXlbw5Vr.js";import{g as st}from"./BillableIcon-BvHKiDs7.js";import{U as lt,r as ot}from"./component-CGwmUpCj.js";import{_ as he}from"./ProjectEditBillableSection.vue_vue_type_script_setup_true_lang-BxZFHWr7.js";import{i as ue}from"./billing-BjyYMmvp.js";import{m as xe,n as Pe,o as oe,p as we,q as rt}from"./permissions-BsGx_A78.js";import{_ as Ce,a as Te,b as O,r as Ve,c as Ne}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-D3HYVzWM.js";import{r as de}from"./PencilSquareIcon-Cn40sn4D.js";import{r as me}from"./CheckCircleIcon-CR_8rZI8.js";import{_ as pe,T as Ue}from"./TableHeading-vuCruovc.js";import{_ as nt,a as it,b as ut}from"./ProjectEditModal.vue_vue_type_script_setup_true_lang-BHJ0kWEK.js";import{a as dt}from"./time-D8fzVCgi.js";import{r as mt}from"./PlusCircleIcon-wZoJWwI4.js";import{r as ee}from"./PlusIcon-BdS72468.js";import{_ as ge}from"./CardTitle.vue_vue_type_script_setup_true_lang-CjeHUjba.js";import{C as ke}from"./Card-DteHfFjZ.js";import{f as le}from"./money-CQyR8ykW.js";import{r as Ie,c as ze,_ as pt,a as ct}from"./format-g3Bs48WE.js";import{_ as re}from"./BillableRateInput.vue_vue_type_script_setup_true_lang-DaSVXXWo.js";import{g as R}from"./money-C8rBYmfS.js";import{_ as ft}from"./BillableRateModal.vue_vue_type_script_setup_true_lang-D_WmsSjf.js";import{_ as vt}from"./InputLabel.vue_vue_type_script_setup_true_lang-BZNuSpdv.js";import{a as W,_ as bt}from"./SelectDropdown.vue_vue_type_script_setup_true_lang-BzQ1fREU.js";import"./utc-CJhWvcZK.js";import{_ as _t,a as ye}from"./TabBar.vue_vue_type_script_setup_true_lang-FxptvPJp.js";import{r as xt}from"./FolderIcon-DbiJK5M-.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-BeV0Y9mJ.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-D60G0-_2.js";import"./useOrganization-BJAvoR2D.js";import"./init-BsFOScD8.js";import"./theme-idUPXIqc.js";import"./useQuery-BllrDSBf.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-Bs-sRE9c.js";import"./ClockIcon-DymtNJg4.js";import"./Modal.vue_vue_type_script_setup_true_lang-CNtdiaUN.js";import"./Collection-DeTUl_xM.js";import"./usePrimitiveElement-b6ljwxpe.js";import"./useTypeahead-CLCWGywH.js";import"./RovingFocusGroup-BeTyvml_.js";import"./UpgradeModal.vue_vue_type_script_setup_true_lang-BVwe-qjt.js";import"./useLocale-BjfOTVRz.js";import"./clamp-AKXC_gH0.js";import"./createLucideIcon-l232JYPa.js";import"./ArrowTopRightOnSquareIcon-DdjFU7BP.js";function wt(_,b){return m(),h("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z","clip-rule":"evenodd"}),e("path",{d:"M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z"})])}const gt={key:0,class:"bg-card-background-active"},kt={class:"flex space-x-3 items-center px-4 py-3 text-xs font-medium border-t rounded-b-lg border-card-background-separator"},yt=N({__name:"ProjectDropdown",props:A({border:{type:Boolean,default:!0}},{modelValue:{default:null},modelModifiers:{}}),emits:A(["update:modelValue","changed"],["update:modelValue"]),setup(_,{emit:b}){const r=g(""),p=g(null),u=D(_,"modelValue"),a=g(!1),d=je(),i=b,{projects:c}=G(d),n=g(null),f=z(()=>c.value.filter(j=>{var C,x;return j.name.toLowerCase().includes(((x=(C=r.value)==null?void 0:C.toLowerCase())==null?void 0:x.trim())||"")})),l=Qe();async function y(){if(r.value.length>0&&f.value.length===0){const j=await K.createProject({name:r.value,color:st(),is_billable:!1},{params:{organization:l.props.auth.user.current_team_id}});c.value.unshift(j.data),u.value=j.data.id,r.value="",a.value=!1}}ne(a,j=>{j&&(Je(()=>{var C,x;(x=(C=p.value)==null?void 0:C.$el)==null||x.focus()}),c.value.sort(C=>u.value===C.id?-1:1))});const U=z(()=>c.value.find(j=>j.id===u.value));function P(j){return u.value===j.id}const v=z(()=>{var j;return((j=U.value)==null?void 0:j.name)||"No Project"}),T=z(()=>{var j;return((j=U.value)==null?void 0:j.color)||"var(--theme-color-icon-default)"});function E(j){u.value=j.id,i("changed")}return(j,C)=>(m(),w(Ee,{modelValue:a.value,"onUpdate:modelValue":C[1]||(C[1]=x=>a.value=x),align:"start",width:"60"},{trigger:o(()=>[s(et,{ref_key:"projectDropdownTrigger",ref:n,color:T.value,size:"xlarge",border:j.border,tag:"button",name:v.value,class:"focus:border-input-border-active bg-input-background focus:outline-0 focus:bg-card-background-separator hover:bg-card-background-separator"},null,8,["color","border","name"])]),content:o(()=>[a.value?(m(),w(t(lt),{key:0,options:{immediate:!0,allowOutsideClick:!0}},{default:o(()=>[s(t(Ge),{"search-term":r.value,"onUpdate:searchTerm":C[0]||(C[0]=x=>r.value=x),open:a.value,"model-value":U.value,class:"relative","onUpdate:modelValue":E},{default:o(()=>[s(t(Fe),null,{default:o(()=>[s(t(qe),{ref_key:"searchInput",ref:p,class:"bg-card-background border-0 placeholder-muted text-sm text-text-primary py-2.5 focus:ring-0 border-b border-card-background-separator focus:border-card-background-separator w-full",placeholder:"Search for a project...",onKeydown:te(y,["enter"])},null,512)]),_:1}),s(t(Ke),null,{default:o(()=>[s(t(Oe),{ref:"dropdownViewport",class:"w-60 max-h-60 overflow-y-scroll"},{default:o(()=>[(m(!0),h(B,null,X(f.value,x=>(m(),w(t(Ze),{key:x.id,value:x,class:"data-[highlighted]:bg-card-background-active","data-project-id":x.id},{default:o(()=>[s(tt,{selected:P(x),color:x.color,name:x.name},null,8,["selected","color","name"])]),_:2},1032,["value","data-project-id"]))),128)),r.value.length>0&&f.value.length===0?(m(),h("div",gt,[e("div",kt,[s(t(ot),{class:"w-5 flex-shrink-0"}),e("span",null,'Add "'+V(r.value)+'" as a new Project',1)])])):M("",!0)]),_:1},512)]),_:1})]),_:1},8,["search-term","open","model-value"])]),_:1})):M("",!0)]),_:1},8,["modelValue"]))}}),jt={class:"flex items-center space-x-4"},$t={class:"col-span-6 sm:col-span-4 flex-1"},Mt={class:"col-span-6 sm:col-span-4"},Se=N({__name:"TaskCreateModal",props:A({projectId:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(_){const{createTask:b}=F(),r=D(_,"show"),p=g(!1),u=g(""),a=g(null),d=_,i=g(d.projectId);ne(()=>d.projectId,f=>{i.value=f});async function c(){await b({name:u.value,project_id:i.value,estimated_time:a.value}),r.value=!1,u.value=""}const n=g(null);return se(n,{initialValue:!0}),(f,l)=>(m(),w(ae,{closeable:"",show:r.value,onClose:l[6]||(l[6]=y=>r.value=!1)},{title:o(()=>l[7]||(l[7]=[e("div",{class:"flex space-x-2"},[e("span",null," Create Task ")],-1)])),content:o(()=>[e("div",jt,[e("div",$t,[s(Me,{id:"taskName",ref_key:"taskNameInput",ref:n,modelValue:u.value,"onUpdate:modelValue":l[0]||(l[0]=y=>u.value=y),type:"text",placeholder:"Task Name",class:"block w-full",required:"",autocomplete:"taskName",onKeydown:l[1]||(l[1]=te(y=>c(),["enter"]))},null,8,["modelValue"])]),e("div",Mt,[s(yt,{modelValue:i.value,"onUpdate:modelValue":l[2]||(l[2]=y=>i.value=y)},null,8,["modelValue"])])]),t(ue)()?(m(),w(he,{key:0,modelValue:a.value,"onUpdate:modelValue":l[3]||(l[3]=y=>a.value=y),onSubmit:l[4]||(l[4]=y=>c())},null,8,["modelValue"])):M("",!0)]),footer:o(()=>[s(S,{onClick:l[5]||(l[5]=y=>r.value=!1)},{default:o(()=>l[8]||(l[8]=[$(" Cancel ")])),_:1,__:[8]}),s(L,{class:Z(["ms-3",{"opacity-25":p.value}]),disabled:p.value,onClick:c},{default:o(()=>l[9]||(l[9]=[$(" Create Task ")])),_:1,__:[9]},8,["class","disabled"])]),_:1},8,["show"]))}}),ht=["aria-label"],Pt={key:0},Ct={key:1},Tt=N({__name:"TaskMoreOptionsDropdown",props:{task:{}},emits:["delete","edit","done"],setup(_,{emit:b}){const r=b,p=_;return(u,a)=>(m(),w(t(Ce),null,{default:o(()=>[s(t(Te),{"as-child":""},{default:o(()=>[e("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Task "+p.task.name},a[3]||(a[3]=[e("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,ht)]),_:1}),s(t(Ne),{class:"min-w-[150px]",align:"end"},{default:o(()=>[t(xe)()?(m(),w(t(O),{key:0,"aria-label":"Edit Task "+p.task.name,"data-testid":"task_edit",class:"flex items-center space-x-3 cursor-pointer",onClick:a[0]||(a[0]=d=>r("edit"))},{default:o(()=>[s(t(de),{class:"w-5 text-icon-active"}),a[4]||(a[4]=e("span",null,"Edit",-1))]),_:1,__:[4]},8,["aria-label"])):M("",!0),t(xe)()?(m(),w(t(O),{key:1,"aria-label":"Mark Task "+p.task.name+" as done",class:"flex items-center space-x-3 cursor-pointer",onClick:a[1]||(a[1]=d=>r("done"))},{default:o(()=>[s(t(me),{class:"w-5 text-icon-active"}),p.task.is_done?(m(),h("span",Pt,"Mark as active")):(m(),h("span",Ct,"Mark as done"))]),_:1},8,["aria-label"])):M("",!0),t(Pe)()?(m(),w(t(O),{key:2,"aria-label":"Delete Task "+p.task.name,"data-testid":"task_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:a[2]||(a[2]=d=>r("delete"))},{default:o(()=>[s(t(Ve),{class:"w-5"}),a[5]||(a[5]=e("span",null,"Delete",-1))]),_:1,__:[5]},8,["aria-label"])):M("",!0)]),_:1})]),_:1}))}}),Vt={class:"flex items-center space-x-4"},Nt={class:"col-span-6 sm:col-span-4 flex-1"},Ut=N({__name:"TaskEditModal",props:A({task:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(_){const{updateTask:b}=F(),r=D(_,"show"),p=g(!1),u=_,a=g({name:u.task.name,estimated_time:u.task.estimated_time});async function d(){await b(u.task.id,a.value),r.value=!1}const i=g(null);return se(i,{initialValue:!0}),(c,n)=>(m(),w(ae,{closeable:"",show:r.value,onClose:n[5]||(n[5]=f=>r.value=!1)},{title:o(()=>n[6]||(n[6]=[e("div",{class:"flex space-x-2"},[e("span",null," Update Task ")],-1)])),content:o(()=>[e("div",Vt,[e("div",Nt,[s(Me,{id:"taskName",ref_key:"taskNameInput",ref:i,modelValue:a.value.name,"onUpdate:modelValue":n[0]||(n[0]=f=>a.value.name=f),type:"text",placeholder:"Task Name",class:"mt-1 block w-full",required:"",autocomplete:"taskName",onKeydown:n[1]||(n[1]=te(f=>d(),["enter"]))},null,8,["modelValue"])])]),t(ue)()?(m(),w(he,{key:0,modelValue:a.value.estimated_time,"onUpdate:modelValue":n[2]||(n[2]=f=>a.value.estimated_time=f),onSubmit:n[3]||(n[3]=f=>d())},null,8,["modelValue"])):M("",!0)]),footer:o(()=>[s(S,{onClick:n[4]||(n[4]=f=>r.value=!1)},{default:o(()=>n[7]||(n[7]=[$(" Cancel ")])),_:1,__:[7]}),s(L,{class:Z(["ms-3",{"opacity-25":p.value}]),disabled:p.value,onClick:d},{default:o(()=>n[8]||(n[8]=[$(" Update Task ")])),_:1,__:[8]},8,["class","disabled"])]),_:1},8,["show"]))}}),It={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},zt={class:"overflow-ellipsis overflow-hidden"},St={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},At={key:0},Bt={key:1},Dt={class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},Rt={key:2},Et={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},Gt={key:1},Ft={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},qt=N({__name:"TaskTableRow",props:{task:{}},setup(_){const b=_,r=Q("organization");function p(){F().deleteTask(b.task.id)}function u(){F().updateTask(b.task.id,{...b.task,is_done:!b.task.is_done})}const a=g(!1);return(d,i)=>(m(),w(pe,null,{default:o(()=>{var c,n;return[e("div",It,[e("span",zt,V(d.task.name),1)]),e("div",St,[d.task.spent_time?(m(),h("span",At,V(t(dt)(d.task.spent_time,(c=t(r))==null?void 0:c.interval_format,(n=t(r))==null?void 0:n.number_format)),1)):(m(),h("span",Bt," -- "))]),e("div",Dt,[t(ue)()?d.task.estimated_time?(m(),w(it,{key:1,estimated:d.task.estimated_time,current:d.task.spent_time},null,8,["estimated","current"])):(m(),h("span",Rt," -- ")):(m(),w(nt,{key:0}))]),e("div",Et,[d.task.is_done?(m(),h(B,{key:0},[s(t(me),{class:"w-5"}),i[2]||(i[2]=e("span",null,"Done",-1))],64)):(m(),h("span",Gt,"Active"))]),e("div",Ft,[t(Pe)()?(m(),w(Tt,{key:0,task:d.task,onDone:u,onEdit:i[0]||(i[0]=f=>a.value=!0),onDelete:p},null,8,["task"])):M("",!0)]),s(Ut,{show:a.value,"onUpdate:show":i[1]||(i[1]=f=>a.value=f),task:d.task},null,8,["show","task"])]}),_:1}))}}),Kt=N({__name:"TaskTableHeading",setup(_){return(b,r)=>(m(),w(Ue,null,{default:o(()=>r[0]||(r[0]=[e("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Task Name ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Total Time ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Progress ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Status",-1),e("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[e("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),Ot={class:"flow-root"},Zt={class:"inline-block min-w-full align-middle"},Lt={"data-testid":"task_table",role:"table",class:"grid min-w-full",style:{"grid-template-columns":`1fr minmax(80px, auto) minmax(120px, auto) minmax(
                            50px,
                            auto
                        )
                        80px`}},Ht={key:0,class:"col-span-5 py-24 text-center"},Qt={key:0,class:"pb-5"},Jt=N({__name:"TaskTable",props:{projectId:{},tasks:{}},setup(_){const b=_,r=g(!1);return(p,u)=>(m(),h(B,null,[s(Se,{show:r.value,"onUpdate:show":u[0]||(u[0]=a=>r.value=a),"project-id":b.projectId},null,8,["show","project-id"]),e("div",Ot,[e("div",Zt,[e("div",Lt,[s(Kt),p.tasks.length===0?(m(),h("div",Ht,[s(t(mt),{class:"w-8 text-icon-default inline pb-2"}),u[3]||(u[3]=e("h3",{class:"text-text-primary font-semibold"},"No tasks found",-1)),t(oe)()?(m(),h("p",Qt," Create your first task now! ")):M("",!0),t(oe)()?(m(),w(S,{key:1,icon:t(ee),onClick:u[1]||(u[1]=a=>r.value=!0)},{default:o(()=>u[2]||(u[2]=[$("Create your First Task ")])),_:1,__:[2]},8,["icon"])):M("",!0)])):M("",!0),(m(!0),h(B,null,X(p.tasks,a=>(m(),w(qt,{key:a.id,task:a},null,8,["task"]))),128))])])])],64))}}),H=We("project-members",()=>{const _=g(null),{handleApiRequestNotifications:b}=at();async function r(i){const c=J();c&&(_.value=await b(()=>K.getProjectMembers({params:{organization:c,project:i}}),void 0,"Failed to fetch project members"))}async function p(i,c){const n=J();n&&(await b(()=>K.createProjectMember(c,{params:{organization:n,project:i}}),"Project member added successfully","Failed to add project member"),await r(i))}async function u(i,c){const n=J();if(n){const f=await b(()=>K.updateProjectMember(c,{params:{organization:n,projectMember:i}}),"Project member updated successfully","Failed to update project member");await r(f.data.project_id)}}async function a(i,c){const n=J();n&&(await b(()=>K.deleteProjectMember(void 0,{params:{organization:n,projectMember:c}}),"Project member removed successfully","Failed to remove project member"),await r(i))}return{projectMembers:z(()=>{var i;return((i=_.value)==null?void 0:i.data)||[]}),fetchProjectMembers:r,createProjectMember:p,deleteProjectMember:a,updateProjectMember:u}}),Wt=["aria-label"],Ae=N({__name:"ProjectMemberMoreOptionsDropdown",props:{projectMember:{}},emits:["delete","edit"],setup(_,{emit:b}){const r=b,p=_,{members:u}=G($e()),a=z(()=>u.value.find(d=>d.id===p.projectMember.user_id));return(d,i)=>(m(),w(t(Ce),null,{default:o(()=>[s(t(Te),{"as-child":""},{default:o(()=>{var c;return[e("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Project Member "+((c=a.value)==null?void 0:c.name)},i[2]||(i[2]=[e("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,Wt)]}),_:1}),s(t(Ne),{class:"min-w-[150px]",align:"end"},{default:o(()=>{var c,n;return[s(t(O),{"aria-label":"Edit Project Member "+((c=a.value)==null?void 0:c.name),class:"flex items-center space-x-3 cursor-pointer",onClick:i[0]||(i[0]=_e(f=>r("edit"),["prevent"]))},{default:o(()=>[s(t(de),{class:"w-5 text-icon-active"}),i[3]||(i[3]=e("span",null,"Edit",-1))]),_:1,__:[3]},8,["aria-label"]),s(t(O),{"aria-label":"Delete Project Member "+((n=a.value)==null?void 0:n.name),"data-testid":"project_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:i[1]||(i[1]=_e(f=>r("delete"),["prevent"]))},{default:o(()=>[s(t(Ve),{class:"w-5"}),i[4]||(i[4]=e("span",null,"Remove from Team",-1))]),_:1,__:[4]},8,["aria-label"])]}),_:1})]),_:1}))}}),Xt={class:"py-1 text-center"},Yt=N({__name:"ProjectMemberBillableRateModal",props:A({newBillableRate:{},memberName:{}},{show:{default:!1},showModifiers:{},saving:{default:!1},savingModifiers:{}}),emits:A(["submit"],["update:show","update:saving"]),setup(_){const b=D(_,"show"),r=D(_,"saving"),p=Q("organization");return(u,a)=>(m(),w(ft,{show:b.value,"onUpdate:show":a[0]||(a[0]=d=>b.value=d),saving:r.value,"onUpdate:saving":a[1]||(a[1]=d=>r.value=d),title:"Update Project Member Billable Rate",onSubmit:a[2]||(a[2]=d=>u.$emit("submit"))},{default:o(()=>{var d,i,c;return[e("p",Xt,[$(" The billable rate of "+V(u.memberName)+" will be updated to ",1),e("strong",null,V(u.newBillableRate?t(le)(u.newBillableRate,t(R)(),(d=t(p))==null?void 0:d.currency_format,(i=t(p))==null?void 0:i.currency_symbol,(c=t(p))==null?void 0:c.number_format):" the default rate of the project"),1),a[3]||(a[3]=$(". "))]),a[4]||(a[4]=e("p",{class:"py-1 text-center font-semibold max-w-md mx-auto"}," Do you want to update all existing time entries, where the project member billable rate applies as well? ",-1))]}),_:1,__:[4]},8,["show","saving"]))}}),ea={class:"grid grid-cols-3 items-center space-x-4"},ta={class:"col-span-3 sm:col-span-2 space-x-2 flex items-center"},aa={class:"col-span-3 sm:col-span-1 flex-1"},Be=N({__name:"ProjectMemberEditModal",props:A({projectMember:{},name:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(_){const{updateProjectMember:b}=H(),r=D(_,"show"),p=g(!1),u=_,a=g({billable_rate:u.projectMember.billable_rate}),d=g(!1);async function i(){if(u.projectMember.billable_rate!==a.value.billable_rate){setTimeout(()=>{d.value=!0},0);return}await b(u.projectMember.id,a.value),r.value=!1,a.value={billable_rate:null}}async function c(){await b(u.projectMember.id,a.value),r.value=!1,d.value=!1}ne(()=>r.value,f=>{f&&(a.value={billable_rate:u.projectMember.billable_rate})});const n=g(null);return se(n,{initialValue:!0}),(f,l)=>(m(),w(ae,{closeable:"",show:r.value,onClose:l[4]||(l[4]=y=>r.value=!1)},{title:o(()=>l[5]||(l[5]=[e("div",{class:"flex space-x-2"},[e("span",null,"Edit Project Member")],-1)])),content:o(()=>[s(Yt,{show:d.value,"onUpdate:show":l[0]||(l[0]=y=>d.value=y),"member-name":u.name,"new-billable-rate":a.value.billable_rate,onClose:l[1]||(l[1]=y=>d.value=!1),onSubmit:c},null,8,["show","member-name","new-billable-rate"]),e("div",ea,[e("div",ta,[s(t(Ie),{class:"w-4 text-text-secondary"}),e("span",null,V(u.name),1)]),e("div",aa,[s(vt,{for:"billable_rate",class:"mb-2",value:"Billable Rate"}),s(re,{modelValue:a.value.billable_rate,"onUpdate:modelValue":l[2]||(l[2]=y=>a.value.billable_rate=y),currency:t(R)(),name:"billable_rate",onKeydown:te(i,["enter"])},null,8,["modelValue","currency"])])])]),footer:o(()=>[s(S,{onClick:l[3]||(l[3]=y=>r.value=!1)},{default:o(()=>l[6]||(l[6]=[$("Cancel")])),_:1,__:[6]}),s(L,{class:Z(["ms-3",{"opacity-25":p.value}]),disabled:p.value,onClick:i},{default:o(()=>l[7]||(l[7]=[$(" Update Project Member ")])),_:1,__:[7]},8,["class","disabled"])]),_:1},8,["show"]))}}),sa={class:"whitespace-nowrap flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},la={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},oa={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},ra={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},na=N({__name:"ProjectMemberTableRow",props:{projectMember:{}},setup(_){const b=_,r=Q("organization");function p(){H().deleteProjectMember(b.projectMember.project_id,b.projectMember.id)}function u(){i.value=!0}const{members:a}=G($e()),d=z(()=>a.value.find(c=>c.id===b.projectMember.member_id)),i=g(!1);return(c,n)=>(m(),w(pe,null,{default:o(()=>{var f,l,y,U,P,v;return[s(Be,{show:i.value,"onUpdate:show":n[0]||(n[0]=T=>i.value=T),name:(f=d.value)==null?void 0:f.name,"project-member":c.projectMember},null,8,["show","name","project-member"]),e("div",sa,[e("span",null,V((l=d.value)==null?void 0:l.name),1)]),e("div",la,V(c.projectMember.billable_rate?t(le)(c.projectMember.billable_rate,t(R)(),(y=t(r))==null?void 0:y.currency_format,(U=t(r))==null?void 0:U.currency_symbol,(P=t(r))==null?void 0:P.number_format):"--"),1),e("div",oa,V(t(ze)(((v=d.value)==null?void 0:v.role)??"")),1),e("div",ra,[s(Ae,{"project-member":c.projectMember,onDelete:p,onEdit:u},null,8,["project-member"])])]}),_:1}))}}),ia=N({__name:"ProjectMemberTableHeading",setup(_){return(b,r)=>(m(),w(Ue,null,{default:o(()=>r[0]||(r[0]=[e("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Name ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Billable Rate ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Role",-1),e("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[e("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),ua={class:"grid grid-cols-3 items-center space-x-4"},da={class:"col-span-3 sm:col-span-2"},ma={class:"col-span-3 sm:col-span-1 flex-1"},pa={class:"grid grid-cols-3 items-center space-x-4"},ca={class:"col-span-3 sm:col-span-2"},fa={class:"flex-1 truncate"},va={class:"col-span-3 sm:col-span-1 flex-1"},De=N({__name:"ProjectMemberCreateModal",props:A({projectId:{},existingMembers:{}},{show:{default:!1},showModifiers:{}}),emits:A(["refresh"],["update:show"]),setup(_,{emit:b}){const{createProjectMember:r}=H(),p=D(_,"show"),u=g(!1),a=_,d=b,i=g({member_id:"",billable_rate:null}),c=g([]),n=g(""),f=g(null);async function l(){const{data:x}=await Y.get(`/organizations/teams/projects/${a.projectId}`);c.value=x.team.length>0?x.team:[{id:null,name:"No Group Available",billable_rate:null}]}ie(l);async function y(){await r(a.projectId,i.value),p.value=!1,i.value={member_id:"",billable_rate:null}}async function U(){console.log(n.value);const x=`/teams/${n.value}/projects/${a.projectId}`;console.log(x);const{data:k}=await Y.post(x);C(),console.log(k),d("refresh"),l()}const P=z(()=>c.value.map(x=>({label:x.name,value:x.id}))),v=z(()=>{var x;return((x=c.value.find(k=>k.id===n.value))==null?void 0:x.name)||"Select Group..."}),T=g(null);se(T,{initialValue:!0});function E(x){return x.value}function j(x){return x.label}function C(){n.value="",f.value=null}return(x,k)=>(m(),w(ae,{closeable:"",show:p.value,onClose:k[5]||(k[5]=I=>p.value=!1)},{title:o(()=>k[6]||(k[6]=[e("div",{class:"flex space-x-2"},[e("span",null,"Add Project Member")],-1)])),content:o(()=>[e("div",ua,[e("div",da,[s(pt,{modelValue:i.value.member_id,"onUpdate:modelValue":k[0]||(k[0]=I=>i.value.member_id=I),"hidden-members":a.existingMembers,placeholder:"Select Members..."},null,8,["modelValue","hidden-members"])]),e("div",ma,[s(re,{modelValue:i.value.billable_rate,"onUpdate:modelValue":k[1]||(k[1]=I=>i.value.billable_rate=I),name:"billable_rate",currency:t(R)()},null,8,["modelValue","currency"])])]),k[7]||(k[7]=e("div",{class:"flex items-center gap-4 my-4"},[e("div",{class:"flex-grow border-t border-gray-600"}),e("span",{class:"text-gray-500 text-sm"},"or"),e("div",{class:"flex-grow border-t border-gray-600"})],-1)),e("div",pa,[e("div",ca,[s(bt,{modelValue:n.value,"onUpdate:modelValue":k[2]||(k[2]=I=>n.value=I),items:P.value,getKeyFromItem:E,getNameForItem:j},{trigger:o(()=>[s(t(W),{tag:"button",class:"flex w-full text-base text-left space-x-3 px-3 text-text-secondary bg-input-background font-normal cursor py-1.5"},{default:o(()=>[s(t(Ie),{class:"relative z-10 w-4 text-text-secondary"}),e("div",fa,V(v.value),1),s(t(ct),{class:"w-4 text-text-secondary"})]),_:1})]),_:1},8,["modelValue","items"])]),e("div",va,[s(re,{modelValue:f.value,"onUpdate:modelValue":k[3]||(k[3]=I=>f.value=I),name:"group_billable_rate",currency:t(R)()},null,8,["modelValue","currency"])])])]),footer:o(()=>[s(S,{onClick:k[4]||(k[4]=I=>p.value=!1)},{default:o(()=>k[8]||(k[8]=[$("Cancel")])),_:1,__:[8]}),v.value.value!="Select Group..."?(m(),w(S,{key:0,onClick:C,class:"ml-3"},{default:o(()=>k[9]||(k[9]=[$(" Clear ")])),_:1,__:[9]})):M("",!0),v.value.value=="Select Group..."&&v.value.value!="No Group Available"?(m(),w(L,{key:1,class:Z(["ms-3",{"opacity-25":u.value}]),disabled:u.value,onClick:y},{default:o(()=>k[10]||(k[10]=[$(" Add Project Member ")])),_:1,__:[10]},8,["class","disabled"])):M("",!0),v.value.value!="Select Group..."&&v.value.value!="No Group Available"?(m(),w(L,{key:2,class:Z(["ms-3",{"opacity-25":u.value}]),disabled:u.value,onClick:U},{default:o(()=>k[11]||(k[11]=[$(" Add Project Group ")])),_:1,__:[11]},8,["class","disabled"])):M("",!0)]),_:1},8,["show"]))}}),ba={class:"flow-root"},_a={class:"inline-block min-w-full align-middle"},xa={"data-testid":"project_member_table",class:"grid min-w-full",style:{"grid-template-columns":"1fr 150px 150px 80px"}},wa={key:0,class:"col-span-5 py-24 text-center"},ga={class:"whitespace-nowrap flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},ka={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},ya={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},ja={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},$a=N({__name:"ProjectMemberTable",props:{projectId:{},projectMembers:{}},setup(_){const b=Q("organization"),r=g(!1),p=g([]);async function u(){const{data:n}=await Y.get(`/organizations/projects/teams/${_.projectId}`);p.value=n.team??[]}ie(()=>{u()});async function a(n){console.log(n);const f=`/teams/${n}/projects/${_.projectId}`;console.log(f);const{data:l}=await Y.delete(f);console.log(l),d()}const d=()=>{console.log("ReInit called"),u()};function i(){c.value=!0}const c=g(!1);return(n,f)=>(m(),h(B,null,[s(De,{show:r.value,"onUpdate:show":f[0]||(f[0]=l=>r.value=l),"existing-members":n.projectMembers,onRefresh:d,"project-id":n.projectId},null,8,["show","existing-members","project-id"]),e("div",ba,[e("div",_a,[e("div",xa,[s(ia),n.projectMembers.length===0?(m(),h("div",wa,[s(t(wt),{class:"w-8 text-icon-default inline pb-2"}),f[4]||(f[4]=e("h3",{class:"text-text-primary font-semibold"},"No project members",-1)),f[5]||(f[5]=e("p",{class:"pb-5"},"Add the first project member!",-1)),s(S,{icon:t(ee),onClick:f[1]||(f[1]=l=>r.value=!0)},{default:o(()=>f[3]||(f[3]=[$("Add a new Project Member ")])),_:1,__:[3]},8,["icon"])])):M("",!0),(m(!0),h(B,null,X(n.projectMembers,l=>(m(),w(na,{key:l.id,"project-member":l},null,8,["project-member"]))),128)),(m(!0),h(B,null,X(p.value,l=>(m(),w(pe,{key:l.id},{default:o(()=>{var y,U,P;return[s(Be,{show:c.value,"onUpdate:show":f[2]||(f[2]=v=>c.value=v),name:l==null?void 0:l.name,"project-member":l},null,8,["show","name","project-member"]),e("div",ga,[e("span",null,V(l==null?void 0:l.name),1)]),e("div",ka,V(l.billable_rate?t(le)(l.billable_rate,t(R)(),(y=t(b))==null?void 0:y.currency_format,(U=t(b))==null?void 0:U.currency_symbol,(P=t(b))==null?void 0:P.number_format):"--"),1),e("div",ya,V(t(ze)("Group")),1),e("div",ja,[s(Ae,{"project-member":l,onDelete:v=>a(l.id),onEdit:i},null,8,["project-member","onDelete"])])]}),_:2},1024))),128))])])])],64))}}),Ma={class:"flex","aria-label":"Breadcrumb"},ha={role:"list",class:"flex items-center space-x-2"},Pa={class:"flex items-center space-x-6"},Ca={class:"flex items-center space-x-3 text-text-primary font-semibold text-base"},Ta={class:"flex space-x-3 items-center"},Va={class:"px-4"},Na={class:"grid lg:grid-cols-2 gap-x-6 pt-6"},Ua={class:"w-full items-center flex justify-between"},Ia={class:"pl-6"},za={key:0},Bs=N({__name:"ProjectShow",setup(_){var y,U;const{projects:b}=G(je()),r=Q("organization"),p=z(()=>b.value.find(P=>P.id===route().params.project)??null),u=g(!1),a=g(!1),d=(U=(y=route())==null?void 0:y.params)==null?void 0:U.project,{projectMembers:i}=G(H());ie(()=>{we()&&H().fetchProjectMembers(d),F().fetchTasks()});const c=g(!1),n=g("active"),{tasks:f}=G(F()),l=z(()=>f.value.filter(P=>n.value==="active"?P.project_id===d&&!P.is_done:P.project_id===d&&P.is_done));return(P,v)=>(m(),w(He,{title:"Projects","data-testid":"projects_view"},{default:o(()=>[s(be,{class:"py-5 border-b border-default-background-separator flex justify-between items-center"},{default:o(()=>{var T,E,j,C,x,k,I;return[e("nav",Ma,[e("ol",ha,[e("li",null,[e("div",Pa,[s(t(Xe),{href:P.route("projects"),class:"flex items-center space-x-2.5"},{default:o(()=>[s(t(xt),{class:"w-6 text-icon-default"}),v[7]||(v[7]=e("span",{class:"font-medium"},"Projects",-1))]),_:1,__:[7]},8,["href"])])]),e("li",null,[e("div",Ca,[s(t(Le),{class:"h-5 w-5 flex-shrink-0 text-text-secondary","aria-hidden":"true"}),e("div",Ta,[e("div",{style:Ye({backgroundColor:(T=p.value)==null?void 0:T.color,boxShadow:`var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) ${(E=p.value)==null?void 0:E.color}30`}),class:"w-3 h-3 rounded-full"},null,4),e("span",null,V((j=p.value)==null?void 0:j.name),1)])])])]),e("div",Va,[(C=p.value)!=null&&C.billable_rate?(m(),w(t(W),{key:0},{default:o(()=>{var q,ce,fe,ve;return[$(V(t(le)(((q=p.value)==null?void 0:q.billable_rate)??0,t(R)(),(ce=t(r))==null?void 0:ce.currency_format,(fe=t(r))==null?void 0:fe.currency_symbol,(ve=t(r))==null?void 0:ve.number_format))+" / h ",1)]}),_:1})):M("",!0),(x=p.value)!=null&&x.is_billable&&!((k=p.value)!=null&&k.billable_rate)?(m(),w(t(W),{key:1},{default:o(()=>v[8]||(v[8]=[$(" Default Rate ")])),_:1,__:[8]})):M("",!0),(I=p.value)!=null&&I.is_billable?M("",!0):(m(),w(t(W),{key:2},{default:o(()=>v[9]||(v[9]=[$(" Non-Billable ")])),_:1,__:[9]}))])]),e("div",null,[t(rt)()?(m(),w(S,{key:0,icon:t(de),onClick:v[0]||(v[0]=q=>c.value=!0)},{default:o(()=>v[10]||(v[10]=[$(" Edit Project ")])),_:1,__:[10]},8,["icon"])):M("",!0),p.value?(m(),w(ut,{key:1,show:c.value,"onUpdate:show":v[1]||(v[1]=q=>c.value=q),"original-project":p.value},null,8,["show","original-project"])):M("",!0)])]}),_:1}),s(be,null,{default:o(()=>[e("div",Na,[e("div",null,[s(ge,{title:"Tasks",icon:t(me)},{actions:o(()=>[e("div",Ua,[e("div",Ia,[s(_t,{modelValue:n.value,"onUpdate:modelValue":v[2]||(v[2]=T=>n.value=T)},{default:o(()=>[s(ye,{value:"active"},{default:o(()=>v[11]||(v[11]=[$("Active ")])),_:1,__:[11]}),s(ye,{value:"done"},{default:o(()=>v[12]||(v[12]=[$("Done ")])),_:1,__:[12]})]),_:1},8,["modelValue"])]),t(oe)()?(m(),w(S,{key:0,icon:t(ee),onClick:v[3]||(v[3]=T=>u.value=!0)},{default:o(()=>v[13]||(v[13]=[$("Create Task ")])),_:1,__:[13]},8,["icon"])):M("",!0),s(Se,{show:u.value,"onUpdate:show":v[4]||(v[4]=T=>u.value=T),"project-id":t(d)},null,8,["show","project-id"])])]),_:1},8,["icon"]),s(ke,null,{default:o(()=>[s(Jt,{tasks:l.value,"project-id":t(d)},null,8,["tasks","project-id"])]),_:1})]),t(we)()?(m(),h("div",za,[s(ge,{title:"Project Members",icon:t(Re)},{actions:o(()=>[s(S,{icon:t(ee),onClick:v[5]||(v[5]=T=>a.value=!0)},{default:o(()=>v[14]||(v[14]=[$(" Add Member ")])),_:1,__:[14]},8,["icon"]),s(De,{show:a.value,"onUpdate:show":v[6]||(v[6]=T=>a.value=T),"project-id":t(d),"existing-members":t(i)},null,8,["show","project-id","existing-members"])]),_:1},8,["icon"]),s(ke,null,{default:o(()=>[s($a,{"project-members":t(i),"project-id":t(d)},null,8,["project-members","project-id"])]),_:1})])):M("",!0)])]),_:1})]),_:1}))}});export{Bs as default};
//# sourceMappingURL=ProjectShow-B64oDSDn.js.map
