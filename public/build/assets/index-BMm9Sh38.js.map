{"version":3,"file":"index-BMm9Sh38.js","sources":["../../../resources/js/Components/ui/button/Button.vue","../../../extensions/Timesheet/resources/js/Pages/index.vue"],"sourcesContent":["<script setup lang=\"ts\">\nimport type { HTMLAttributes } from 'vue'\nimport { cn } from '@/lib/utils'\nimport { Primitive, type PrimitiveProps } from 'reka-ui'\nimport { type ButtonVariants, buttonVariants } from '.'\n\ninterface Props extends PrimitiveProps {\n  variant?: ButtonVariants['variant']\n  size?: ButtonVariants['size']\n  class?: HTMLAttributes['class']\n}\n\nconst props = withDefaults(defineProps<Props>(), {\n  as: 'button',\n})\n</script>\n\n<template>\n  <Primitive\n    :as=\"as\"\n    :as-child=\"asChild\"\n    :class=\"cn(buttonVariants({ variant, size }), props.class)\"\n  >\n    <slot />\n  </Primitive>\n</template>\n","<script setup lang=\"ts\">\r\nimport AppLayout from \"@/Layouts/AppLayout.vue\";\r\nimport TimeTracker from \"@/Components/TimeTracker.vue\";\r\nimport MainContainer from \"@/packages/ui/src/MainContainer.vue\";\r\nimport { canViewMembers } from \"@/utils/permissions\";\r\nimport { useQueryClient } from \"@tanstack/vue-query\";\r\n\r\nimport TimeRangeSelector from '@/packages/ui/src/Input/TimeRangeSelector.vue';\r\nimport { ChevronRightIcon } from '@heroicons/vue/16/solid';\r\nimport { ref, onMounted, computed } from 'vue'\r\nimport axios from 'axios'\r\nimport AlertDialog from \"@/Components/ui/alert-dialog/AlertDialog.vue\";\r\nimport AlertDialogTitle from \"@/Components/ui/alert-dialog/AlertDialogTitle.vue\";\r\nimport Popover from \"@/Components/ui/popover/Popover.vue\";\r\nimport AlertDialogContent from \"@/Components/ui/alert-dialog/AlertDialogContent.vue\";\r\nimport AlertDialogFooter from \"@/Components/ui/alert-dialog/AlertDialogFooter.vue\";\r\nimport { usePage } from \"@inertiajs/vue3\";\r\nimport NavLink from \"@/Components/NavLink.vue\";\r\nimport { ClockIcon } from \"@heroicons/vue/24/outline\";\r\nimport Button from \"@/Components/ui/button/Button.vue\";\r\nimport TagBadge from '@/packages/ui/src/Tag/TagBadge.vue';\r\nimport ProjectBadge from '@/packages/ui/src/Project/ProjectBadge.vue';\r\n\r\nimport type { Tag } from '@/packages/api/src';\r\nimport dayjs from \"dayjs\";\r\nconst queryClient = useQueryClient();\r\n\r\nconst page = usePage();\r\nconst refreshDashboardData = () => {\r\n  // Invalidate all dashboard queries to trigger refetching\r\n  queryClient.invalidateQueries({ queryKey: [\"latestTasks\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"lastSevenDays\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"dailyTrackedHours\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"latestTeamActivity\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"weeklyProjectOverview\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"totalWeeklyTime\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"totalWeeklyBillableTime\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"totalWeeklyBillableAmount\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"weeklyHistory\"] });\r\n  queryClient.invalidateQueries({ queryKey: [\"timeEntries\"] });\r\n};\r\n\r\nconst openModal = ref(true);\r\n\r\n\r\nfunction closeModal() {\r\n  openModal.value = false;\r\n}\r\nfunction duration(entry: { start: string; end: string }) {\r\n  const start = new Date(entry.start).getTime();\r\n  const end = new Date(entry.end).getTime();\r\n\r\n  if (isNaN(start) || isNaN(end)) return '0h 0m';\r\n\r\n  const diffInMinutes = Math.floor((end - start) / (1000 * 60));\r\n  const hours = Math.floor(diffInMinutes / 60);\r\n  const minutes = diffInMinutes % 60;\r\n\r\n  return `${hours}h ${minutes}m`;\r\n}\r\n\r\n\r\nconst props = defineProps<{ entries: any[]; period: any; totalHours: any, totalHoursNotForm: any; isSubmit: boolean ;isApproved: boolean }>()\r\nconst entries = ref(props.entries)\r\nfunction formatDate(date: string) {\r\n  return new Date(date).toLocaleDateString('en-US', {\r\n    weekday: 'long',\r\n    year: 'numeric',\r\n    month: 'long',\r\n    day: '2-digit'\r\n  })\r\n}\r\n\r\nfunction goBack() {\r\n  window.history.back();\r\n}\r\n\r\nfunction formatDate2(dateStr: string) {\r\n  const date = new Date(dateStr)\r\n  return date.toLocaleDateString('en-US', {\r\n    month: 'long',\r\n    day: 'numeric',\r\n    year: 'numeric'\r\n  })\r\n}\r\nconst formattedFrom = computed(() => formatDate2(props.period.from))\r\nconst formattedTo = computed(() => formatDate2(props.period.to))\r\nconst form = ref({\r\n  date_start: props.period.from.split('T')[0],\r\n  date_end: props.period.to.split('T')[0],\r\n  hours: props.totalHoursNotForm,\r\n})\r\n\r\n\r\nconst submit = async () => {\r\n  if (!props.isSubmit) {\r\n\r\n    await axios.post('/api/time/submit', form.value)\r\n    // load()\r\n    console.log('is unSubmit');\r\n  } else {\r\n    await axios.post('/api/time/unsubmit', form.value)\r\n\r\n    console.log('isSubmit');\r\n  }\r\n  goBack();\r\n\r\n}\r\nconst load = async () => {\r\n  window.location.reload();\r\n\r\n}\r\n\r\nfunction formatTime(dateString) {\r\n  return dateString ? dayjs(dateString).format('hh:mm:ss A') : '';\r\n}\r\nonMounted(() => {\r\n  // load();\r\n  console.log(entries);\r\n  openModal.value = true; // ðŸ‘ˆ open modal when component is mounted\r\n});\r\nconst submitClass = !props.isSubmit ? ' px-4 py-2 bg-green-600 text-white rounded' : ' px-4 py-2 bg-red-600 text-white rounded';\r\n</script>\r\n\r\n<template>\r\n  <AppLayout title=\"Dashboard\" data-testid=\"dashboard_view\">\r\n    <MainContainer class=\"pt-5 sm:pt-8 pb-4 sm:pb-6 border-b border-default-background-separator\">\r\n      <TimeTracker @change=\"refreshDashboardData\" />\r\n    </MainContainer>\r\n\r\n    <MainContainer\r\n      class=\"grid gap-5 sm:gap-6 grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 pt-3 sm:pt-5 pb-4 sm:pb-6 border-b border-default-background-separator items-stretch\">\r\n\r\n      <div v-if=\"openModal\" @click.self=\"goBack\" class=\"fixed inset-0 z-50 flex items-center justify-center\"\r\n        style=\"background-color: rgba(0,0,0,0.8);\">\r\n\r\n        <!-- Modal -->\r\n        <div class=\" my-1 p-5 border-2 \" style=\"width: 55%;\">\r\n          <div class=\"col-span-full my-1 py-1\">\r\n            <h2 class=\"text-lg font-semibold mb-1\">My Entries</h2>\r\n            <div class=\"text-md mb-2\">{{ formattedFrom }} - {{ formattedTo }}</div>\r\n            <div class=\"max-h-20 overflow-y-scroll \" style=\"max-height: 50vh;\">\r\n              <div v-for=\"(entries, date2) in entries\" :key=\"date2\" class=\"mt-4 mb-4 border\">\r\n                <h2 class=\"font-semibold text-md py-2 px-3 bg-gray-900 text-gray-300\">{{ formatDate(date2) }}</h2>\r\n\r\n                <ul class=\"\">\r\n                  <li v-for=\"entry in entries\" :key=\"entry.id\" class=\"flex flex-row px-3 rounded border py-2\">\r\n\r\n                    <div class=\"basis-64 flex content-center\">\r\n                      {{ formatTime(entry.start) }} - {{ formatTime(entry.end) }}\r\n                    </div>\r\n                    <div class=\"basis-64 flex content-center\">\r\n                      {{ duration(entry) }} - {{ entry.description || 'No description' }}\r\n                    </div>\r\n                    <div class=\"basis-64\">\r\n\r\n                      <ProjectBadge v-if=\"entry.project\" :color=\"entry.project.color\" :size=\"'large'\" :border=\"true\"\r\n                        :class=\"'focus:border-border-tertiary w-full focus:outline-0 focus:bg-card-background-separator min-w-0 relative '\r\n                          \">\r\n\r\n                        <div class=\"flex items-center lg:space-x-1 min-w-0\">\r\n                          <span class=\"whitespace-nowrap text-xs lg:text-sm\">\r\n                            {{ entry.project.name }}\r\n                          </span>\r\n                          <ChevronRightIcon v-if=\"entry.task\" class=\"w-4 lg:w-5 text-text-secondary shrink-0\">\r\n                          </ChevronRightIcon>\r\n                          <div v-if=\"entry.task\" class=\"min-w-0 shrink text-xs lg:text-sm truncate\">\r\n                            {{ entry.task.name }}\r\n                          </div>\r\n                        </div>\r\n                      </ProjectBadge>\r\n                    </div>\r\n                    <div class=\"basis-64 overflow-hidden\">\r\n                      <div v-if=\"entry.tags.length > 0\" class=\" w-full\">\r\n                        <TagBadge class=\"truncate text-ellipsis overflow-hidden whitespace-nowrap\"\r\n                          :border=\"false\" size=\"large\"\r\n                          :name=\"entry.tags.map((tag: Tag) => tag.name).join(', ')\" />\r\n                      </div>\r\n                    </div>\r\n\r\n\r\n                  </li>\r\n                </ul>\r\n              </div>\r\n\r\n            </div>\r\n\r\n            <div\r\n              class=\" text-muted-foreground text-sm bold text-text-primary font-semibold text-sm lg:text-base flex items-center space-x-2 lg:space-x-2.5\">\r\n              <component :is=\"ClockIcon\" v-if=\"ClockIcon\" class=\"w-5 lg:w-4 text-icon-default mr-2\"></component>\r\n              <div>{{ props.totalHours }}</div>\r\n            </div>\r\n          </div>\r\n          <form @submit.prevent=\"submit\" class=\"space-y-4 w-full\">\r\n            <div class=\"flex w-full items-center space-x-2 lg:space-x-2.5\">\r\n\r\n              <Button @click.prevent=\"goBack\" class=\"px-4 py-2 bg-blue-600 text-white rounded\">\r\n                Close\r\n              </Button>\r\n              <Button v-if=\"!props.isApproved\" type=\"submit\" :class=\"submitClass\">{{ props.isSubmit ? 'Unsubmit' :\r\n                'Submit' }}</Button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n\r\n    </MainContainer>\r\n  </AppLayout>\r\n</template>\r\n"],"names":["props","__props","_createBlock","_unref","Primitive","as","asChild","_normalizeClass","cn","buttonVariants","variant","size","_renderSlot","_ctx","queryClient","useQueryClient","usePage","refreshDashboardData","openModal","ref","duration","entry","start","end","diffInMinutes","hours","minutes","entries","formatDate","date","goBack","formatDate2","dateStr","formattedFrom","computed","formattedTo","form","submit","axios","formatTime","dateString","dayjs","onMounted","submitClass","AppLayout","_createVNode","MainContainer","TimeTracker","_createElementBlock","_createElementVNode","_hoisted_1","_hoisted_2","_cache","_hoisted_3","_toDisplayString","_hoisted_4","_openBlock","_Fragment","_renderList","date2","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","ProjectBadge","_hoisted_10","_hoisted_11","ChevronRightIcon","_hoisted_12","_hoisted_13","_hoisted_14","TagBadge","tag","_hoisted_15","ClockIcon","_resolveDynamicComponent","_hoisted_16","Button","_createTextVNode"],"mappings":"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"}