import{M as R}from"./MainContainer-DAB7AmGD.js";import{g as $e,P as Ee,S as Te,B as je,D as Ve,x as Ce,$ as he,c as Be,E as Pe,_ as Ue}from"./AppLayout.vue_vue_type_script_setup_true_lang-7v21bPMn.js";import{_ as Fe}from"./PageTitle.vue_vue_type_script_setup_true_lang-DVaC2uzI.js";import{_ as Ae,a as De,b as ze,c as _,d as Ne,e as qe,f as Me,g as Ie}from"./ReportingExportModal.vue_vue_type_script_setup_true_lang-Djlvhmo0.js";import{B as Le}from"./BillableIcon-BlL7cW2e.js";import{h as j,g as P}from"./time-DR3Bm2fi.js";import{d as Oe,r as m,s as x,l as J,v as Qe,B as Re,c as U,o as c,w as s,b as r,a as n,u as a,G as K,e as w,f as Je,F,h as G,g as Ke,t as Ge}from"./app-CZLkYVhz.js";import{_ as He}from"./TagDropdown.vue_vue_type_script_setup_true_lang-fidraWsZ.js";import{b as We,u as Xe,a as H}from"./notification-BrLDF-00.js";import{_ as Ye}from"./SelectDropdown.vue_vue_type_script_setup_true_lang-1bxQg4o6.js";import{u as W}from"./init-DIMnQ95t.js";import{d as X}from"./index-CHolqtoz.js";import{_ as Ze,a as et}from"./TimeEntryMassActionRow.vue_vue_type_script_setup_true_lang-Alpy8ht_.js";import{u as Y,a as Z}from"./useCurrentTimeEntry-CruyZJNI.js";import{c as tt,a as ee,b as at,u as te}from"./useMembers-B2Kv7mzm.js";import{g as ae}from"./money-BufCQq2I.js";import{u as rt}from"./useQuery-QapR65Yu.js";import{g as A,a as it}from"./useUser-Dc3_Hjqo.js";import{_ as st}from"./ReportingTabNavbar.vue_vue_type_script_setup_true_lang-DBUWeKjm.js";import{i as re}from"./billing-F8TVwX2K.js";import{q as ie,z as ot}from"./permissions-hl9spDHx.js";import{a as lt}from"./UserCircleIcon-B_03lMym.js";import{r as nt}from"./UserGroupIcon-DEClCgLE.js";import{r as se}from"./FolderIcon-BBOgs1tQ.js";import{r as mt}from"./CheckCircleIcon-ByT7Dbrk.js";import{r as ut}from"./TagIcon-D32GhY_O.js";import{r as ct}from"./ClockIcon-DtFwBiYn.js";import{r as dt,a as pt,b as vt}from"./ChevronLeftIcon-BXTEnYvV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-2TV_nqEm.js";import"./utils-DLNr0s0q.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-DKIr8CEw.js";import"./useOrganization-Dnx8kCk3.js";import"./utc-YQln_hJX.js";/* empty css                                                                             */import"./DialogModal.vue_vue_type_script_setup_true_lang-Dn6gUihL.js";import"./Modal.vue_vue_type_script_setup_true_lang-DiIZ2Ob1.js";import"./PrimaryButton.vue_vue_type_script_setup_true_lang-DGqi3YE0.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CAmSBxXF.js";import"./SecondaryButton.vue_vue_type_script_setup_true_lang-iS1Fl1UI.js";import"./theme-DlEllDdR.js";import"./UpgradeModal.vue_vue_type_script_setup_true_lang-DX0vhlsO.js";import"./MultiselectDropdown.vue_vue_type_script_setup_true_lang-Vdr6fO98.js";import"./MultiselectDropdownItem.vue_vue_type_script_setup_true_lang-DfGNKO5q.js";import"./Badge.vue_vue_type_script_setup_true_lang-Bn80q8dA.js";import"./usePrimitiveElement-DVmz0I4p.js";import"./Collection-Ddu0RjBR.js";import"./useLocale-BQy7zCNL.js";import"./createLucideIcon-DWD2E6Wp.js";import"./TagCreateModal.vue_vue_type_script_setup_true_lang-JZMNiY85.js";import"./TextInput.vue_vue_type_script_setup_true_lang-DUXudii_.js";import"./component-CexCnHe5.js";import"./TimeTrackerProjectTaskDropdown.vue_vue_type_script_setup_true_lang-Bx-SG6KH.js";import"./DatePicker-DmIk6-p1.js";import"./ProjectDropdownItem.vue_vue_type_script_setup_true_lang-kZ0urNkA.js";import"./ProjectBadge.vue_vue_type_script_setup_true_lang-CJeOBiho.js";import"./ProjectCreateModal.vue_vue_type_script_setup_true_lang-BfIlDPot.js";import"./color-NTCrcshl.js";import"./ProjectEditBillableSection.vue_vue_type_script_setup_true_lang-BtqEk6mW.js";import"./InputLabel.vue_vue_type_script_setup_true_lang-DP24QN7l.js";import"./BillableRateInput.vue_vue_type_script_setup_true_lang-B3OqHB-h.js";import"./clamp-CUCcq9G3.js";import"./PlusIcon-gin79_-P.js";import"./BillableToggleButton.vue_vue_type_script_setup_true_lang-9IV1xJ9S.js";import"./TagBadge.vue_vue_type_script_setup_true_lang-rGtwGI6K.js";import"./TimeEntryRowDurationInput.vue_vue_type_script_setup_true_lang-G0TwUc7C.js";import"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BgJhjCYQ.js";import"./useTypeahead-DuqX-vkx.js";import"./RovingFocusGroup-j8ihdqB0.js";import"./Checkbox.vue_vue_type_script_setup_true_lang-BTLhb63T.js";import"./PencilSquareIcon-krbQY_ys.js";import"./TabBar.vue_vue_type_script_setup_true_lang-D5JkrlW4.js";const ft={class:"flex items-center space-x-3 sm:space-x-6"},gt={class:"py-2.5 w-full border-b sticky top-16 z-10 dark:border-[#3F4961] dark:bg-[#171E31]"},yt={class:"flex flex-wrap items-center space-y-2 sm:space-y-0 space-x-4"},bt={class:"w-full relative"},_t={key:0},xt={class:"text-center pt-12"},wt={class:"pr-2 flex items-center space-x-1 border-r dark:border-[#3F4961] dark:text-[#BFC7D6] hover:dark:text-gray-100 mr-1"},kt={class:"!ml-2 pl-2 flex items-center space-x-1 border-l dark:border-[#3F4961]"},V=15,Oa=Oe({__name:"ReportingDetailed",setup(St){const k=X("reporting-start-date",j(P()().format()).subtract(14,"d").format()),S=X("reporting-end-date",j(P()().format()).format()),d=m([]),p=m([]),v=m([]),f=m([]),g=m([]),y=m(null),{members:oe}=x(tt()),$=m(1);function D(){return{...{start:j(k.value).startOf("day").utc().format(),end:j(S.value).endOf("day").utc().format(),active:"false",limit:V,offset:$.value*V-V},member_id:ot()?void 0:it(),member_ids:v.value.length>0?v.value:void 0,project_ids:p.value.length>0?p.value:void 0,task_ids:f.value.length>0?f.value:void 0,client_ids:g.value.length>0?g.value:void 0,tag_ids:d.value.length>0?d.value:void 0,billable:y.value!==null?y.value:void 0}}const z=Y(),{currentTimeEntry:le}=x(z),{setActiveState:ne,startLiveTimer:me}=z,{handleApiRequestNotifications:ue}=We(),{createTimeEntry:ce,updateTimeEntry:de,updateTimeEntries:pe}=Z(),{tags:C}=x(W()),{data:b}=rt({queryKey:["timeEntry","detailed-report"],enabled:!!A(),queryFn:()=>H.getTimeEntries({params:{organization:A()||""},queries:{...D()}})}),ve=J(()=>{var i,t;return((t=(i=b==null?void 0:b.value)==null?void 0:i.meta)==null?void 0:t.total)??1}),fe=Z();async function N(i){await fe.deleteTimeEntries(i),o.value=[],await l()}const E=J(()=>{var i;return((i=b==null?void 0:b.value)==null?void 0:i.data)||[]});Qe(async()=>{await l()});const ge=ee(),{projects:q}=x(ge),ye=at(),{tasks:M}=x(ye),be=te(),{clients:I}=x(be),o=m([]),h=m(!1),L=m(null);async function B(i){return await W().createTag(i)}async function O(i){return await ee().createProject(i)}async function Q(i){return await te().createClient(i)}async function _e(i){le.value.id&&await ne(!1),await ce({project_id:i.project_id,task_id:i.task_id,start:P().utc().format(),end:null,billable:i.billable,description:i.description}),me(),l(),Y().fetchCurrentTimeEntry()}const xe=Xe();async function l(){await xe.invalidateQueries({queryKey:["timeEntry","detailed-report"]})}Re($,()=>{l()});function we(){N(o.value)}async function ke(){o.value=[],await l()}async function Se(i){const t=A();if(t){const e=await ue(()=>H.exportTimeEntries({params:{organization:t},queries:{...D(),format:i}}),"Export successful","Export failed");e!=null&&e.download_url&&(h.value=!0,L.value=e.download_url)}}return(i,t)=>(c(),U(Ue,{title:"Reporting","data-testid":"reporting_view",class:""},{default:s(()=>[r(Ae,{show:h.value,"onUpdate:show":t[0]||(t[0]=e=>h.value=e),"export-url":L.value},null,8,["show","export-url"]),r(R,{class:"py-3 sm:py-5 sticky top-0 z-10 border-b dark:border-[#3F4961] dark:bg-[#171E31] flex justify-between items-center"},{default:s(()=>[n("div",ft,[r(Fe,{icon:a(lt),title:"Reporting"},null,8,["icon"]),r(st,{active:"detailed"})]),r(De,{download:Se})]),_:1}),n("div",gt,[r(R,{class:"sm:flex space-y-4 sm:space-y-0 justify-between"},{default:s(()=>[n("div",yt,[t[12]||(t[12]=n("div",{class:"text-sm font-medium"},"Filters",-1)),r(ze,{modelValue:v.value,"onUpdate:modelValue":t[1]||(t[1]=e=>v.value=e),onSubmit:l},{trigger:s(()=>[r(_,{count:v.value.length,active:v.value.length>0,title:"Members",icon:a(nt)},null,8,["count","active","icon"])]),_:1},8,["modelValue"]),r(Ne,{modelValue:p.value,"onUpdate:modelValue":t[2]||(t[2]=e=>p.value=e),onSubmit:l},{trigger:s(()=>[r(_,{count:p.value.length,active:p.value.length>0,title:"Projects",icon:a(se)},null,8,["count","active","icon"])]),_:1},8,["modelValue"]),r(qe,{modelValue:f.value,"onUpdate:modelValue":t[3]||(t[3]=e=>f.value=e),onSubmit:l},{trigger:s(()=>[r(_,{count:f.value.length,active:f.value.length>0,title:"Tasks",icon:a(mt)},null,8,["count","active","icon"])]),_:1},8,["modelValue"]),r(Me,{modelValue:g.value,"onUpdate:modelValue":t[4]||(t[4]=e=>g.value=e),onSubmit:l},{trigger:s(()=>[r(_,{count:g.value.length,active:g.value.length>0,title:"Clients",icon:a(se)},null,8,["count","active","icon"])]),_:1},8,["modelValue"]),r(He,{modelValue:d.value,"onUpdate:modelValue":t[5]||(t[5]=e=>d.value=e),"create-tag":B,tags:a(C),onSubmit:l},{trigger:s(()=>[r(_,{count:d.value.length,active:d.value.length>0,title:"Tags",icon:a(ut)},null,8,["count","active","icon"])]),_:1},8,["modelValue","tags"]),r(Ye,{modelValue:y.value,"onUpdate:modelValue":t[6]||(t[6]=e=>y.value=e),"get-key-from-item":e=>e.value,"get-name-for-item":e=>e.label,items:[{label:"Both",value:null},{label:"Billable",value:"true"},{label:"Non Billable",value:"false"}],onChanged:l},{trigger:s(()=>[r(_,{active:y.value!==null,title:y.value==="false"?"Non Billable":"Billable",icon:Le},null,8,["active","title"])]),_:1},8,["modelValue","get-key-from-item","get-name-for-item"])]),n("div",null,[r(Ie,{start:a(k),"onUpdate:start":t[7]||(t[7]=e=>K(k)?k.value=e:null),end:a(S),"onUpdate:end":t[8]||(t[8]=e=>K(S)?S.value=e:null),onSubmit:l},null,8,["start","end"])])]),_:1})]),r(Ze,{"selected-time-entries":o.value,"can-create-project":a(ie)(),"enable-estimated-time":a(re)(),"delete-selected":we,"all-selected":o.value.length===E.value.length,projects:a(q),tasks:a(M),tags:a(C),currency:a(ae)(),clients:a(I),"update-time-entries":e=>a(pe)(o.value.map(u=>u.id),e),"create-project":O,"create-client":Q,"create-tag":B,onSubmit:ke,onSelectAll:t[9]||(t[9]=e=>o.value=[...E.value]),onUnselectAll:t[10]||(t[10]=e=>o.value=[])},null,8,["selected-time-entries","can-create-project","enable-estimated-time","all-selected","projects","tasks","tags","currency","clients","update-time-entries"]),n("div",bt,[(c(!0),w(F,null,G(E.value,e=>(c(),w("div",{key:e.id},[r(et,{selected:o.value.includes(e),"can-create-project":a(ie)(),"create-client":Q,"create-project":O,"enable-estimated-time":a(re)(),projects:a(q),tasks:a(M),tags:a(C),clients:a(I),"create-tag":B,"update-time-entry":a(de),"on-start-stop-click":()=>_e(e),"delete-time-entry":()=>N([e]),currency:a(ae)(),members:a(oe),"show-date":"","show-member":"","time-entry":e,onSelected:u=>o.value.push(e),onUnselected:u=>o.value=o.value.filter(T=>T.id!==e.id)},null,8,["selected","can-create-project","enable-estimated-time","projects","tasks","tags","clients","update-time-entry","on-start-stop-click","delete-time-entry","currency","members","time-entry","onSelected","onUnselected"])]))),128)),E.value.length===0?(c(),w("div",_t,[n("div",xt,[r(a(ct),{class:"w-8 text-icon-default inline pb-2"}),t[13]||(t[13]=n("h3",{class:"text-text-primary font-semibold"}," No time entries found ",-1)),t[14]||(t[14]=n("p",{class:"pb-5"}," Adjust the filters to see more time entries! ",-1))])])):Je("",!0)]),r(a($e),{page:$.value,"onUpdate:page":t[11]||(t[11]=e=>$.value=e),total:ve.value,"items-per-page":V,class:"flex justify-center items-center py-8","sibling-count":1,"show-edges":""},{default:s(()=>[r(a(Ee),{class:"flex items-center space-x-1 relative dark:text-[#BFC7D6]"},{default:s(({items:e})=>[n("div",wt,[r(a(Te),{class:"navigation-item"},{default:s(()=>[r(a(dt),{class:"w-4"})]),_:1}),r(a(je),{class:"mr-4 navigation-item"},{default:s(()=>[r(a(pt),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1})]),(c(!0),w(F,null,G(e,(u,T)=>(c(),w(F,null,[u.type==="page"?(c(),U(a(Ve),{key:T,class:"pagination-item hover:dark:text-gray-100",value:u.value},{default:s(()=>[Ke(Ge(u.value),1)]),_:2},1032,["value"])):(c(),U(a(Ce),{key:u.type,index:T,class:"PaginationEllipsis"},{default:s(()=>t[15]||(t[15]=[n("div",{class:"px-2"},"â€¦",-1)])),_:2,__:[15]},1032,["index"]))],64))),256)),n("div",kt,[r(a(he),{class:"navigation-item"},{default:s(()=>[r(a(Be),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1}),r(a(Pe),{class:"navigation-item"},{default:s(()=>[r(a(vt),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1})])]),_:1})]),_:1},8,["page","total"])]),_:1}))}});export{Oa as default};
//# sourceMappingURL=ReportingDetailed-GvMPBC4C.js.map
