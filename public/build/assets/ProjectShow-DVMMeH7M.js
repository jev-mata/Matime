import{M as pe,a as Be}from"./MainContainer-WpbdfkDp.js";import{b as ze,U as De,q as Ie,G as Ae,Q as Re,t as Se,c as Ee,d as Fe,_ as qe}from"./AppLayout.vue_vue_type_script_setup_true_lang-BfXcHqGL.js";import{_ as B}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-DBBC7wMi.js";import{a as xe,b as A,g as L,d as ke}from"./useMembers-D1lZTqLC.js";import{h as M,o as m,f as e,d as P,x as z,r as x,y as D,A as I,c as N,Q as Ze,D as te,v as Ke,b as w,w as l,j as $,u as t,e as o,z as H,i as se,F as R,t as V,l as g,n as Q,B as G,E as Le,g as ce,q as Oe,s as He,L as Qe}from"./app-Dzd5B06R.js";import{_ as je}from"./TextInput.vue_vue_type_script_setup_true_lang-Cw992cSP.js";import{_ as J}from"./DialogModal.vue_vue_type_script_setup_true_lang-Cdp4pUKI.js";import{_ as W}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-CWUYAS8h.js";import{u as X}from"./index-NRw1C4BU.js";import{_ as Ge,a as Je}from"./ProjectDropdownItem.vue_vue_type_script_setup_true_lang-wvL1v9C2.js";import{a as E,b as We}from"./notification-Cqm5OIAz.js";import{g as Xe}from"./BillableIcon-C1VJddF3.js";import{U as Ye,r as et}from"./component-D2dmHEOx.js";import{_ as ge}from"./ProjectEditBillableSection.vue_vue_type_script_setup_true_lang-DqRZf2t1.js";import{i as ae}from"./billing-BrKRBYHJ.js";import{m as fe,n as ye,o as ee,p as be,q as tt}from"./permissions-Cy8U4TFG.js";import{_ as $e,a as Me,b as F,r as he,c as Pe}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-OCyRpCcO.js";import{r as oe}from"./PencilSquareIcon-C4w9DETU.js";import{r as le}from"./CheckCircleIcon-Cls-9biQ.js";import{_ as Te,T as Ce}from"./TableHeading-CHDXaWC7.js";import{_ as st,a as at,b as ot}from"./ProjectEditModal.vue_vue_type_script_setup_true_lang-DSdvo0ZW.js";import{a as lt}from"./time-D8Z5bJ3P.js";import{r as rt}from"./PlusCircleIcon-DmKTIJnt.js";import{r as O}from"./PlusIcon-DXN6bajS.js";import{_ as ve}from"./CardTitle.vue_vue_type_script_setup_true_lang-CyznVp_q.js";import{C as _e}from"./Card-C6IHIwAo.js";import{f as re}from"./money-042SSt8Q.js";import{r as nt,c as it,_ as ut}from"./format-CIewDkOS.js";import{_ as Ve}from"./BillableRateInput.vue_vue_type_script_setup_true_lang-B9u_Q2bT.js";import{g as Z}from"./money-DE8Cj37t.js";import{_ as dt}from"./BillableRateModal.vue_vue_type_script_setup_true_lang-BNQCoov9.js";import{_ as mt}from"./InputLabel.vue_vue_type_script_setup_true_lang-BJprejo3.js";import{_ as pt,a as we}from"./TabBar.vue_vue_type_script_setup_true_lang-goXlkxJT.js";import{a as Y}from"./SelectDropdown.vue_vue_type_script_setup_true_lang-CaZ4i_G-.js";import"./utc-BCs3FwGo.js";import{r as ct}from"./FolderIcon-DWxb3Ngj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-CCwwB18o.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-BJPjJVKi.js";import"./useOrganization-fnI1XVs5.js";import"./init-Ddj1H8ev.js";import"./theme-CJTqdCW4.js";import"./useQuery-BH-Arugy.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CcpHAXFE.js";import"./ClockIcon-CYfSOCq5.js";import"./Modal.vue_vue_type_script_setup_true_lang-s_ZkTFQt.js";import"./Collection-DUsfnDCk.js";import"./usePrimitiveElement-Dt-Gdg0c.js";import"./useTypeahead-DT7HEzVy.js";import"./RovingFocusGroup-C65J4aAO.js";import"./UpgradeModal.vue_vue_type_script_setup_true_lang-BsrvLgcD.js";import"./useLocale-CRrU4gHp.js";import"./clamp-D21Fl2C-.js";import"./createLucideIcon-CLDLlRIF.js";import"./ArrowTopRightOnSquareIcon-BjqQdrkl.js";function ft(_,f){return m(),M("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{"fill-rule":"evenodd",d:"M8.25 6.75a3.75 3.75 0 1 1 7.5 0 3.75 3.75 0 0 1-7.5 0ZM15.75 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM2.25 9.75a3 3 0 1 1 6 0 3 3 0 0 1-6 0ZM6.31 15.117A6.745 6.745 0 0 1 12 12a6.745 6.745 0 0 1 6.709 7.498.75.75 0 0 1-.372.568A12.696 12.696 0 0 1 12 21.75c-2.305 0-4.47-.612-6.337-1.684a.75.75 0 0 1-.372-.568 6.787 6.787 0 0 1 1.019-4.38Z","clip-rule":"evenodd"}),e("path",{d:"M5.082 14.254a8.287 8.287 0 0 0-1.308 5.135 9.687 9.687 0 0 1-1.764-.44l-.115-.04a.563.563 0 0 1-.373-.487l-.01-.121a3.75 3.75 0 0 1 3.57-4.047ZM20.226 19.389a8.287 8.287 0 0 0-1.308-5.135 3.75 3.75 0 0 1 3.57 4.047l-.01.121a.563.563 0 0 1-.373.486l-.115.04c-.567.2-1.156.349-1.764.441Z"})])}const bt={key:0,class:"bg-card-background-active"},vt={class:"flex space-x-3 items-center px-4 py-3 text-xs font-medium border-t rounded-b-lg border-card-background-separator"},_t=P({__name:"ProjectDropdown",props:z({border:{type:Boolean,default:!0}},{modelValue:{default:null},modelModifiers:{}}),emits:z(["update:modelValue","changed"],["update:modelValue"]),setup(_,{emit:f}){const a=x(""),i=x(null),n=D(_,"modelValue"),s=x(!1),d=xe(),u=f,{projects:p}=I(d),r=x(null),b=N(()=>p.value.filter(j=>{var h,y;return j.name.toLowerCase().includes(((y=(h=a.value)==null?void 0:h.toLowerCase())==null?void 0:y.trim())||"")})),c=Ze();async function k(){if(a.value.length>0&&b.value.length===0){const j=await E.createProject({name:a.value,color:Xe(),is_billable:!1},{params:{organization:c.props.auth.user.current_team_id}});p.value.unshift(j.data),n.value=j.data.id,a.value="",s.value=!1}}te(s,j=>{j&&(Ke(()=>{var h,y;(y=(h=i.value)==null?void 0:h.$el)==null||y.focus()}),p.value.sort(h=>n.value===h.id?-1:1))});const U=N(()=>p.value.find(j=>j.id===n.value));function C(j){return n.value===j.id}const v=N(()=>{var j;return((j=U.value)==null?void 0:j.name)||"No Project"}),T=N(()=>{var j;return((j=U.value)==null?void 0:j.color)||"var(--theme-color-icon-default)"});function K(j){n.value=j.id,u("changed")}return(j,h)=>(m(),w(ze,{modelValue:s.value,"onUpdate:modelValue":h[1]||(h[1]=y=>s.value=y),align:"start",width:"60"},{trigger:l(()=>[o(Ge,{ref_key:"projectDropdownTrigger",ref:r,color:T.value,size:"xlarge",border:j.border,tag:"button",name:v.value,class:"focus:border-input-border-active bg-input-background focus:outline-0 focus:bg-card-background-separator hover:bg-card-background-separator"},null,8,["color","border","name"])]),content:l(()=>[s.value?(m(),w(t(Ye),{key:0,options:{immediate:!0,allowOutsideClick:!0}},{default:l(()=>[o(t(De),{"search-term":a.value,"onUpdate:searchTerm":h[0]||(h[0]=y=>a.value=y),open:s.value,"model-value":U.value,class:"relative","onUpdate:modelValue":K},{default:l(()=>[o(t(Ie),null,{default:l(()=>[o(t(Ae),{ref_key:"searchInput",ref:i,class:"bg-card-background border-0 placeholder-muted text-sm text-text-primary py-2.5 focus:ring-0 border-b border-card-background-separator focus:border-card-background-separator w-full",placeholder:"Search for a project...",onKeydown:H(k,["enter"])},null,512)]),_:1}),o(t(Re),null,{default:l(()=>[o(t(Se),{ref:"dropdownViewport",class:"w-60 max-h-60 overflow-y-scroll"},{default:l(()=>[(m(!0),M(R,null,se(b.value,y=>(m(),w(t(Ee),{key:y.id,value:y,class:"data-[highlighted]:bg-card-background-active","data-project-id":y.id},{default:l(()=>[o(Je,{selected:C(y),color:y.color,name:y.name},null,8,["selected","color","name"])]),_:2},1032,["value","data-project-id"]))),128)),a.value.length>0&&b.value.length===0?(m(),M("div",bt,[e("div",vt,[o(t(et),{class:"w-5 flex-shrink-0"}),e("span",null,'Add "'+V(a.value)+'" as a new Project',1)])])):$("",!0)]),_:1},512)]),_:1})]),_:1},8,["search-term","open","model-value"])]),_:1})):$("",!0)]),_:1},8,["modelValue"]))}}),wt={class:"flex items-center space-x-4"},xt={class:"col-span-6 sm:col-span-4 flex-1"},kt={class:"col-span-6 sm:col-span-4"},Ue=P({__name:"TaskCreateModal",props:z({projectId:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(_){const{createTask:f}=A(),a=D(_,"show"),i=x(!1),n=x(""),s=x(null),d=_,u=x(d.projectId);te(()=>d.projectId,b=>{u.value=b});async function p(){await f({name:n.value,project_id:u.value,estimated_time:s.value}),a.value=!1,n.value=""}const r=x(null);return X(r,{initialValue:!0}),(b,c)=>(m(),w(J,{closeable:"",show:a.value,onClose:c[6]||(c[6]=k=>a.value=!1)},{title:l(()=>c[7]||(c[7]=[e("div",{class:"flex space-x-2"},[e("span",null," Create Task ")],-1)])),content:l(()=>[e("div",wt,[e("div",xt,[o(je,{id:"taskName",ref_key:"taskNameInput",ref:r,modelValue:n.value,"onUpdate:modelValue":c[0]||(c[0]=k=>n.value=k),type:"text",placeholder:"Task Name",class:"block w-full",required:"",autocomplete:"taskName",onKeydown:c[1]||(c[1]=H(k=>p(),["enter"]))},null,8,["modelValue"])]),e("div",kt,[o(_t,{modelValue:u.value,"onUpdate:modelValue":c[2]||(c[2]=k=>u.value=k)},null,8,["modelValue"])])]),t(ae)()?(m(),w(ge,{key:0,modelValue:s.value,"onUpdate:modelValue":c[3]||(c[3]=k=>s.value=k),onSubmit:c[4]||(c[4]=k=>p())},null,8,["modelValue"])):$("",!0)]),footer:l(()=>[o(B,{onClick:c[5]||(c[5]=k=>a.value=!1)},{default:l(()=>c[8]||(c[8]=[g(" Cancel ")])),_:1,__:[8]}),o(W,{class:Q(["ms-3",{"opacity-25":i.value}]),disabled:i.value,onClick:p},{default:l(()=>c[9]||(c[9]=[g(" Create Task ")])),_:1,__:[9]},8,["class","disabled"])]),_:1},8,["show"]))}}),jt=["aria-label"],gt={key:0},yt={key:1},$t=P({__name:"TaskMoreOptionsDropdown",props:{task:{}},emits:["delete","edit","done"],setup(_,{emit:f}){const a=f,i=_;return(n,s)=>(m(),w(t($e),null,{default:l(()=>[o(t(Me),{"as-child":""},{default:l(()=>[e("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Task "+i.task.name},s[3]||(s[3]=[e("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,jt)]),_:1}),o(t(Pe),{class:"min-w-[150px]",align:"end"},{default:l(()=>[t(fe)()?(m(),w(t(F),{key:0,"aria-label":"Edit Task "+i.task.name,"data-testid":"task_edit",class:"flex items-center space-x-3 cursor-pointer",onClick:s[0]||(s[0]=d=>a("edit"))},{default:l(()=>[o(t(oe),{class:"w-5 text-icon-active"}),s[4]||(s[4]=e("span",null,"Edit",-1))]),_:1,__:[4]},8,["aria-label"])):$("",!0),t(fe)()?(m(),w(t(F),{key:1,"aria-label":"Mark Task "+i.task.name+" as done",class:"flex items-center space-x-3 cursor-pointer",onClick:s[1]||(s[1]=d=>a("done"))},{default:l(()=>[o(t(le),{class:"w-5 text-icon-active"}),i.task.is_done?(m(),M("span",gt,"Mark as active")):(m(),M("span",yt,"Mark as done"))]),_:1},8,["aria-label"])):$("",!0),t(ye)()?(m(),w(t(F),{key:2,"aria-label":"Delete Task "+i.task.name,"data-testid":"task_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:s[2]||(s[2]=d=>a("delete"))},{default:l(()=>[o(t(he),{class:"w-5"}),s[5]||(s[5]=e("span",null,"Delete",-1))]),_:1,__:[5]},8,["aria-label"])):$("",!0)]),_:1})]),_:1}))}}),Mt={class:"flex items-center space-x-4"},ht={class:"col-span-6 sm:col-span-4 flex-1"},Pt=P({__name:"TaskEditModal",props:z({task:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(_){const{updateTask:f}=A(),a=D(_,"show"),i=x(!1),n=_,s=x({name:n.task.name,estimated_time:n.task.estimated_time});async function d(){await f(n.task.id,s.value),a.value=!1}const u=x(null);return X(u,{initialValue:!0}),(p,r)=>(m(),w(J,{closeable:"",show:a.value,onClose:r[5]||(r[5]=b=>a.value=!1)},{title:l(()=>r[6]||(r[6]=[e("div",{class:"flex space-x-2"},[e("span",null," Update Task ")],-1)])),content:l(()=>[e("div",Mt,[e("div",ht,[o(je,{id:"taskName",ref_key:"taskNameInput",ref:u,modelValue:s.value.name,"onUpdate:modelValue":r[0]||(r[0]=b=>s.value.name=b),type:"text",placeholder:"Task Name",class:"mt-1 block w-full",required:"",autocomplete:"taskName",onKeydown:r[1]||(r[1]=H(b=>d(),["enter"]))},null,8,["modelValue"])])]),t(ae)()?(m(),w(ge,{key:0,modelValue:s.value.estimated_time,"onUpdate:modelValue":r[2]||(r[2]=b=>s.value.estimated_time=b),onSubmit:r[3]||(r[3]=b=>d())},null,8,["modelValue"])):$("",!0)]),footer:l(()=>[o(B,{onClick:r[4]||(r[4]=b=>a.value=!1)},{default:l(()=>r[7]||(r[7]=[g(" Cancel ")])),_:1,__:[7]}),o(W,{class:Q(["ms-3",{"opacity-25":i.value}]),disabled:i.value,onClick:d},{default:l(()=>r[8]||(r[8]=[g(" Update Task ")])),_:1,__:[8]},8,["class","disabled"])]),_:1},8,["show"]))}}),Tt={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},Ct={class:"overflow-ellipsis overflow-hidden"},Vt={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},Ut={key:0},Nt={key:1},Bt={class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},zt={key:2},Dt={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},It={key:1},At={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},Rt=P({__name:"TaskTableRow",props:{task:{}},setup(_){const f=_,a=G("organization");function i(){A().deleteTask(f.task.id)}function n(){A().updateTask(f.task.id,{...f.task,is_done:!f.task.is_done})}const s=x(!1);return(d,u)=>(m(),w(Te,null,{default:l(()=>{var p,r;return[e("div",Tt,[e("span",Ct,V(d.task.name),1)]),e("div",Vt,[d.task.spent_time?(m(),M("span",Ut,V(t(lt)(d.task.spent_time,(p=t(a))==null?void 0:p.interval_format,(r=t(a))==null?void 0:r.number_format)),1)):(m(),M("span",Nt," -- "))]),e("div",Bt,[t(ae)()?d.task.estimated_time?(m(),w(at,{key:1,estimated:d.task.estimated_time,current:d.task.spent_time},null,8,["estimated","current"])):(m(),M("span",zt," -- ")):(m(),w(st,{key:0}))]),e("div",Dt,[d.task.is_done?(m(),M(R,{key:0},[o(t(le),{class:"w-5"}),u[2]||(u[2]=e("span",null,"Done",-1))],64)):(m(),M("span",It,"Active"))]),e("div",At,[t(ye)()?(m(),w($t,{key:0,task:d.task,onDone:n,onEdit:u[0]||(u[0]=b=>s.value=!0),onDelete:i},null,8,["task"])):$("",!0)]),o(Pt,{show:s.value,"onUpdate:show":u[1]||(u[1]=b=>s.value=b),task:d.task},null,8,["show","task"])]}),_:1}))}}),St=P({__name:"TaskTableHeading",setup(_){return(f,a)=>(m(),w(Ce,null,{default:l(()=>a[0]||(a[0]=[e("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Task Name ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Total Time ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Progress ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Status",-1),e("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[e("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),Et={class:"flow-root"},Ft={class:"inline-block min-w-full align-middle"},qt={"data-testid":"task_table",role:"table",class:"grid min-w-full",style:{"grid-template-columns":`1fr minmax(80px, auto) minmax(120px, auto) minmax(
                            50px,
                            auto
                        )
                        80px`}},Zt={key:0,class:"col-span-5 py-24 text-center"},Kt={key:0,class:"pb-5"},Lt=P({__name:"TaskTable",props:{projectId:{},tasks:{}},setup(_){const f=_,a=x(!1);return(i,n)=>(m(),M(R,null,[o(Ue,{show:a.value,"onUpdate:show":n[0]||(n[0]=s=>a.value=s),"project-id":f.projectId},null,8,["show","project-id"]),e("div",Et,[e("div",Ft,[e("div",qt,[o(St),i.tasks.length===0?(m(),M("div",Zt,[o(t(rt),{class:"w-8 text-icon-default inline pb-2"}),n[3]||(n[3]=e("h3",{class:"text-text-primary font-semibold"},"No tasks found",-1)),t(ee)()?(m(),M("p",Kt," Create your first task now! ")):$("",!0),t(ee)()?(m(),w(B,{key:1,icon:t(O),onClick:n[1]||(n[1]=s=>a.value=!0)},{default:l(()=>n[2]||(n[2]=[g("Create your First Task ")])),_:1,__:[2]},8,["icon"])):$("",!0)])):$("",!0),(m(!0),M(R,null,se(i.tasks,s=>(m(),w(Rt,{key:s.id,task:s},null,8,["task"]))),128))])])])],64))}}),q=Le("project-members",()=>{const _=x(null),{handleApiRequestNotifications:f}=We();async function a(u){const p=L();p&&(_.value=await f(()=>E.getProjectMembers({params:{organization:p,project:u}}),void 0,"Failed to fetch project members"))}async function i(u,p){const r=L();r&&(await f(()=>E.createProjectMember(p,{params:{organization:r,project:u}}),"Project member added successfully","Failed to add project member"),await a(u))}async function n(u,p){const r=L();if(r){const b=await f(()=>E.updateProjectMember(p,{params:{organization:r,projectMember:u}}),"Project member updated successfully","Failed to update project member");await a(b.data.project_id)}}async function s(u,p){const r=L();r&&(await f(()=>E.deleteProjectMember(void 0,{params:{organization:r,projectMember:p}}),"Project member removed successfully","Failed to remove project member"),await a(u))}return{projectMembers:N(()=>{var u;return((u=_.value)==null?void 0:u.data)||[]}),fetchProjectMembers:a,createProjectMember:i,deleteProjectMember:s,updateProjectMember:n}}),Ot=["aria-label"],Ht=P({__name:"ProjectMemberMoreOptionsDropdown",props:{projectMember:{}},emits:["delete","edit"],setup(_,{emit:f}){const a=f,i=_,{members:n}=I(ke()),s=N(()=>n.value.find(d=>d.id===i.projectMember.user_id));return(d,u)=>(m(),w(t($e),null,{default:l(()=>[o(t(Me),{"as-child":""},{default:l(()=>{var p;return[e("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Project Member "+((p=s.value)==null?void 0:p.name)},u[2]||(u[2]=[e("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,Ot)]}),_:1}),o(t(Pe),{class:"min-w-[150px]",align:"end"},{default:l(()=>{var p,r;return[o(t(F),{"aria-label":"Edit Project Member "+((p=s.value)==null?void 0:p.name),class:"flex items-center space-x-3 cursor-pointer",onClick:u[0]||(u[0]=ce(b=>a("edit"),["prevent"]))},{default:l(()=>[o(t(oe),{class:"w-5 text-icon-active"}),u[3]||(u[3]=e("span",null,"Edit",-1))]),_:1,__:[3]},8,["aria-label"]),o(t(F),{"aria-label":"Delete Project Member "+((r=s.value)==null?void 0:r.name),"data-testid":"project_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:u[1]||(u[1]=ce(b=>a("delete"),["prevent"]))},{default:l(()=>[o(t(he),{class:"w-5"}),u[4]||(u[4]=e("span",null,"Remove from Team",-1))]),_:1,__:[4]},8,["aria-label"])]}),_:1})]),_:1}))}}),Qt={class:"py-1 text-center"},Gt=P({__name:"ProjectMemberBillableRateModal",props:z({newBillableRate:{},memberName:{}},{show:{default:!1},showModifiers:{},saving:{default:!1},savingModifiers:{}}),emits:z(["submit"],["update:show","update:saving"]),setup(_){const f=D(_,"show"),a=D(_,"saving"),i=G("organization");return(n,s)=>(m(),w(dt,{show:f.value,"onUpdate:show":s[0]||(s[0]=d=>f.value=d),saving:a.value,"onUpdate:saving":s[1]||(s[1]=d=>a.value=d),title:"Update Project Member Billable Rate",onSubmit:s[2]||(s[2]=d=>n.$emit("submit"))},{default:l(()=>{var d,u,p;return[e("p",Qt,[g(" The billable rate of "+V(n.memberName)+" will be updated to ",1),e("strong",null,V(n.newBillableRate?t(re)(n.newBillableRate,t(Z)(),(d=t(i))==null?void 0:d.currency_format,(u=t(i))==null?void 0:u.currency_symbol,(p=t(i))==null?void 0:p.number_format):" the default rate of the project"),1),s[3]||(s[3]=g(". "))]),s[4]||(s[4]=e("p",{class:"py-1 text-center font-semibold max-w-md mx-auto"}," Do you want to update all existing time entries, where the project member billable rate applies as well? ",-1))]}),_:1,__:[4]},8,["show","saving"]))}}),Jt={class:"grid grid-cols-3 items-center space-x-4"},Wt={class:"col-span-3 sm:col-span-2 space-x-2 flex items-center"},Xt={class:"col-span-3 sm:col-span-1 flex-1"},Yt=P({__name:"ProjectMemberEditModal",props:z({projectMember:{},name:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(_){const{updateProjectMember:f}=q(),a=D(_,"show"),i=x(!1),n=_,s=x({billable_rate:n.projectMember.billable_rate}),d=x(!1);async function u(){if(n.projectMember.billable_rate!==s.value.billable_rate){setTimeout(()=>{d.value=!0},0);return}await f(n.projectMember.id,s.value),a.value=!1,s.value={billable_rate:null}}async function p(){await f(n.projectMember.id,s.value),a.value=!1,d.value=!1}te(()=>a.value,b=>{b&&(s.value={billable_rate:n.projectMember.billable_rate})});const r=x(null);return X(r,{initialValue:!0}),(b,c)=>(m(),w(J,{closeable:"",show:a.value,onClose:c[4]||(c[4]=k=>a.value=!1)},{title:l(()=>c[5]||(c[5]=[e("div",{class:"flex space-x-2"},[e("span",null,"Edit Project Member")],-1)])),content:l(()=>[o(Gt,{show:d.value,"onUpdate:show":c[0]||(c[0]=k=>d.value=k),"member-name":n.name,"new-billable-rate":s.value.billable_rate,onClose:c[1]||(c[1]=k=>d.value=!1),onSubmit:p},null,8,["show","member-name","new-billable-rate"]),e("div",Jt,[e("div",Wt,[o(t(nt),{class:"w-4 text-text-secondary"}),e("span",null,V(n.name),1)]),e("div",Xt,[o(mt,{for:"billable_rate",class:"mb-2",value:"Billable Rate"}),o(Ve,{modelValue:s.value.billable_rate,"onUpdate:modelValue":c[2]||(c[2]=k=>s.value.billable_rate=k),currency:t(Z)(),name:"billable_rate",onKeydown:H(u,["enter"])},null,8,["modelValue","currency"])])])]),footer:l(()=>[o(B,{onClick:c[3]||(c[3]=k=>a.value=!1)},{default:l(()=>c[6]||(c[6]=[g("Cancel")])),_:1,__:[6]}),o(W,{class:Q(["ms-3",{"opacity-25":i.value}]),disabled:i.value,onClick:u},{default:l(()=>c[7]||(c[7]=[g(" Update Project Member ")])),_:1,__:[7]},8,["class","disabled"])]),_:1},8,["show"]))}}),es={class:"whitespace-nowrap flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},ts={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},ss={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},as={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium sm:pr-0 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},os=P({__name:"ProjectMemberTableRow",props:{projectMember:{}},setup(_){const f=_,a=G("organization");function i(){q().deleteProjectMember(f.projectMember.project_id,f.projectMember.id)}function n(){u.value=!0}const{members:s}=I(ke()),d=N(()=>s.value.find(p=>p.id===f.projectMember.member_id)),u=x(!1);return(p,r)=>(m(),w(Te,null,{default:l(()=>{var b,c,k,U,C,v;return[o(Yt,{show:u.value,"onUpdate:show":r[0]||(r[0]=T=>u.value=T),name:(b=d.value)==null?void 0:b.name,"project-member":p.projectMember},null,8,["show","name","project-member"]),e("div",es,[e("span",null,V((c=d.value)==null?void 0:c.name),1)]),e("div",ts,V(p.projectMember.billable_rate?t(re)(p.projectMember.billable_rate,t(Z)(),(k=t(a))==null?void 0:k.currency_format,(U=t(a))==null?void 0:U.currency_symbol,(C=t(a))==null?void 0:C.number_format):"--"),1),e("div",ss,V(t(it)(((v=d.value)==null?void 0:v.role)??"")),1),e("div",as,[o(Ht,{"project-member":p.projectMember,onDelete:i,onEdit:n},null,8,["project-member"])])]}),_:1}))}}),ls=P({__name:"ProjectMemberTableHeading",setup(_){return(f,a)=>(m(),w(Ce,null,{default:l(()=>a[0]||(a[0]=[e("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Name ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Billable Rate ",-1),e("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Role",-1),e("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[e("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),rs={class:"grid grid-cols-3 items-center space-x-4"},ns={class:"col-span-3 sm:col-span-2"},is={class:"col-span-3 sm:col-span-1 flex-1"},Ne=P({__name:"ProjectMemberCreateModal",props:z({projectId:{},existingMembers:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(_){const{createProjectMember:f}=q(),a=D(_,"show"),i=x(!1),n=_,s=x({member_id:"",billable_rate:null});async function d(){await f(n.projectId,s.value),a.value=!1,s.value={member_id:"",billable_rate:null}}const u=x(null);return X(u,{initialValue:!0}),(p,r)=>(m(),w(J,{closeable:"",show:a.value,onClose:r[3]||(r[3]=b=>a.value=!1)},{title:l(()=>r[4]||(r[4]=[e("div",{class:"flex space-x-2"},[e("span",null,"Add Project Member")],-1)])),content:l(()=>[e("div",rs,[e("div",ns,[o(ut,{modelValue:s.value.member_id,"onUpdate:modelValue":r[0]||(r[0]=b=>s.value.member_id=b),"hidden-members":n.existingMembers},null,8,["modelValue","hidden-members"])]),e("div",is,[o(Ve,{modelValue:s.value.billable_rate,"onUpdate:modelValue":r[1]||(r[1]=b=>s.value.billable_rate=b),name:"billable_rate",currency:t(Z)()},null,8,["modelValue","currency"])])])]),footer:l(()=>[o(B,{onClick:r[2]||(r[2]=b=>a.value=!1)},{default:l(()=>r[5]||(r[5]=[g("Cancel")])),_:1,__:[5]}),o(W,{class:Q(["ms-3",{"opacity-25":i.value}]),disabled:i.value,onClick:d},{default:l(()=>r[6]||(r[6]=[g(" Add Project Member ")])),_:1,__:[6]},8,["class","disabled"])]),_:1},8,["show"]))}}),us={class:"flow-root"},ds={class:"inline-block min-w-full align-middle"},ms={"data-testid":"project_member_table",class:"grid min-w-full",style:{"grid-template-columns":"1fr 150px 150px 80px"}},ps={key:0,class:"col-span-5 py-24 text-center"},cs=P({__name:"ProjectMemberTable",props:{projectId:{},projectMembers:{}},setup(_){const f=x(!1);return(a,i)=>(m(),M(R,null,[o(Ne,{show:f.value,"onUpdate:show":i[0]||(i[0]=n=>f.value=n),"existing-members":a.projectMembers,"project-id":a.projectId},null,8,["show","existing-members","project-id"]),e("div",us,[e("div",ds,[e("div",ms,[o(ls),a.projectMembers.length===0?(m(),M("div",ps,[o(t(ft),{class:"w-8 text-icon-default inline pb-2"}),i[3]||(i[3]=e("h3",{class:"text-text-primary font-semibold"},"No project members",-1)),i[4]||(i[4]=e("p",{class:"pb-5"},"Add the first project member!",-1)),o(B,{icon:t(O),onClick:i[1]||(i[1]=n=>f.value=!0)},{default:l(()=>i[2]||(i[2]=[g("Add a new Project Member ")])),_:1,__:[2]},8,["icon"])])):$("",!0),(m(!0),M(R,null,se(a.projectMembers,n=>(m(),w(os,{key:n.id,"project-member":n},null,8,["project-member"]))),128))])])])],64))}}),fs={class:"flex","aria-label":"Breadcrumb"},bs={role:"list",class:"flex items-center space-x-2"},vs={class:"flex items-center space-x-6"},_s={class:"flex items-center space-x-3 text-text-primary font-semibold text-base"},ws={class:"flex space-x-3 items-center"},xs={class:"px-4"},ks={class:"grid lg:grid-cols-2 gap-x-6 pt-6"},js={class:"w-full items-center flex justify-between"},gs={class:"pl-6"},ys={key:0},ha=P({__name:"ProjectShow",setup(_){var k,U;const{projects:f}=I(xe()),a=G("organization"),i=N(()=>f.value.find(C=>C.id===route().params.project)??null),n=x(!1),s=x(!1),d=(U=(k=route())==null?void 0:k.params)==null?void 0:U.project,{projectMembers:u}=I(q());Oe(()=>{be()&&q().fetchProjectMembers(d),A().fetchTasks()});const p=x(!1),r=x("active"),{tasks:b}=I(A()),c=N(()=>b.value.filter(C=>r.value==="active"?C.project_id===d&&!C.is_done:C.project_id===d&&C.is_done));return(C,v)=>(m(),w(qe,{title:"Projects","data-testid":"projects_view"},{default:l(()=>[o(pe,{class:"py-5 border-b border-default-background-separator flex justify-between items-center"},{default:l(()=>{var T,K,j,h,y,ne,ie;return[e("nav",fs,[e("ol",bs,[e("li",null,[e("div",vs,[o(t(He),{href:C.route("projects"),class:"flex items-center space-x-2.5"},{default:l(()=>[o(t(ct),{class:"w-6 text-icon-default"}),v[7]||(v[7]=e("span",{class:"font-medium"},"Projects",-1))]),_:1,__:[7]},8,["href"])])]),e("li",null,[e("div",_s,[o(t(Fe),{class:"h-5 w-5 flex-shrink-0 text-text-secondary","aria-hidden":"true"}),e("div",ws,[e("div",{style:Qe({backgroundColor:(T=i.value)==null?void 0:T.color,boxShadow:`var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) ${(K=i.value)==null?void 0:K.color}30`}),class:"w-3 h-3 rounded-full"},null,4),e("span",null,V((j=i.value)==null?void 0:j.name),1)])])])]),e("div",xs,[(h=i.value)!=null&&h.billable_rate?(m(),w(t(Y),{key:0},{default:l(()=>{var S,ue,de,me;return[g(V(t(re)(((S=i.value)==null?void 0:S.billable_rate)??0,t(Z)(),(ue=t(a))==null?void 0:ue.currency_format,(de=t(a))==null?void 0:de.currency_symbol,(me=t(a))==null?void 0:me.number_format))+" / h ",1)]}),_:1})):$("",!0),(y=i.value)!=null&&y.is_billable&&!((ne=i.value)!=null&&ne.billable_rate)?(m(),w(t(Y),{key:1},{default:l(()=>v[8]||(v[8]=[g(" Default Rate ")])),_:1,__:[8]})):$("",!0),(ie=i.value)!=null&&ie.is_billable?$("",!0):(m(),w(t(Y),{key:2},{default:l(()=>v[9]||(v[9]=[g(" Non-Billable ")])),_:1,__:[9]}))])]),e("div",null,[t(tt)()?(m(),w(B,{key:0,icon:t(oe),onClick:v[0]||(v[0]=S=>p.value=!0)},{default:l(()=>v[10]||(v[10]=[g(" Edit Project ")])),_:1,__:[10]},8,["icon"])):$("",!0),i.value?(m(),w(ot,{key:1,show:p.value,"onUpdate:show":v[1]||(v[1]=S=>p.value=S),"original-project":i.value},null,8,["show","original-project"])):$("",!0)])]}),_:1}),o(pe,null,{default:l(()=>[e("div",ks,[e("div",null,[o(ve,{title:"Tasks",icon:t(le)},{actions:l(()=>[e("div",js,[e("div",gs,[o(pt,{modelValue:r.value,"onUpdate:modelValue":v[2]||(v[2]=T=>r.value=T)},{default:l(()=>[o(we,{value:"active"},{default:l(()=>v[11]||(v[11]=[g("Active ")])),_:1,__:[11]}),o(we,{value:"done"},{default:l(()=>v[12]||(v[12]=[g("Done ")])),_:1,__:[12]})]),_:1},8,["modelValue"])]),t(ee)()?(m(),w(B,{key:0,icon:t(O),onClick:v[3]||(v[3]=T=>n.value=!0)},{default:l(()=>v[13]||(v[13]=[g("Create Task ")])),_:1,__:[13]},8,["icon"])):$("",!0),o(Ue,{show:n.value,"onUpdate:show":v[4]||(v[4]=T=>n.value=T),"project-id":t(d)},null,8,["show","project-id"])])]),_:1},8,["icon"]),o(_e,null,{default:l(()=>[o(Lt,{tasks:c.value,"project-id":t(d)},null,8,["tasks","project-id"])]),_:1})]),t(be)()?(m(),M("div",ys,[o(ve,{title:"Project Members",icon:t(Be)},{actions:l(()=>[o(B,{icon:t(O),onClick:v[5]||(v[5]=T=>s.value=!0)},{default:l(()=>v[14]||(v[14]=[g(" Add Member ")])),_:1,__:[14]},8,["icon"]),o(Ne,{show:s.value,"onUpdate:show":v[6]||(v[6]=T=>s.value=T),"project-id":t(d),"existing-members":t(u)},null,8,["show","project-id","existing-members"])]),_:1},8,["icon"]),o(_e,null,{default:l(()=>[o(cs,{"project-members":t(u),"project-id":t(d)},null,8,["project-members","project-id"])]),_:1})])):$("",!0)])]),_:1})]),_:1}))}});export{ha as default};
