import{M as Q}from"./MainContainer-DAB7AmGD.js";import{g as I,P as K,S as G,B as O,D as H,x as J,$ as W,c as X,E as Y,_ as Z}from"./AppLayout.vue_vue_type_script_setup_true_lang-7v21bPMn.js";import{_ as ee}from"./PageTitle.vue_vue_type_script_setup_true_lang-DVaC2uzI.js";import{u as D,a as S,b as F}from"./notification-BrLDF-00.js";import{u as te}from"./useQuery-QapR65Yu.js";import{g as R}from"./useUser-Dc3_Hjqo.js";import{_ as re}from"./ReportingTabNavbar.vue_vue_type_script_setup_true_lang-DBUWeKjm.js";import{_ as B}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-iS1Fl1UI.js";import{A as se,B as oe,q as ie,j as ae,k as ne}from"./permissions-hl9spDHx.js";import{T as le,_ as pe}from"./TableHeading-5GheUSuW.js";import{d as $,c,o as s,w as i,a as t,u as e,b as r,f as v,i as V,m as ue,p as de,r as C,B as j,g as w,n as ce,e as m,F as E,t as h,l as P,x as me,N as fe,h as U,y as _e,j as ve}from"./app-CZLkYVhz.js";import{_ as xe,a as ye,c as be,b as q,r as ge}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-BgJhjCYQ.js";import{r as we}from"./PencilSquareIcon-krbQY_ys.js";import{_ as z}from"./TextInput.vue_vue_type_script_setup_true_lang-DUXudii_.js";import{_ as $e}from"./DialogModal.vue_vue_type_script_setup_true_lang-Dn6gUihL.js";import{_ as T}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-DGqi3YE0.js";import{_ as k}from"./InputLabel.vue_vue_type_script_setup_true_lang-DP24QN7l.js";import{u as L}from"./useMutation-PNvSUilA.js";import"./time-DR3Bm2fi.js";/* empty css                                                                             */import{D as ke}from"./DatePicker-DmIk6-p1.js";import"./utc-YQln_hJX.js";import"./useCurrentTimeEntry-CruyZJNI.js";import{_ as he}from"./Checkbox.vue_vue_type_script_setup_true_lang-BTLhb63T.js";import"./money-BufCQq2I.js";import"./theme-DlEllDdR.js";import{b as Re}from"./index-CHolqtoz.js";import{r as Ce}from"./ArrowTopRightOnSquareIcon-CNhq5Q_2.js";import{r as Ee}from"./FolderPlusIcon-B_ZSnArn.js";import{r as Me}from"./PlusIcon-gin79_-P.js";import{i as N,a as A,r as Ne}from"./billing-F8TVwX2K.js";import{a as Pe}from"./UserCircleIcon-B_03lMym.js";import{r as De}from"./UserGroupIcon-DEClCgLE.js";import{r as Se,a as Be,b as Ve}from"./ChevronLeftIcon-BXTEnYvV.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Dropdown.vue_vue_type_script_setup_true_lang-2TV_nqEm.js";import"./utils-DLNr0s0q.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-DKIr8CEw.js";import"./useOrganization-Dnx8kCk3.js";import"./init-DIMnQ95t.js";import"./useMembers-B2Kv7mzm.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CAmSBxXF.js";import"./ClockIcon-DtFwBiYn.js";import"./TagIcon-D32GhY_O.js";import"./TabBar.vue_vue_type_script_setup_true_lang-D5JkrlW4.js";import"./Collection-Ddu0RjBR.js";import"./usePrimitiveElement-DVmz0I4p.js";import"./RovingFocusGroup-j8ihdqB0.js";import"./useTypeahead-DuqX-vkx.js";import"./Modal.vue_vue_type_script_setup_true_lang-DiIZ2Ob1.js";const qe=$({__name:"ReportTableHeading",setup(y){return(u,l)=>(s(),c(le,null,{default:i(()=>l[0]||(l[0]=[t("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Name ",-1),t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Description ",-1),t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Visibility ",-1),t("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Public URL ",-1),t("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[t("span",{class:"sr-only"},"Edit")],-1)])),_:1,__:[0]}))}}),ze=["aria-label"],Ae=$({__name:"ReportMoreOptionsDropdown",props:{report:{}},emits:["delete","edit","archive"],setup(y,{emit:u}){const l=u,p=y;return(x,a)=>(s(),c(e(xe),null,{default:i(()=>[r(e(ye),{"as-child":""},{default:i(()=>[t("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Project "+p.report.name},a[2]||(a[2]=[t("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,ze)]),_:1}),r(e(be),{class:"min-w-[150px]",align:"end"},{default:i(()=>[e(se)()?(s(),c(e(q),{key:0,"aria-label":"Edit Report "+p.report.name,class:"flex items-center space-x-3 cursor-pointer",onClick:a[0]||(a[0]=V(d=>l("edit"),["prevent"]))},{default:i(()=>[r(e(we),{class:"w-5 text-icon-active"}),a[3]||(a[3]=t("span",null,"Edit",-1))]),_:1,__:[3]},8,["aria-label"])):v("",!0),e(oe)()?(s(),c(e(q),{key:1,"aria-label":"Delete Report "+p.report.name,class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:a[1]||(a[1]=V(d=>l("delete"),["prevent"]))},{default:i(()=>[r(e(ge),{class:"w-5"}),a[4]||(a[4]=t("span",null,"Delete",-1))]),_:1,__:[4]},8,["aria-label"])):v("",!0)]),_:1})]),_:1}))}}),Fe={class:"items-center space-y-4 w-full"},je={class:"w-full"},Ue={class:"flex items-center space-x-12"},Te={class:"flex items-center space-x-2 px-2 py-3"},Le={key:0,class:"flex items-center space-x-4"},Qe=$({__name:"ReportEditModal",props:ue({originalReport:{}},{show:{default:!1},showModifiers:{}}),emits:["update:show"],setup(y){const u=de(y,"show"),l=C(!1),p=D(),x=L({mutationFn:async g=>{const o=R();if(o===null)throw new Error("No current organization id - update report");return await S.updateReport(g,{params:{organization:o,report:a.originalReport.id}})},onSuccess:()=>{p.invalidateQueries({queryKey:["reports"]})}}),a=y,d=C({name:a.originalReport.name,description:a.originalReport.description,is_public:a.originalReport.is_public,public_until:a.originalReport.public_until});j(()=>a.originalReport,()=>{d.value={name:a.originalReport.name,description:a.originalReport.description,is_public:a.originalReport.is_public,public_until:a.originalReport.public_until}});const{handleApiRequestNotifications:b}=F();async function f(){await b(()=>x.mutateAsync(d.value),"Success","Error",()=>{d.value={name:"",description:"",is_public:!1,public_until:null,properties:{}},u.value=!1})}return(g,o)=>(s(),c($e,{closeable:"",show:u.value,onClose:o[4]||(o[4]=n=>u.value=!1)},{title:i(()=>o[5]||(o[5]=[t("div",{class:"flex space-x-2"},[t("span",null," Create Report ")],-1)])),content:i(()=>[t("div",Fe,[t("div",je,[r(k,{for:"name",value:"Name"}),r(z,{id:"name",modelValue:d.value.name,"onUpdate:modelValue":o[0]||(o[0]=n=>d.value.name=n),class:"mt-1.5 w-full"},null,8,["modelValue"])]),t("div",null,[r(k,{for:"description",value:"Description"}),r(z,{id:"description",modelValue:d.value.description,"onUpdate:modelValue":o[1]||(o[1]=n=>d.value.description=n),class:"mt-1.5 w-full"},null,8,["modelValue"])]),r(k,{value:"Visibility"}),t("div",Ue,[t("div",Te,[r(e(he),{id:"is_public",checked:d.value.is_public,"onUpdate:checked":o[2]||(o[2]=n=>d.value.is_public=n)},null,8,["checked"]),r(k,{for:"is_public",value:"Public"})]),d.value.is_public?(s(),m("div",Le,[r(k,{for:"public_until",value:"Expires at"}),r(ke,{id:"public_until"})])):v("",!0)])])]),footer:i(()=>[r(B,{onClick:o[3]||(o[3]=n=>u.value=!1)},{default:i(()=>o[6]||(o[6]=[w(" Cancel")])),_:1,__:[6]}),r(T,{class:ce(["ms-3",{"opacity-25":l.value}]),disabled:l.value,onClick:f},{default:i(()=>o[7]||(o[7]=[w(" Update Report ")])),_:1,__:[7]},8,["class","disabled"])]),_:1},8,["show"]))}}),Ie={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},Ke={class:"overflow-ellipsis overflow-hidden"},Ge={class:"whitespace-nowrap min-w-0 px-3 py-4 text-sm text-text-secondary"},Oe={class:"overflow-ellipsis overflow-hidden"},He={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},Je={class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},We={key:0,class:"space-x-2 flex items-center"},Xe={key:0},Ye={key:1},Ze={key:1},et={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},tt=$({__name:"ReportTableRow",props:{report:{}},setup(y){const u=y,l=C(!1),{copy:p,copied:x,isSupported:a}=Re({legacy:!0}),{handleApiRequestNotifications:d}=F();function b(){var _;const n=u.report.shareable_link;n&&((_=window.open(n,"_blank"))==null||_.focus())}const f=D(),g=L({mutationFn:async n=>{const _=R();if(_===null)throw new Error("No current organization id - update report");return await S.deleteReport(void 0,{params:{organization:_,report:n}})},onSuccess:()=>{f.invalidateQueries({queryKey:["reports"]})}});async function o(){await d(()=>g.mutateAsync(u.report.id),"Success","Error")}return(n,_)=>(s(),m(E,null,[r(Qe,{show:l.value,"onUpdate:show":_[0]||(_[0]=M=>l.value=M),"original-report":n.report},null,8,["show","original-report"]),r(pe,null,{default:i(()=>[t("div",Ie,[t("span",Ke,h(n.report.name),1)]),t("div",Ge,[t("span",Oe,h(n.report.description),1)]),t("div",He,h(n.report.is_public?"Public":"Private"),1),t("div",Je,[n.report.shareable_link?(s(),m("div",We,[e(a)?(s(),c(e(B),{key:0,onClick:_[1]||(_[1]=M=>e(p)(n.report.shareable_link))},{default:i(()=>[e(x)?(s(),m("span",Ye,"Copied!")):(s(),m("span",Xe,"Copy URL"))]),_:1})):v("",!0),t("button",{class:"outline-0 focus-visible:ring-2 w-6 h-6 flex items-center justify-center rounded focus-visible:ring-ring",onClick:b},[r(e(Ce),{class:"w-4 text-text-tertiary hover:text-text-secondary transition"})])])):(s(),m("span",Ze," -- "))]),t("div",et,[r(Ae,{report:n.report,onEdit:_[2]||(_[2]=M=>l.value=!0),onDelete:o},null,8,["report"])])]),_:1})],64))}}),rt={class:"flow-root max-w-[100vw] overflow-x-auto"},st={class:"inline-block min-w-full align-middle"},ot={key:0,class:"col-span-5 py-24 text-center"},it={key:0,class:"pb-5"},at=$({__name:"ReportTable",props:{reports:{}},setup(y){const u=P(()=>"grid-template-columns: minmax(150px, auto) minmax(250px, 1fr) minmax(140px, auto) minmax(130px, auto) 80px;");return(l,p)=>(s(),m("div",rt,[t("div",st,[t("div",{"data-testid":"report_table",class:"grid min-w-full",style:me(u.value)},[r(qe),l.reports.length===0?(s(),m("div",ot,[r(e(Ee),{class:"w-8 text-icon-default inline pb-2"}),p[2]||(p[2]=t("h3",{class:"text-text-primary font-semibold"}," No shared reports found ",-1)),e(ie)()?(s(),m("p",it," Go to the overview to create a report ")):v("",!0),r(B,{icon:e(Me),onClick:p[0]||(p[0]=x=>e(fe).visit(l.route("reporting")))},{default:i(()=>p[1]||(p[1]=[w("Go to overview ")])),_:1,__:[1]},8,["icon"])])):v("",!0),(s(!0),m(E,null,U(l.reports,x=>(s(),c(tt,{key:x.id,report:x},null,8,["report"]))),128))],4)])]))}}),nt={class:"flex items-center space-x-3 sm:space-x-6"},lt={key:0},pt={class:"py-12"},ut={class:"rounded-full flex items-center justify-center w-20 h-20 mx-auto border dark:border-[#3F4961] bg-secondary"},dt={class:"max-w-sm text-center mx-auto py-4 text-base"},ct={class:"py-1"},mt={class:"pr-2 flex items-center space-x-1 border-r dark:border-[#3F4961] mr-1"},ft={class:"!ml-2 pl-2 flex items-center space-x-1 border-l dark:border-[#3F4961]"},_t=15,mr=$({__name:"ReportingShared",setup(y){const u=C(1),{data:l}=te({queryKey:["reports",u],enabled:!!R(),queryFn:()=>S.getReports({params:{organization:R()||""}})}),p=P(()=>{var b;return((b=l.value)==null?void 0:b.data)??[]}),x=P(()=>1),a=D();async function d(){await a.invalidateQueries({queryKey:["reports"]})}return j(u,()=>{d()}),(b,f)=>(s(),c(Z,{title:"Reporting","data-testid":"reporting_view",class:""},{default:i(()=>[r(Q,{class:"py-3 sm:py-5 min-h-[79px] border-b dark:border-[#3F4961] sticky top-0 dark:bg-[#0F1426] dark:text-[#7D88A1] flex justify-between items-center"},{default:i(()=>[t("div",nt,[r(ee,{icon:e(Pe),title:"Reporting"},null,8,["icon"]),r(re,{active:"shared"})])]),_:1}),e(N)()?v("",!0):(s(),m("div",lt,[t("div",pt,[t("div",ut,[r(e(De),{class:"w-12"})]),t("div",dt,[t("p",ct,[_e(b.$slots,"default")]),f[2]||(f[2]=t("p",{class:"py-1"},[w(" If you want to use "),t("strong",null,"sharable reports"),w(" , "),t("strong",null,"please upgrade to a paid plan"),w(". ")],-1)),e(A)()&&e(ae)()?(s(),c(e(ve),{key:0,href:"/billing"},{default:i(()=>[e(A)()&&e(ne)()?(s(),c(T,{key:0,type:"button",class:"mt-6",icon:e(Ne)},{default:i(()=>f[1]||(f[1]=[w(" Go to Billing ")])),_:1,__:[1]},8,["icon"])):v("",!0)]),_:1})):v("",!0)])])])),p.value.length>0||e(N)()?(s(),c(at,{key:1,reports:p.value},null,8,["reports"])):v("",!0),p.value.length>0||e(N)()?(s(),c(e(I),{key:2,page:u.value,"onUpdate:page":f[0]||(f[0]=g=>u.value=g),total:x.value,"items-per-page":_t,class:"flex justify-center items-center py-8","sibling-count":1,"show-edges":""},{default:i(()=>[r(e(K),{class:"flex items-center space-x-1 relative"},{default:i(({items:g})=>[t("div",mt,[r(e(G),{class:"navigation-item"},{default:i(()=>[r(e(Se),{class:"w-4"})]),_:1}),r(e(O),{class:"mr-4 navigation-item"},{default:i(()=>[r(e(Be),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1})]),(s(!0),m(E,null,U(g,(o,n)=>(s(),m(E,null,[o.type==="page"?(s(),c(e(H),{key:n,class:"pagination-item",value:o.value},{default:i(()=>[w(h(o.value),1)]),_:2},1032,["value"])):(s(),c(e(J),{key:o.type,index:n,class:"PaginationEllipsis"},{default:i(()=>f[3]||(f[3]=[t("div",{class:"px-2"},"â€¦",-1)])),_:2,__:[3]},1032,["index"]))],64))),256)),t("div",ft,[r(e(W),{class:"navigation-item"},{default:i(()=>[r(e(X),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1}),r(e(Y),{class:"navigation-item"},{default:i(()=>[r(e(Ve),{class:"w-4 text-text-tertiary hover:text-text-primary"})]),_:1})])]),_:1})]),_:1},8,["page","total"])):v("",!0)]),_:3}))}});export{mr as default};
//# sourceMappingURL=ReportingShared-CTa0Es7v.js.map
