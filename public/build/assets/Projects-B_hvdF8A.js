import{M as I}from"./MainContainer-WpbdfkDp.js";import{_ as Y}from"./AppLayout.vue_vue_type_script_setup_true_lang-BfXcHqGL.js";import{_ as H}from"./SecondaryButton.vue_vue_type_script_setup_true_lang-DBBC7wMi.js";import{_ as q}from"./ProjectCreateModal.vue_vue_type_script_setup_true_lang-CZmoGoj9.js";import{T as G,_ as J}from"./TableHeading-CHDXaWC7.js";import{d as C,b as v,o as s,w as p,f as r,h as f,j,u as t,e as i,g as A,t as w,A as g,c as $,B as K,r as T,F as S,L,l as B,i as Q,q as W}from"./app-Dzd5B06R.js";import{r as U,s as X,q as R}from"./permissions-Cy8U4TFG.js";import{_ as Z,a as ee,c as te,b as M,r as re}from"./DropdownMenuTrigger.vue_vue_type_script_setup_true_lang-OCyRpCcO.js";import{r as oe}from"./PencilSquareIcon-C4w9DETU.js";import{r as se}from"./ArchiveBoxIcon-DsKA4Vo7.js";import{u as P,b as ae,a as k,e as ie}from"./useMembers-D1lZTqLC.js";import{b as le,_ as ne,a as pe}from"./ProjectEditModal.vue_vue_type_script_setup_true_lang-DSdvo0ZW.js";import{f as ce}from"./money-042SSt8Q.js";import{g as D}from"./money-DE8Cj37t.js";import{a as me}from"./time-D8Z5bJ3P.js";import{i as N}from"./billing-BrKRBYHJ.js";import{r as de}from"./CheckCircleIcon-Cls-9biQ.js";import{r as ue}from"./FolderPlusIcon-BTBKkc2d.js";import{r as z}from"./PlusIcon-DXN6bajS.js";import{_ as fe}from"./PageTitle.vue_vue_type_script_setup_true_lang-Dc0jot_g.js";import{_ as ve,a as O}from"./TabBar.vue_vue_type_script_setup_true_lang-goXlkxJT.js";import{u as F}from"./useOrganization-fnI1XVs5.js";import{r as _e}from"./FolderIcon-DWxb3Ngj.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./utils-CCwwB18o.js";import"./index-NRw1C4BU.js";import"./bundle-mjs-D696Ktp4.js";import"./useFocusGuards-BJPjJVKi.js";import"./init-Ddj1H8ev.js";import"./notification-Cqm5OIAz.js";import"./utc-BCs3FwGo.js";import"./DialogModal.vue_vue_type_script_setup_true_lang-Cdp4pUKI.js";import"./Modal.vue_vue_type_script_setup_true_lang-s_ZkTFQt.js";import"./PrimaryButton.vue_vue_type_script_setup_true_lang-CWUYAS8h.js";import"./LoadingSpinner.vue_vue_type_script_setup_true_lang-CcpHAXFE.js";import"./theme-CJTqdCW4.js";import"./useQuery-BH-Arugy.js";import"./ClockIcon-CYfSOCq5.js";import"./TextInput.vue_vue_type_script_setup_true_lang-Cw992cSP.js";import"./BillableIcon-C1VJddF3.js";import"./ProjectEditBillableSection.vue_vue_type_script_setup_true_lang-DqRZf2t1.js";import"./component-D2dmHEOx.js";import"./InputLabel.vue_vue_type_script_setup_true_lang-BJprejo3.js";import"./BillableRateInput.vue_vue_type_script_setup_true_lang-B9u_Q2bT.js";import"./usePrimitiveElement-Dt-Gdg0c.js";import"./useLocale-CRrU4gHp.js";import"./clamp-D21Fl2C-.js";import"./createLucideIcon-CLDLlRIF.js";import"./SelectDropdown.vue_vue_type_script_setup_true_lang-CaZ4i_G-.js";import"./Collection-DUsfnDCk.js";import"./useTypeahead-DT7HEzVy.js";import"./RovingFocusGroup-C65J4aAO.js";import"./UpgradeModal.vue_vue_type_script_setup_true_lang-BsrvLgcD.js";import"./BillableRateModal.vue_vue_type_script_setup_true_lang-BNQCoov9.js";import"./ArrowTopRightOnSquareIcon-BjqQdrkl.js";const xe={key:0,class:"px-3 py-1.5 text-left font-semibold text-text-primary"},be=C({__name:"ProjectTableHeading",props:{showBillableRate:{type:Boolean}},setup(y){return(d,o)=>(s(),v(G,null,{default:p(()=>[o[0]||(o[0]=r("div",{class:"py-1.5 pr-3 text-left font-semibold text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"}," Name ",-1)),o[1]||(o[1]=r("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Client",-1)),o[2]||(o[2]=r("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Total Time ",-1)),o[3]||(o[3]=r("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"}," Progress ",-1)),d.showBillableRate?(s(),f("div",xe," Billable Rate ")):j("",!0),o[4]||(o[4]=r("div",{class:"px-3 py-1.5 text-left font-semibold text-text-primary"},"Status",-1)),o[5]||(o[5]=r("div",{class:"relative py-1.5 pl-3 pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},[r("span",{class:"sr-only"},"Edit")],-1))]),_:1,__:[0,1,2,3,4,5]}))}}),we=["aria-label"],je=C({__name:"ProjectMoreOptionsDropdown",props:{project:{}},emits:["delete","edit","archive"],setup(y,{emit:d}){const o=d,l=y;return(_,n)=>(s(),v(t(Z),null,{default:p(()=>[i(t(ee),{"as-child":""},{default:p(()=>[r("button",{class:"focus-visible:outline-none focus-visible:bg-card-background rounded-full focus-visible:ring-2 focus-visible:ring-ring focus-visible:opacity-100 hover:bg-card-background group-hover:opacity-100 opacity-20 transition-opacity text-text-secondary","aria-label":"Actions for Project "+l.project.name},n[3]||(n[3]=[r("svg",{class:"h-8 w-8 p-1 rounded-full",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[r("path",{fill:"none",stroke:"currentColor","stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1.5",d:"M12 5.92A.96.96 0 1 0 12 4a.96.96 0 0 0 0 1.92m0 7.04a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92M12 20a.96.96 0 1 0 0-1.92a.96.96 0 0 0 0 1.92"})],-1)]),8,we)]),_:1}),i(t(te),{class:"min-w-[150px]",align:"end"},{default:p(()=>[t(U)()?(s(),v(t(M),{key:0,"aria-label":"Edit Project "+l.project.name,"data-testid":"project_edit",class:"flex items-center space-x-3 cursor-pointer",onClick:n[0]||(n[0]=A(b=>o("edit"),["prevent"]))},{default:p(()=>[i(t(oe),{class:"w-5 text-icon-active"}),n[4]||(n[4]=r("span",null,"Edit",-1))]),_:1,__:[4]},8,["aria-label"])):j("",!0),t(U)()?(s(),v(t(M),{key:1,"aria-label":"Archive Project "+l.project.name,class:"flex items-center space-x-3 cursor-pointer",onClick:n[1]||(n[1]=A(b=>o("archive"),["prevent"]))},{default:p(()=>[i(t(se),{class:"w-5 text-icon-active"}),r("span",null,w(_.project.is_archived?"Unarchive":"Archive"),1)]),_:1},8,["aria-label"])):j("",!0),t(X)()?(s(),v(t(M),{key:2,"aria-label":"Delete Project "+l.project.name,"data-testid":"project_delete",class:"flex items-center space-x-3 cursor-pointer text-destructive focus:text-destructive",onClick:n[2]||(n[2]=A(b=>o("delete"),["prevent"]))},{default:p(()=>[i(t(re),{class:"w-5"}),n[5]||(n[5]=r("span",null,"Delete",-1))]),_:1,__:[5]},8,["aria-label"])):j("",!0)]),_:1})]),_:1}))}}),ye={class:"whitespace-nowrap min-w-0 flex items-center space-x-5 3xl:pl-12 py-4 pr-3 text-sm font-medium text-text-primary pl-4 sm:pl-6 lg:pl-8 3xl:pl-12"},he={class:"overflow-ellipsis overflow-hidden"},ge={class:"text-text-secondary"},$e={class:"whitespace-nowrap min-w-0 px-3 py-4 text-sm text-text-secondary"},ke={key:0,class:"overflow-ellipsis overflow-hidden"},Pe={key:1},Ce={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},Be={key:0},Re={key:1},Te={class:"whitespace-nowrap px-3 flex items-center text-sm text-text-secondary"},Ae={key:2},Me={key:0,class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary"},Se={class:"whitespace-nowrap px-3 py-4 text-sm text-text-secondary flex space-x-1 items-center font-medium"},De={class:"relative whitespace-nowrap flex items-center pl-3 text-right text-sm font-medium pr-4 sm:pr-6 lg:pr-8 3xl:pr-12"},Ne=C({__name:"ProjectTableRow",props:{project:{},showBillableRate:{type:Boolean}},setup(y){const{clients:d}=g(P()),{tasks:o}=g(ae()),l=y,_=$(()=>d.value.find(e=>e.id===l.project.client_id)),n=$(()=>o.value.filter(e=>e.project_id===l.project.id).length);function b(){k().deleteProject(l.project.id)}function u(){k().updateProject(l.project.id,{...l.project,is_archived:!l.project.is_archived})}const a=K("organization"),x=$(()=>{var e,m,h;return l.project.is_billable?l.project.billable_rate?ce(l.project.billable_rate,D(),(e=a==null?void 0:a.value)==null?void 0:e.currency_format,(m=a==null?void 0:a.value)==null?void 0:m.currency_symbol,(h=a==null?void 0:a.value)==null?void 0:h.number_format):"Default Rate":"--"}),c=T(!1);return(e,m)=>(s(),f(S,null,[i(le,{show:c.value,"onUpdate:show":m[0]||(m[0]=h=>c.value=h),"original-project":e.project},null,8,["show","original-project"]),i(J,{href:e.route("projects.show",{project:e.project.id})},{default:p(()=>{var h,V,E;return[r("div",ye,[r("div",{style:L({backgroundColor:e.project.color,boxShadow:`var(--tw-ring-inset) 0 0 0 calc(4px + var(--tw-ring-offset-width)) ${e.project.color}30`}),class:"w-3 h-3 rounded-full"},null,4),r("span",he,w(e.project.name),1),r("span",ge,w(n.value)+" Tasks ",1)]),r("div",$e,[e.project.client_id?(s(),f("div",ke,w((h=_.value)==null?void 0:h.name),1)):(s(),f("div",Pe,"No client"))]),r("div",Ce,[e.project.spent_time?(s(),f("div",Be,w(t(me)(e.project.spent_time,(V=t(a))==null?void 0:V.interval_format,(E=t(a))==null?void 0:E.number_format)),1)):(s(),f("div",Re,"--"))]),r("div",Te,[t(N)()?e.project.estimated_time?(s(),v(pe,{key:1,estimated:e.project.estimated_time,current:e.project.spent_time},null,8,["estimated","current"])):(s(),f("span",Ae," -- ")):(s(),v(ne,{key:0}))]),e.showBillableRate?(s(),f("div",Me,w(x.value),1)):j("",!0),r("div",Se,[i(t(de),{class:"w-5"}),m[2]||(m[2]=r("span",null,"Active",-1))]),r("div",De,[i(je,{project:e.project,onEdit:m[1]||(m[1]=Le=>c.value=!0),onArchive:u,onDelete:b},null,8,["project"])])]}),_:1},8,["href"])],64))}}),Ve={class:"flow-root max-w-[100vw] overflow-x-auto"},Ee={class:"inline-block min-w-full align-middle"},Ue={key:0,class:"col-span-5 py-24 text-center"},Oe={class:"text-text-primary font-semibold"},Fe={class:"pb-5 max-w-md mx-auto text-sm pt-1"},He=C({__name:"ProjectTable",props:{projects:{},showBillableRate:{type:Boolean}},setup(y){const d=y,o=T(!1);async function l(u){return await k().createProject(u)}async function _(u){return await P().createClient(u)}const{clients:n}=g(P()),b=$(()=>`grid-template-columns: minmax(300px, 1fr) minmax(150px, auto) minmax(140px, auto) minmax(130px, auto) ${d.showBillableRate?"minmax(130px, auto)":""} minmax(120px, auto) 80px;`);return(u,a)=>(s(),f(S,null,[i(q,{show:o.value,"onUpdate:show":a[0]||(a[0]=x=>o.value=x),"create-project":l,"create-client":_,currency:t(D)(),clients:t(n),"enable-estimated-time":t(N)},null,8,["show","currency","clients","enable-estimated-time"]),r("div",Ve,[r("div",Ee,[r("div",{"data-testid":"project_table",class:"grid min-w-full",style:L(b.value)},[i(be,{"show-billable-rate":d.showBillableRate},null,8,["show-billable-rate"]),u.projects.length===0?(s(),f("div",Ue,[i(t(ue),{class:"w-8 text-icon-default inline pb-2"}),r("h3",Oe,w(t(R)()?"No projects found":"You are not a member of any projects"),1),r("p",Fe,w(t(R)()?"Create your first project now!":"Ask your manager to add you to a project as a team member."),1),t(R)()?(s(),v(H,{key:0,icon:t(z),onClick:a[1]||(a[1]=x=>o.value=!0)},{default:p(()=>a[2]||(a[2]=[B("Create your First Project ")])),_:1,__:[2]},8,["icon"])):j("",!0)])):j("",!0),(s(!0),f(S,null,Q(u.projects,x=>(s(),v(Ne,{key:x.id,"show-billable-rate":d.showBillableRate,project:x},null,8,["show-billable-rate","project"]))),128))],4)])])],64))}}),qe={class:"flex items-center space-x-3 sm:space-x-6"},It=C({__name:"Projects",setup(y){W(()=>{k().fetchProjects(),F().fetchOrganization()});const{clients:d}=g(P()),o=T(!1),{organization:l}=g(F()),_=T("active"),{projects:n}=g(k()),b=$(()=>n.value.filter(c=>_.value==="active"?!c.is_archived:c.is_archived));async function u(c){return await k().createProject(c)}async function a(c){return await P().createClient(c)}const x=$(()=>{var c;return!!(ie()!=="employee"||(c=l.value)!=null&&c.employees_can_see_billable_rates)});return(c,e)=>(s(),v(Y,{title:"Projects","data-testid":"projects_view"},{default:p(()=>[i(I,{class:"py-3 sm:py-5 border-b border-default-background-separator flex justify-between items-center"},{default:p(()=>[r("div",qe,[i(fe,{icon:t(_e),title:"Projects"},null,8,["icon"]),i(ve,{modelValue:_.value,"onUpdate:modelValue":e[0]||(e[0]=m=>_.value=m)},{default:p(()=>[i(O,{value:"active"},{default:p(()=>e[3]||(e[3]=[B("Active")])),_:1,__:[3]}),i(O,{value:"archived"},{default:p(()=>e[4]||(e[4]=[B("Archived")])),_:1,__:[4]})]),_:1},8,["modelValue"])]),t(R)()?(s(),v(H,{key:0,icon:t(z),onClick:e[1]||(e[1]=m=>o.value=!0)},{default:p(()=>e[5]||(e[5]=[B("Create Project ")])),_:1,__:[5]},8,["icon"])):j("",!0),i(q,{show:o.value,"onUpdate:show":e[2]||(e[2]=m=>o.value=m),"create-project":u,"enable-estimated-time":t(N),"create-client":a,currency:t(D)(),clients:t(d),onSubmit:u},null,8,["show","enable-estimated-time","currency","clients"])]),_:1}),i(He,{"show-billable-rate":x.value,projects:b.value},null,8,["show-billable-rate","projects"])]),_:1}))}});export{It as default};
//# sourceMappingURL=Projects-B_hvdF8A.js.map
